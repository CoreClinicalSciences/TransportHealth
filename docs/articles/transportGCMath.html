<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Theory of g-computation â€¢ TransportHealth</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Theory of g-computation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TransportHealth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview of transportability and generalizability analyses and TransportHealth</a></li>
    <li><a class="dropdown-item" href="../articles/assumptions.html">Assumptions of transportability and generalizability analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Inverse probability methods</h6></li>
    <li><a class="dropdown-item" href="../articles/transportIP.html">Inverse probability or odds weighting-based transportability analysis</a></li>
    <li><a class="dropdown-item" href="../articles/transportIPMath.html">Theory of inverse probability or odds weighting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>G-computation methods</h6></li>
    <li><a class="dropdown-item" href="../articles/transportGC.html">G-computation-based transportability analysis</a></li>
    <li><a class="dropdown-item" href="../articles/transportGCMath.html">Theory of g-computation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Target aggregate data adjustment (TADA) methods</h6></li>
    <li><a class="dropdown-item" href="../articles/transportTADA.html">Target aggregate data adjustment transportability analysis</a></li>
    <li><a class="dropdown-item" href="../articles/transportTADAMath.html">Theory of target aggregate data adjustment transportability analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpolated g-computation methods</h6></li>
    <li><a class="dropdown-item" href="../articles/transportInterpolated.html">Transportability analysis with interpolated g-computation</a></li>
    <li><a class="dropdown-item" href="../articles/transportInterpolatedMath.html">Theory of interpolated g-computation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CoreClinicalSciences/TransportHealth"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Theory of g-computation</h1>
                        <h4 data-toc-skip class="author">Core Clinical
Sciences</h4>
            
      

      <div class="d-none name"><code>transportGCMath.Rmd</code></div>
    </div>

    
    
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
be the outcome of interest,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
be the (binary, coded as 0 for control and 1 for treatment) treatment,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
be the indicator for study participation (so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">S=1</annotation></semantics></math>
means that the subject is in the population of the original study, while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">S = 0</annotation></semantics></math>
means that the subject is in the target population),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‹</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
be covariates to control for confounding in the original study and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ„</mi><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math>
be effect modifiers. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mn>0</mn></msup><annotation encoding="application/x-tex">Y^0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Y</mi><mn>1</mn></msup><annotation encoding="application/x-tex">Y^1</annotation></semantics></math>
be counterfactual outcomes associated with control and treatment,
respectively. The primary objective of transportability analysis is to
estimate the ATE in the target population:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>T</mi><mi>E</mi><mo>=</mo><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mn>1</mn></msup><mo>âˆ’</mo><msup><mi>Y</mi><mn>0</mn></msup><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>S</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">ATE = \mathrm{E}[Y^1 - Y^0 \,|\,S = 0].</annotation></semantics></math></p>
<p>Simply taking the difference in sample means using the original study
data will only unbiasedly estimate the quantity
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>A</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>S</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>âˆ’</mo><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>A</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>S</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathrm{E}[Y \,|\,A = 1, S = 1] - \mathrm{E}[Y \,|\,A = 0, S = 1],</annotation></semantics></math>
which is different from the target ATE due to confounding and the
different distributions of effect modifiers.</p>
<p>Under the assumptions specified in the Assumptions vignette, we
have</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>S</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi mathvariant="normal">E</mi><mrow><mi>S</mi><mo>=</mo><mn>0</mn></mrow></msub><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>ğ‹</mi><mo>,</mo><mi>ğ„</mi><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi mathvariant="normal">E</mi><mrow><mi>S</mi><mo>=</mo><mn>0</mn></mrow></msub><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>ğ‹</mi><mo>,</mo><mi>ğ„</mi><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">conditional exchangeability wrt treatment assignment</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi mathvariant="normal">E</mi><mrow><mi>S</mi><mo>=</mo><mn>0</mn></mrow></msub><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>ğ‹</mi><mo>,</mo><mi>ğ„</mi><mo>,</mo><mi>S</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">conditional exchangeability wrt study participation</mtext></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi mathvariant="normal">E</mi><mrow><mi>S</mi><mo>=</mo><mn>0</mn></mrow></msub><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>ğ‹</mi><mo>,</mo><mi>ğ„</mi><mo>,</mo><mi>S</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">consistency</mtext><mi>.</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\mathrm{E}[Y^a \,|\,S = 0] &amp;= \mathrm{E}_{S = 0}\mathrm{E}[Y^a \,|\,\mathbf{L}, \mathbf{E}] &amp; \\
&amp;= \mathrm{E}_{S=0}\mathrm{E}[Y^a \,|\,A = a, \mathbf{L}, \mathbf{E}] &amp; \textrm{conditional exchangeability wrt treatment assignment} \\
&amp;= \mathrm{E}_{S=0}\mathrm{E}[Y^a \,|\,A = a, \mathbf{L}, \mathbf{E}, S = 1] &amp; \textrm{conditional exchangeability wrt study participation} \\
&amp;= \mathrm{E}_{S=0}\mathrm{E}[Y \,|\,A = a, \mathbf{L}, \mathbf{E}, S = 1] &amp; \textrm{consistency}.\\
\end{align*}</annotation></semantics></math></p>
<p>Therefore, we can estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>Y</mi><mi>a</mi></msup><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>S</mi><mo>=</mo><mn>0</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{E}[Y^a \,|\,S = 0]</annotation></semantics></math>
unbiasedly by averaging samples of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>ğ‹</mi><mo>,</mo><mi>ğ„</mi><mo>,</mo><mi>S</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{E}[Y \,|\,A = a, \mathbf{L}, \mathbf{E}, S = 1]</annotation></semantics></math>
over the distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‹</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ„</mi><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math>
in the target data. We can obtain such samples by first fitting a
regression model of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
in terms of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‹</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ„</mi><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math>,
which essentially fits a model of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>ğ‹</mi><mo>,</mo><mi>ğ„</mi><mo>,</mo><mi>S</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{E}[Y \,|\,A = a, \mathbf{L}, \mathbf{E}, S = 1]</annotation></semantics></math>.
Then, this model is used to calculate fitted values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
at observed values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‹</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ„</mi><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math>
in the target data with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
being set to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>.
The fitted values may be seen as â€œsamplesâ€ of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>Y</mi><mspace width="0.167em"></mspace><mo stretchy="false" form="prefix">|</mo><mspace width="0.167em"></mspace><mi>A</mi><mo>=</mo><mi>a</mi><mo>,</mo><mi>ğ‹</mi><mo>,</mo><mi>ğ„</mi><mo>,</mo><mi>S</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathrm{E}[Y \,|\,A = a, \mathbf{L}, \mathbf{E}, S = 1]</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ‹</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ„</mi><annotation encoding="application/x-tex">\mathbf{E}</annotation></semantics></math>
are empirically drawn from the target data, so they are averaged to
obtain an estimate of the counterfactual mean above. From this, the
target ATE may be estimated unbiasedly, provided that the outcome model
is specified correctly.</p>
<p>For more information, check out the â€œWhat Ifâ€ book on causal
inference <span class="citation">(HernÃ¡n and Robins 2024)</span>, which
includes a discussion of g-computation for confounding adjustment.</p>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-what-if" class="csl-entry">
HernÃ¡n, MA, and JM Robins. 2024. <em>Causal Inference: What If?</em>
Boca Raton: Chapman &amp; Hall/CRC.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Core Clinical Sciences, Quang Vuong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
