<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="TransportHealth">
<title>Theory of g-computation • TransportHealth</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Theory of g-computation">
<meta property="og:description" content="TransportHealth">
<meta property="og:image" content="https://coreclinicalsciences.github.io/TransportHealth/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TransportHealth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/overview.html">Overview of transportability and generalizability analyses and TransportHealth</a>
    <a class="dropdown-item" href="../articles/assumptions.html">Assumptions of transportability and generalizability analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Inverse Probability Methods</h6>
    <a class="dropdown-item" href="../articles/transportIP.html">Inverse probability or odds weighting-based transportability analysis</a>
    <a class="dropdown-item" href="../articles/transportGC.html">G-computation-based transportability analysis</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Theoretical Formulations</h6>
    <a class="dropdown-item" href="../articles/transportIPMath.html">Theory of inverse probability or odds weighting</a>
    <a class="dropdown-item" href="../articles/transportGCMath.html">Theory of g-computation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CoreClinicalSciences/TransportHealth">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Theory of g-computation</h1>
                        <h4 data-toc-skip class="author">Core Clinical
Sciences</h4>
            
      
      
      <div class="d-none name"><code>transportGCMath.Rmd</code></div>
    </div>

    
    
<p>Let <span class="math inline">\(Y\)</span> be the outcome of
interest, <span class="math inline">\(A\)</span> be the (binary, coded
as 0 for control and 1 for treatment) treatment, <span class="math inline">\(S\)</span> be the indicator for study
participation (so that <span class="math inline">\(S=1\)</span> means
that the subject is in the population of the original study, while <span class="math inline">\(S = 0\)</span> means that the subject is in the
target population), <span class="math inline">\(\mathbf{L}\)</span> be
covariates to control for confounding in the original study and <span class="math inline">\(\mathbf{E}\)</span> be effect modifiers. Let <span class="math inline">\(Y^0\)</span> and <span class="math inline">\(Y^1\)</span> be counterfactual outcomes associated
with control and treatment, respectively. The primary objective of
transportability analysis is to estimate the ATE in the target
population: <span class="math display">\[ATE = \mathrm{E}[Y^1 - Y^0
\,|\,S = 0].\]</span></p>
<p>Simply taking the difference in sample means using the original study
data will only unbiasedly estimate the quantity <span class="math display">\[\mathrm{E}[Y \,|\,A = 1, S = 1] - \mathrm{E}[Y
\,|\,A = 0, S = 1],\]</span> which is different from the target ATE due
to confounding and the different distributions of effect modifiers.</p>
<p>Under the assumptions specified in the Assumptions vignette, we
have</p>
<p><span class="math display">\[\begin{align*}
\mathrm{E}[Y^a \,|\,S = 0] &amp;= \mathrm{E}_{S = 0}\mathrm{E}[Y^a
\,|\,\mathbf{L}, \mathbf{E}] &amp; \\
&amp;= \mathrm{E}_{S=0}\mathrm{E}[Y^a \,|\,A = a, \mathbf{L},
\mathbf{E}] &amp; \textrm{conditional exchangeability wrt treatment
assignment} \\
&amp;= \mathrm{E}_{S=0}\mathrm{E}[Y^a \,|\,A = a, \mathbf{L},
\mathbf{E}, S = 1] &amp; \textrm{conditional exchangeability wrt study
participation} \\
&amp;= \mathrm{E}_{S=0}\mathrm{E}[Y \,|\,A = a, \mathbf{L}, \mathbf{E},
S = 1] &amp; \textrm{consistency}.\\
\end{align*}\]</span></p>
<p>Therefore, we can estimate <span class="math inline">\(\mathrm{E}[Y^a
\,|\,S = 0]\)</span> unbiasedly by averaging samples of <span class="math inline">\(\mathrm{E}[Y \,|\,A = a, \mathbf{L}, \mathbf{E}, S
= 1]\)</span> over the distribution of <span class="math inline">\(\mathbf{L}\)</span> and <span class="math inline">\(\mathbf{E}\)</span> in the target data. We can
obtain such samples by first fitting a regression model of <span class="math inline">\(Y\)</span> in terms of <span class="math inline">\(A\)</span>, <span class="math inline">\(\mathbf{L}\)</span> and <span class="math inline">\(\mathbf{E}\)</span>, which essentially fits a
model of <span class="math inline">\(\mathrm{E}[Y \,|\,A = a,
\mathbf{L}, \mathbf{E}, S = 1]\)</span>. Then, this model is used to
calculate fitted values of <span class="math inline">\(Y\)</span> at
observed values of <span class="math inline">\(\mathbf{L}\)</span> and
<span class="math inline">\(\mathbf{E}\)</span> in the target data with
<span class="math inline">\(A\)</span> being set to <span class="math inline">\(a\)</span>. The fitted values may be seen as
“samples” of <span class="math inline">\(\mathrm{E}[Y \,|\,A = a,
\mathbf{L}, \mathbf{E}, S = 1]\)</span> where <span class="math inline">\(\mathbf{L}\)</span> and <span class="math inline">\(\mathbf{E}\)</span> are empirically drawn from the
target data, so they are averaged to obtain an estimate of the
counterfactual mean above. From this, the target ATE may be estimated
unbiasedly, provided that the outcome model is specified correctly.</p>
<p>For more information, check out the “What If” book on causal
inference <span class="citation">(Hernán and Robins 2024)</span>, which
includes a discussion of g-computation for confounding adjustment.</p>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-what-if" class="csl-entry">
Hernán, MA, and JM Robins. 2024. <em>Causal Inference: What If?</em>
Boca Raton: Chapman &amp; Hall/CRC.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Core Clinical Sciences, Quang Vuong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
