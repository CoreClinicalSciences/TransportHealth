<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<style>body{background-color:white;}</style>
<link href="TransportHealth-report_files/fill.css" rel="stylesheet">
<script src="TransportHealth-report_files/htmlwidgets.js"></script>
<link href="TransportHealth-report_files/datatables-crosstalk.css" rel="stylesheet">
<script src="TransportHealth-report_files/datatables.js"></script>
<script src="TransportHealth-report_files/jquery-3.6.0.min.js"></script>
<link href="TransportHealth-report_files/jquery.dataTables.min.css" rel="stylesheet">
<link href="TransportHealth-report_files/jquery.dataTables.extra.css" rel="stylesheet">
<script src="TransportHealth-report_files/jquery.dataTables.min.js"></script>
<link href="TransportHealth-report_files/crosstalk.min.css" rel="stylesheet">
<script src="TransportHealth-report_files/crosstalk.min.js"></script>
<link href="TransportHealth-report_files/rstudio.css" rel="stylesheet">
<script src="TransportHealth-report_files/highlight.pack.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="TransportHealth-report_files/bootstrap.min.css" rel="stylesheet">
<link href="TransportHealth-report_files/bootstrap-theme.min.css" rel="stylesheet">
<script src="TransportHealth-report_files/bootstrap.min.js"></script>
<script src="TransportHealth-report_files/html5shiv.min.js"></script>
<script src="TransportHealth-report_files/respond.min.js"></script>

</head>
<body>
<div class="container-fluid">
  <style type="text/css">table tr:hover td {
  font-weight:bold;text-decoration:none
}
table tr.covered td{
  background-color:rgba(95,151,68,0.3)
}

table tr:hover.covered .num{
  background-color:rgba(95,151,68,0.7)
}
table tr.missed td{
  background-color:rgba(185,73,71,0.3)
}
table tr:hover.missed .num{
  background-color:rgba(185,73,71,0.7)
}

table tr.missed:hover td{
  -webkit-box-shadow:0 -2px 0 0 #b94947 inset;
  -moz-box-shadow:0 -2px 0 0 #b94947 inset;
  box-shadow:0 -2px 0 0 #b94947 inset
}
table tr.covered:hover td{
  -webkit-box-shadow:0 -2px 0 0 #5f9744 inset;
  -moz-box-shadow:0 -2px 0 0 #5f9744 inset;
  box-shadow:0 -2px 0 0 #5f9744 inset
}

table tr.never td{
  background-color:transparent
}

table tbody {
  border-style: solid;
  border: 1px solid rgba(0,0,0,0.1)
}

table .num {
  border-right: 1px solid rgba(0,0,0,0.1)
}

td.coverage em {
  opacity: 0.5;
}

table td.coverage {
  border-right: 1px solid rgba(0,0,0,0.1);
  font-weight: bold;
  text-align: center;
}
table.table-condensed pre {
  background-color: transparent;
  margin: 0;
  padding: 0;
  border: 0;
  font-size: 11px;
}
div#files td {
  padding: 0;
  padding-left: 5px;
}

div#files td.num {
  padding-right: 5px;
}

table.table-condensed {
  font-size: 11px;
}</style>
  <div class="col-md-8 col-md-offset-2">
    <h2>TransportHealth coverage - 91.56%</h2>
    <div class="tabbable">
      <ul class="nav nav-tabs" data-tabsetid="covr">
        <li class="active">
          <a href="#tab-covr-1" data-toggle="tab" data-value="Files">Files</a>
        </li>
        <li>
          <a href="#tab-covr-2" data-toggle="tab" data-value="Source">Source</a>
        </li>
      </ul>
      <div class="tab-content" data-tabsetid="covr">
        <div class="tab-pane active" title="Files" data-value="Files" id="tab-covr-1">
          <div class="datatables html-widget html-fill-item html-widget-static-bound" id="htmlwidget-297776682dc4b8c18705" style="width:100%;height:500px;"><div id="DataTables_Table_0_wrapper" class="dataTables_wrapper no-footer"><table class="row-border dataTable no-footer" id="DataTables_Table_0">
  <thead>
    <tr><th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="File: activate to sort column ascending">File</th><th class="dt-right sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Lines: activate to sort column ascending">Lines</th><th class="dt-right sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Relevant: activate to sort column ascending">Relevant</th><th class="dt-right sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Covered: activate to sort column ascending">Covered</th><th class="dt-right sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Missed: activate to sort column ascending">Missed</th><th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Hits / Line: activate to sort column ascending">Hits / Line</th><th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="Coverage: activate to sort column ascending">Coverage</th></tr>
  </thead><tbody><tr class="odd"><td><a href="#">R/transportTADA.R</a></td><td class="  dt-right">1288</td><td class="  dt-right">565</td><td class="  dt-right">511</td><td class="  dt-right">54</td><td>579</td><td style="background: linear-gradient(90deg, rgb(237, 253, 231) 90.44%, white 90.44%);">90.44%</td></tr><tr class="even"><td><a href="#">R/transportGC.R</a></td><td class="  dt-right">328</td><td class="  dt-right">129</td><td class="  dt-right">118</td><td class="  dt-right">11</td><td>2013</td><td style="background: linear-gradient(90deg, rgb(237, 253, 231) 91.47%, white 91.47%);">91.47%</td></tr><tr class="odd"><td><a href="#">R/transportGCPreparedModel.R</a></td><td class="  dt-right">136</td><td class="  dt-right">47</td><td class="  dt-right">43</td><td class="  dt-right">4</td><td>1666</td><td style="background: linear-gradient(90deg, rgb(237, 253, 231) 91.49%, white 91.49%);">91.49%</td></tr><tr class="even"><td><a href="#">R/transportIP.R</a></td><td class="  dt-right">673</td><td class="  dt-right">352</td><td class="  dt-right">324</td><td class="  dt-right">28</td><td>3974</td><td style="background: linear-gradient(90deg, rgb(237, 253, 231) 92.05%, white 92.05%);">92.05%</td></tr><tr class="odd"><td><a href="#">R/trunc.R</a></td><td class="  dt-right">42</td><td class="  dt-right">14</td><td class="  dt-right">13</td><td class="  dt-right">1</td><td>5986</td><td style="background: linear-gradient(90deg, rgb(237, 253, 231) 92.86%, white 92.86%);">92.86%</td></tr><tr class="even"><td><a href="#">R/transportInterpolated.R</a></td><td class="  dt-right">308</td><td class="  dt-right">132</td><td class="  dt-right">123</td><td class="  dt-right">9</td><td>2</td><td style="background: linear-gradient(90deg, rgb(237, 253, 231) 93.18%, white 93.18%);">93.18%</td></tr><tr class="odd"><td><a href="#">R/trim.R</a></td><td class="  dt-right">31</td><td class="  dt-right">8</td><td class="  dt-right">8</td><td class="  dt-right">0</td><td>2118</td><td style="background: linear-gradient(90deg, rgb(237, 253, 231) 100%, white 100%);">100.00%</td></tr></tbody>
</table></div></div>
          <script type="application/json" data-for="htmlwidget-297776682dc4b8c18705">{"x":{"filter":"none","vertical":false,"fillContainer":false,"data":[["<a href=\"#\">R/transportTADA.R<\/a>","<a href=\"#\">R/transportGC.R<\/a>","<a href=\"#\">R/transportGCPreparedModel.R<\/a>","<a href=\"#\">R/transportIP.R<\/a>","<a href=\"#\">R/trunc.R<\/a>","<a href=\"#\">R/transportInterpolated.R<\/a>","<a href=\"#\">R/trim.R<\/a>"],[1288,328,136,673,42,308,31],[565,129,47,352,14,132,8],[511,118,43,324,13,123,8],[54,11,4,28,1,9,0],["579","2013","1666","3974","5986","2","2118"],["90.44%","91.47%","91.49%","92.05%","92.86%","93.18%","100.00%"]],"container":"<table class=\"row-border\">\n  <thead>\n    <tr>\n      <th>File<\/th>\n      <th>Lines<\/th>\n      <th>Relevant<\/th>\n      <th>Covered<\/th>\n      <th>Missed<\/th>\n      <th>Hits / Line<\/th>\n      <th>Coverage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"dom":"t","paging":false,"columnDefs":[{"targets":6,"createdCell":"function(td, cellData, rowData, row, col) {\n  var percent = cellData.replace(\"%\", \"\");\n  if (percent > 90) {\n    var grad = \"linear-gradient(90deg, #edfde7 \" + cellData + \", white \" + cellData + \")\";\n  } else if (percent > 75) {\n    var grad = \"linear-gradient(90deg, #f9ffe5 \" + cellData + \", white \" + cellData + \")\";\n  } else {\n    var grad = \"linear-gradient(90deg, #fcece9 \" + cellData + \", white \" + cellData + \")\";\n  }\n  $(td).css(\"background\", grad);\n}\n"},{"className":"dt-right","targets":[1,2,3,4]},{"name":"File","targets":0},{"name":"Lines","targets":1},{"name":"Relevant","targets":2},{"name":"Covered","targets":3},{"name":"Missed","targets":4},{"name":"Hits / Line","targets":5},{"name":"Coverage","targets":6}],"order":[],"autoWidth":false,"orderClasses":false},"callback":"function(table) {\ntable.on('click.dt', 'a', function() {\n  files = $('div#files div');\n  files.not('div.hidden').addClass('hidden');\n  id = $(this).text();\n  files.filter('div[id=\\'' + id + '\\']').removeClass('hidden');\n  $('ul.nav a[data-value=Source]').text(id).tab('show');\n});\n}","selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.columnDefs.0.createdCell","callback"],"jsHooks":[]}</script>
        </div>
        <div class="tab-pane" title="Source" data-value="Source" id="tab-covr-2">
          <div id="files">
            <div id="R/transportTADA.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title  Transportability analysis using TADA</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Estimates the coefficients of a marginal structural model (MSM) using Target Aggregate Data Adjustment (TADA) Transportability Analysis in a transportability analysis.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param msmFormula A formula for the MSM to be fitted, which usually includes the outcome, the treatment and any effect modifiers.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param propensityScoreModel Either a formula or a \code{glm} object representing the model for treatment assignment given covariates.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param matchingCovariates A vector of user-specified covariates which are used for the data matching to obtain participation weights when no custom weights provided.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param propensityWeights Vector of custom weights balancing covariates between treatments. Providing them will override the formula or model provided by \code{propensityScoreModel}. This vector should have as any entries as the sample size of the study data.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param participationWeights Vector of custom weights balancing effect modifiers between study and target populations. This vector should have as any entries as the sample size of the study data.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param treatment String indicating name of treatment variable. If \code{NULL}, it will be auto-detected from \code{propensityScoreModel} if provided; otherwise it will remain \code{NULL}. Note that when using custom weights, \code{treatment} should be provided so that \code{summary.transportTADA} and \code{plot.transportTADA} works.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param response String indicating name of response variable. If \code{NULL}, it will be auto-detected form \code{msmFormula}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param family Either a \code{family} function as used for \code{glm} such as stats::gaussian(), or one of \code{c("coxph", "survreg", "polr")}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param method Link function used for \code{polr}, one of \code{c("logistic", "probit", "loglog", "cloglog", "cauchit")}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param exOpt A list with components \code{propensity}, \code{participation} and \code{final}. Each component specifies whether weights should be trimmed or truncated. Use the functions \code{trim} and \code{trunc} to specify trimming/truncation. Note that only truncation is supported for final weights.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param studyData The individual participant data (IPD) of study population.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param aggregateTargetData The aggregate-level data (AgD) of target population. Ensure that: 1. Name columns of mean of continuous variables or proportion of binary variable baselines exactly the same as the column names in the study (IPD) data; 2. Only continuous variables are allowed to consider matching standard deviation (SD) and name the SD column as "variable_SD" in the aggregateTargetData; 3. Use one of the following allowable suffixes: MEAN, MEDIAN, SD, PROP, COUNT. The column N should be included for the sample size.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param bootstrapNum Number of bootstrap datasets to simulate to obtain robust variance estimate.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom Rdpack reprompt</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @details</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The function fits models of treatment assignment and study participation in order to calculate the weights used to fit the MSM. For the propensity score model, if a formula is provided, logistic regression is used by default. If a \code{glm} object is provided, the function extracts the necessary weights from the object. The function does not support other weighting methods, so if they are required, provide custom weights. The weights that adjust for effect modifiers are calculated in a manner analogous to matching-adjusted indirect comparison (MAIC) (Phillipo et al., 2018); this is supported by helper functions based on those used in the \code{maicplus} package (Chen et al., 2024).</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The MSM-fitting functions do not provide correct standard errors as-is. Bootstrap is used to calculate robust bootstrap variance estimators of the parameter estimators. The function replaces the variance component in \code{summary.glm}, \code{coxph} and \code{survreg} with the robust variance estimators directly. This does not seem to behave well with \code{predict.glm} yet, but prediction is not of primary interest in a transportability analysis.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Ensure the binary variables are labelled as 0-1 format.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{transportTADA} object containing the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{msm}: Raw model fit object for MSM of class \code{glm}, \code{survreg} and \code{coxph}, with the correct variance estimators appropriately replaced. If of class \code{glm}, it will have an extra \code{var} component containing the correct variance estimates.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{propensityScoreModel}: Model of treatment assignment, \code{NULL} if not provided and custom propensity weights are used.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{propensityWeights}: Propensity weights used. When not \code{NULL}, it will be used as custom inputs from user. When \code{NULL}, it will be obtained by logistic regression.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{participationWeights}: Participation Weights used. When not \code{NULL}, it will be used as custom inputs from user. When \code{NULL}, it will be obtained by Method of Moments-based method.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{participationWeightCalculation}: The object contains participation weights calculation results.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{participationWeightSummary}: The summary results related to participation weights such as effect sample sizes and so on as the information for the visualization legend.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{finalWeights}: Weights used to fit MSM.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{customPropensity}: Boolean indicating whether custom propensity weights are used.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{customParticipation}: Boolean indicating whether custom participation weights are used.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{treatment}: String indicating the variable name of treatment.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{response}: String indicating the variable name of response.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{studyData}: The original individual participant data (IPD) of study population.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{aggregateTargetData}: The aggregate-level data (AgD) of target population.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{processedIPD}: The individual participant data (IPD) after analytically pre-processing in format and calibration. All the ordinal variables have been dummized. \code{NULL} when \code{customParticipation} is \code{TRUE}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{processedAgD}: The aggregate-level data (AgD) after analytically pre-processing in format and calibration. \code{NULL} when \code{customParticipation} is \code{TRUE}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{matchingCovariates}: A vector of user-specified covariates which are used for the data matching to obtain participation weights when no custom weights provided.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{centeredStudyData}: The data frame with both the processed study data and centered study data. </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{exOpt}: Provided \code{exOpt} argument.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @references</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Chen G, Seo M, Gravestock I (2024). maicplus: Matching Adjusted Indirect Comparison. R package version 0.1.1, &lt;https://CRAN.R-project.org/package=maicplus&gt;.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Phillippo DM, Ades AE, Dias S, Palmer S, Abrams KR, Welton NJ. Methods for Population-Adjusted Indirect Comparisons in Health Technology Appraisal. Medical Decision Making. 2018;38(2):200-211. doi:10.1177/0272989X17725740</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @md</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transportTADA</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">msmFormula</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">propensityScoreModel</span> <span class="operator">=</span> <span class="literal">NULL</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">matchingCovariates</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># User-specified matching covariates inputs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">propensityWeights</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># vector of (custom) propensity weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">participationWeights</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># vector of (custom) participation weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">treatment</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># string, name of treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">response</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># string, name of response</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">gaussian</span>, <span class="comment"># any available family for glm such as "gaussian", OR, "coxph" / "survreg"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"logistic"</span>, <span class="string">"probit"</span>, <span class="string">"loglog"</span>, <span class="string">"cloglog"</span>, <span class="string">"cauchit"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">exOpt</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">propensity</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">72</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">participation</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">final</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">studyData</span>, <span class="comment"># data of study population (studyData): N rows, data.frame with responses and variables</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">aggregateTargetData</span>,  <span class="comment"># data of target population (aggregateTargetData): 1 row, data.frame with only aggregate variables</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">bootstrapNum</span> <span class="operator">=</span> <span class="number">100</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">78</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportTADAResult</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAFit</span><span class="paren">(</span><span class="identifier">msmFormula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">79</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">propensityScoreModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">80</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">matchingCovariates</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">81</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">propensityWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">82</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">participationWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">83</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">84</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">response</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">85</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">family</span>, <span class="identifier">method</span>, <span class="identifier">exOpt</span>, <span class="identifier">studyData</span>, <span class="identifier">aggregateTargetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">86</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">87</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Correct variance estimates by performing bootstrap, resampling study data non-parametrically and resampling target data parametrically</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">88</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">89</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">customPropensity</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">customParticipation</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">90</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Extract treatment study data, control study data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">91</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityScoreModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">93</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">treatmentLevels</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">as.factor</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">94</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">treatmentGroupData</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">95</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">96</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentGroupData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span><span class="paren">[</span><span class="identifier">as.character</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">y</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">level</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">98</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nLevels</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">treatmentGroupData</span>, <span class="identifier">nrow</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">99</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">names</span><span class="paren">(</span><span class="identifier">nLevels</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">100</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">101</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">bootstrapEstimates</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">sapply</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">bootstrapNum</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">102</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                   <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">103</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="comment"># Resample study data by study group</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">104</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">treatmentGroupBoot</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">105</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">106</td>
                    <td class="coverage">1600<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">nSample</span> <span class="operator">&lt;-</span> <span class="identifier">nLevels</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">107</td>
                    <td class="coverage">1600<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentGroupData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">sample.int</span><span class="paren">(</span><span class="identifier">nSample</span>, <span class="identifier">replace</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">109</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">110</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">exists</span><span class="paren">(</span><span class="string">"studyBoot"</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">studyBoot</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">111</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="keyword">else</span> <span class="identifier">studyBoot</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">studyBoot</span>, <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">112</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">113</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="comment"># Resample target data parametrically, assuming a normal distribution for continuous covariates</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">115</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">aggregateTargetBoot</span> <span class="operator">&lt;-</span> <span class="identifier">aggregateTargetRef</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">aggregateTargetData</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">116</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">varNames</span> <span class="operator">&lt;-</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">aggregateTargetRef</span><span class="paren">)</span> <span class="operator">|</span><span class="operator">&gt;</span> <span class="identifier">gsub</span><span class="paren">(</span><span class="string">"_(MEAN|MEDIAN|SD|PROP|COUNT)$"</span>, <span class="string">""</span>, <span class="identifier">x</span> <span class="operator">=</span> _<span class="paren">)</span> <span class="operator">|</span><span class="operator">&gt;</span> <span class="identifier">unique</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">117</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">118</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">varName</span> <span class="keyword">in</span> <span class="identifier">varNames</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">119</td>
                    <td class="coverage">6400<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">varName</span> <span class="operator">==</span> <span class="string">"N"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">120</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">aggregateTargetBoot</span><span class="operator">$</span><span class="identifier">N</span> <span class="operator">&lt;-</span> <span class="identifier">aggregateTargetRef</span><span class="operator">$</span><span class="identifier">N</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">122</td>
                    <td class="coverage">5600<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">aggregateVarNames</span> <span class="operator">&lt;-</span> <span class="identifier">grep</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"^"</span>,<span class="identifier">varName</span>,<span class="string">"_"</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">aggregateTargetRef</span><span class="paren">)</span>, <span class="identifier">value</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">123</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">124</td>
                    <td class="coverage">5600<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">any</span><span class="paren">(</span><span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_PROP$"</span>, <span class="identifier">aggregateVarNames</span>, <span class="identifier">ignore.case</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">125</td>
                    <td class="coverage">4000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">propName</span> <span class="operator">&lt;-</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">varName</span>, <span class="string">"_PROP"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">126</td>
                    <td class="coverage">4000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">aggregateTargetBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">propName</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">rbinom</span><span class="paren">(</span><span class="number">1</span>, <span class="identifier">aggregateTargetRef</span><span class="operator">$</span><span class="identifier">N</span>, <span class="identifier">aggregateTargetRef</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">propName</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">/</span> <span class="identifier">aggregateTargetRef</span><span class="operator">$</span><span class="identifier">N</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">127</td>
                    <td class="coverage">1600<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">any</span><span class="paren">(</span><span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_(MEAN|MEDIAN|SD)$"</span>, <span class="identifier">aggregateVarNames</span>, <span class="identifier">ignore.case</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">128</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">meanName</span> <span class="operator">&lt;-</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">varName</span>, <span class="string">"_MEAN"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">129</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">medianName</span> <span class="operator">&lt;-</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">varName</span>, <span class="string">"_MEDIAN"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">130</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">sdName</span> <span class="operator">&lt;-</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">varName</span>, <span class="string">"_SD"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">131</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">132</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">meanIdx</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">aggregateTargetRef</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">meanName</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">133</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">medianIdx</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">aggregateTargetRef</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">medianName</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">134</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">sdIdx</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">aggregateTargetRef</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">sdName</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">135</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">136</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">meanIdx</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span> <span class="operator">&amp;</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">medianIdx</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Please provide mean or median of continuous covariate in target data."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">137</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">138</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">meanBoot</span> <span class="operator">&lt;-</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">meanIdx</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span>, <span class="identifier">aggregateTargetRef</span><span class="paren">[</span><span class="number">1</span>, <span class="identifier">meanIdx</span><span class="paren">]</span>, <span class="identifier">aggregateTargetRef</span><span class="paren">[</span><span class="number">1</span>, <span class="identifier">medianIdx</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">139</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">sdBoot</span> <span class="operator">&lt;-</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">sdIdx</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span>, <span class="identifier">aggregateTargetRef</span><span class="paren">[</span><span class="number">1</span>, <span class="identifier">sdIdx</span><span class="paren">]</span>, <span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">140</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">141</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="identifier">bootData</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">rnorm</span><span class="paren">(</span><span class="identifier">aggregateTargetRef</span><span class="operator">$</span><span class="identifier">N</span>, <span class="identifier">meanBoot</span>, <span class="identifier">sdBoot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">143</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">meanIdx</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="identifier">aggregateTargetBoot</span><span class="paren">[</span><span class="number">1</span>,<span class="identifier">meanIdx</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="identifier">bootData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">144</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">medianIdx</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="identifier">aggregateTargetBoot</span><span class="paren">[</span><span class="number">1</span>,<span class="identifier">medianIdx</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">median</span><span class="paren">(</span><span class="identifier">bootData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">145</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                         <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">sdIdx</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="identifier">aggregateTargetBoot</span><span class="paren">[</span><span class="number">1</span>, <span class="identifier">sdIdx</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">sd</span><span class="paren">(</span><span class="identifier">bootData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">146</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                          <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">147</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">148</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">149</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">150</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">suppressWarnings</span><span class="paren">(</span><span class="identifier">resultBoot</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAFit</span><span class="paren">(</span><span class="identifier">msmFormula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">151</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">propensityScoreModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">152</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">matchingCovariates</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">153</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">propensityWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">154</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">participationWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">155</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">156</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">response</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">157</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">family</span>, <span class="identifier">method</span>, <span class="identifier">exOpt</span>, <span class="identifier">studyBoot</span>, <span class="identifier">aggregateTargetBoot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">158</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">159</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">160</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="comment"># Add on intercept estimates from polr case. This is okay because concatenating with a NULL does nothing</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">161</td>
                    <td class="coverage">800<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="keyword">return</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="identifier">resultBoot</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">coefficients</span>, <span class="identifier">resultBoot</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">zeta</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">162</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                   <span class="paren">}</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">163</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">164</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">bootstrapEstimates</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="identifier">bootstrapEstimates</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">bootstrapEstimates</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">165</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">166</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Still okay outside of polr cases because concatenating with a NULL does nothing.</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">167</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">varMatrix</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">var</span><span class="paren">(</span><span class="identifier">bootstrapEstimates</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">168</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">varMatrix</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">varMatrix</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">zeta</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">169</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span> <span class="operator">&lt;-</span> <span class="identifier">varMatrix</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">170</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">171</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Custom weights are being used. Variance estimates may be biased."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">172</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">173</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">174</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">bootstrapNum</span> <span class="operator">=</span> <span class="identifier">bootstrapNum</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">175</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">176</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">177</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">178</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transportTADAFit</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">msmFormula</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">180</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">181</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">propensityScoreModel</span> <span class="operator">=</span> <span class="literal">NULL</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">182</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">matchingCovariates</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># User-specified matching covariates inputs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">183</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">184</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">propensityWeights</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># vector of (custom) propensity weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">185</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">participationWeights</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># vector of (custom) participation weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">186</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">187</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">treatment</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># string, name of treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">188</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">response</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="comment"># string, name of response</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">189</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">190</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">gaussian</span>, <span class="comment"># any available family for glm such as "gaussian", OR, "coxph" / "survreg"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">191</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">192</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"logistic"</span>, <span class="string">"probit"</span>, <span class="string">"loglog"</span>, <span class="string">"cloglog"</span>, <span class="string">"cauchit"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">193</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">exOpt</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">propensity</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">194</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">participation</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">195</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">final</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">196</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">studyData</span>, <span class="comment"># data of study population (studyData): N rows, data.frame with responses and variables</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">197</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">aggregateTargetData</span>  <span class="comment"># data of target population (aggregateTargetData): 1 row, data.frame with only aggregate variables</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">198</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">199</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">200</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># TODO: bugfix for 1 EM</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">201</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">202</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">response</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">response</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">msmFormula</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">203</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">204</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">treatment</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">205</td>
                    <td class="coverage">801<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.glm</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">treatment</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">formula</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">206</td>
                    <td class="coverage">7<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="identifier">treatment</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">207</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">208</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">209</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Check input formats</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">210</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span>, <span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">aggregateTargetData</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># input format checking</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">211</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">response</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># there must be "response" in studyData dataset</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">212</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">aggregateTargetData</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="comment"># aggregateTargetData can only be 1 row data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">213</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">214</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Determine matching covariates</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">215</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">matchingCovariates</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">216</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Check if the user-specified matching covariates exist in both studyData and aggregateTargetData</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">217</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">validCov</span> <span class="operator">&lt;-</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">matchingCovariates</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">218</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">219</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">validCov_TF</span> <span class="operator">&lt;-</span> <span class="identifier">grepl</span><span class="paren">(</span><span class="identifier">paste</span><span class="paren">(</span><span class="string">"^"</span>, <span class="identifier">validCov</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">""</span>, <span class="identifier">collapse</span> <span class="operator">=</span> <span class="string">"|"</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">aggregateTargetData</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">220</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># for the paste(): if the validCov being c(age, sex), then it gives regular expression ^age|^sex</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">221</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># for the grepl(): matches regex pattern within the names of columns in AgD and gives TRUE FALSE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">222</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">223</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">matchedAgDNames</span> <span class="operator">&lt;-</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">aggregateTargetData</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">validCov_TF</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">224</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">225</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">prefixes</span> <span class="operator">&lt;-</span> <span class="identifier">unique</span><span class="paren">(</span><span class="identifier">sub</span><span class="paren">(</span><span class="string">"_.*"</span>, <span class="string">""</span>, <span class="identifier">matchedAgDNames</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">226</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">227</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">validCov</span> <span class="operator">&lt;-</span> <span class="identifier">validCov</span><span class="paren">[</span><span class="identifier">validCov</span> <span class="operator">%in%</span> <span class="identifier">prefixes</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">228</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">229</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># If there are any covariates in the user input that don't match, give a warning and remove them</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">230</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">validCov</span><span class="paren">)</span> <span class="operator">!=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">matchingCovariates</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">231</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">removedCov</span> <span class="operator">&lt;-</span> <span class="identifier">setdiff</span><span class="paren">(</span><span class="identifier">matchingCovariates</span>, <span class="identifier">validCov</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">232</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="identifier">cat</span><span class="paren">(</span><span class="string">"The following user-specfied matching covariates were not found in neither studyData or aggregateTargetData and have been removed:"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">233</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">toString</span><span class="paren">(</span><span class="identifier">removedCov</span><span class="paren">)</span>, <span class="string">"\n"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">234</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">235</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">236</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">matchingCovariates</span> <span class="operator">&lt;-</span> <span class="identifier">validCov</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">237</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">238</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">239</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#  If formula is provided for treatment and participation models, fit models ourselves</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">240</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="string">"formula"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># if it is in the format of formula </span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">241</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityScoreModel</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glm</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">242</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">243</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">binomial</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># logistic regression</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">244</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">245</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">246</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">is.glm</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">247</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">248</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">249</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">250</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># -------- Propensity Weights -----------</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">251</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Track Custom Propensity Weights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">252</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">customPropensity</span> <span class="operator">&lt;-</span> <span class="literal">F</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">253</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">254</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Custom propensity weights are being used. Please ensure that these weights are meaningful."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">255</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">customPropensity</span> <span class="operator">&lt;-</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">256</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">257</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Both propensity model and custom weights are provided, using custom weights."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">258</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">259</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># obtain propensity weights when no custom weights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">260</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">261</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityWeights</span> <span class="operator">&lt;-</span> <span class="identifier">obtainWeights</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"probability"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">262</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">263</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">propensity</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">264</td>
                    <td class="coverage">606<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">propensityOpt</span> <span class="operator">&lt;-</span> <span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">propensity</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">265</td>
                    <td class="coverage">404<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trunc</span><span class="paren">(</span><span class="identifier">propensityOpt</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">propensityWeights</span> <span class="operator">&lt;-</span> <span class="identifier">truncWeights</span><span class="paren">(</span><span class="identifier">propensityWeights</span>, <span class="identifier">propensityOpt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">266</td>
                    <td class="coverage">202<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trim</span><span class="paren">(</span><span class="identifier">propensityOpt</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">267</td>
                    <td class="coverage">202<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">retainedObsIndPropensity</span> <span class="operator">&lt;-</span> <span class="identifier">trimInd</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="identifier">propensityOpt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">268</td>
                    <td class="coverage">202<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">propensityScoreModel</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">update</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">269</td>
                    <td class="coverage">202<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                              <span class="identifier">formula</span>. <span class="operator">=</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">formula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">270</td>
                    <td class="coverage">202<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                              <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">cbind</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">data</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">271</td>
                    <td class="coverage">202<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                           <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">retainedObsIndPropensity</span> <span class="operator">=</span> <span class="identifier">retainedObsIndPropensity</span><span class="paren">)</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">272</td>
                    <td class="coverage">202<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                              <span class="identifier">weights</span> <span class="operator">=</span> <span class="identifier">retainedObsIndPropensity</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">273</td>
                    <td class="coverage">202<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">propensityWeights</span> <span class="operator">&lt;-</span> <span class="identifier">obtainWeights</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"probability"</span><span class="paren">)</span> <span class="operator">*</span> <span class="identifier">retainedObsIndPropensity</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">274</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">275</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">276</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">277</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">278</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">279</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># -------- Participation Weights -----------</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">280</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">281</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># detect exist ordinal variables: factor, more than 2 levels</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">282</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">matchingCovariatesSubset</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span><span class="paren">[</span><span class="identifier">matchingCovariates</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">283</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">284</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># format checking before dummizing the ordinal variables, and ensure 0-1 numeric binary matching covariates</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">285</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">binaryMatchingVariables</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">286</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">287</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">matchingCovariatesSubset</span><span class="paren">[</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">matchingCovariatesSubset</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">varName</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">288</td>
                    <td class="coverage">4045<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">x</span> <span class="operator">&lt;-</span> <span class="identifier">matchingCovariatesSubset</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">varName</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">289</td>
                    <td class="coverage">4045<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">uniqueVals</span> <span class="operator">&lt;-</span> <span class="identifier">unique</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">290</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">291</td>
                    <td class="coverage">4045<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">uniqueVals</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">2</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">292</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># For matching variables like Gender: "Male" / "Female"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">293</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># For matching variables like Gender but labelled as Male = "3" and Female = "5" (the label has to be 0-1) </span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">294</td>
                    <td class="coverage">2427<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">&amp;&amp;</span> <span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">uniqueVals</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="number">0</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">||</span> <span class="operator">!</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">295</td>
                    <td class="coverage">2427<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">binaryMatchingVariables</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">binaryMatchingVariables</span>, <span class="identifier">varName</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">296</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">297</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">298</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">299</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># For ordinal variables like Season: "Spring" / "Summer" / "Fall" / "Winter"</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">300</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">&amp;&amp;</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">uniqueVals</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">2</span><span class="paren">)</span> <span class="paren">{</span> <span class="identifier">x</span> <span class="operator">&lt;-</span> <span class="identifier">factor</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">301</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">302</td>
                    <td class="coverage">4045<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">303</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">304</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">305</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Warning user to manually update inputs</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">306</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">binaryMatchingVariables</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">307</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">sprintf</span><span class="paren">(</span><span class="string">"Please manually verify and possibly convert to 0-1 numeric scale the following binary matching covariates before further analysis: (%s)"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">308</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">paste</span><span class="paren">(</span><span class="identifier">binaryMatchingVariables</span>, <span class="identifier">collapse</span> <span class="operator">=</span> <span class="string">", "</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">309</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">310</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">311</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">312</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ordinalCovariates</span> <span class="operator">&lt;-</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">matchingCovariatesSubset</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">matchingCovariatesSubset</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">is.factor</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">&amp;&amp;</span> <span class="identifier">nlevels</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">2</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">313</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">314</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">315</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">ordinalCovariates</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">316</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dummizeCols</span> <span class="operator">=</span> <span class="identifier">ordinalCovariates</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">317</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dummizeIPD</span> <span class="operator">&lt;-</span> <span class="identifier">dummizeIPD</span><span class="paren">(</span><span class="identifier">studyData</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">318</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">dummizeCols</span> <span class="operator">=</span> <span class="identifier">dummizeCols</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">319</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">320</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dummizeIPD</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">321</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">322</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">323</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">processedAgD</span> <span class="operator">&lt;-</span> <span class="identifier">processedAgD</span><span class="paren">(</span><span class="identifier">aggregateTargetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">324</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">centeredIPD</span> <span class="operator">&lt;-</span> <span class="identifier">centerIPD</span><span class="paren">(</span><span class="identifier">IPD</span> <span class="operator">=</span> <span class="identifier">dummizeIPD</span>, <span class="identifier">AgD</span> <span class="operator">=</span> <span class="identifier">processedAgD</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">325</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">326</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">centeredColnames</span> <span class="operator">&lt;-</span> <span class="identifier">grep</span><span class="paren">(</span><span class="string">"_CENTERED"</span>, <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">centeredIPD</span><span class="paren">)</span>, <span class="identifier">value</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="comment"># add suffix for centered variables</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">327</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">328</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">329</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Track Custom Participation Weights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">330</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">customParticipation</span> <span class="operator">&lt;-</span> <span class="literal">F</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">331</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">332</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Custom participation weights are being used. Please ensure that these weights are meaningful."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">333</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">customParticipation</span> <span class="operator">&lt;-</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">334</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">335</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">336</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># ------- participationWeightCalculation based on custom participation weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">337</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">338</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt</span> <span class="operator">&lt;-</span> <span class="identifier">participationWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">339</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt_rs</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">wt</span> <span class="operator">/</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">*</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">complete.cases</span><span class="paren">(</span><span class="identifier">matchingCovariatesSubset</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># avoid NAs in matchingCovariatesSubset</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">340</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">data</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">weights</span> <span class="operator">=</span> <span class="identifier">wt</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">341</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                       <span class="identifier">scaledWeights</span> <span class="operator">=</span> <span class="identifier">wt_rs</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">342</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">343</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeightCalculation</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">344</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">data</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">345</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ESS</span> <span class="operator">=</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span><span class="operator">^</span><span class="number">2</span> <span class="operator">/</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">wt</span><span class="operator">^</span><span class="number">2</span><span class="paren">)</span> <span class="comment"># effective sample size</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">346</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">347</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">348</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># ------- participationWeightSummary based on custom participation weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">349</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">350</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># participationWeightSummary &lt;- calculateWeightsLegend(weightedData = participationWeightCalculation)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">351</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">summaryESS</span> <span class="operator">&lt;-</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">participationWeightCalculation</span><span class="operator">$</span><span class="identifier">ESS</span>, <span class="number">2</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">352</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ESS_reduction</span> <span class="operator">&lt;-</span> <span class="identifier">round</span><span class="paren">(</span><span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="identifier">summaryESS</span><span class="operator">/</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">*</span> <span class="number">100</span>, <span class="number">2</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">353</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt_median</span> <span class="operator">&lt;-</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">median</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span>, <span class="number">4</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">354</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt_scaled_median</span> <span class="operator">&lt;-</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">median</span><span class="paren">(</span><span class="identifier">wt_rs</span><span class="paren">)</span>, <span class="number">4</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">355</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">356</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeightSummary</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">357</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ESS</span> <span class="operator">=</span> <span class="identifier">summaryESS</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">358</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ESS_reduction</span> <span class="operator">=</span> <span class="identifier">ESS_reduction</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">359</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">wt_median</span> <span class="operator">=</span> <span class="identifier">wt_median</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">360</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">wt_scaled_median</span> <span class="operator">=</span> <span class="identifier">wt_scaled_median</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">361</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">nr_na</span> <span class="operator">=</span> <span class="number">0</span> <span class="comment"># unable to get based on custom participation weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">362</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">363</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">364</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">365</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># obtain participation weights when no custom weights (pending in individual testing scripts)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">366</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">367</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># obtain participation weights when no custom weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">368</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">369</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># ----- Participation Weight Estimation ----- #</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">370</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">371</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># # detect exist ordinal variables: factor, more than 2 levels</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">372</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># matchingCovariatesSubset &lt;- studyData[matchingCovariates]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">373</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">374</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># # format checking before dummizing the ordinal variables, and ensure 0-1 numeric binary matching covariates</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">375</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># binaryMatchingVariables &lt;- c()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">376</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">377</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># matchingCovariatesSubset[] &lt;- lapply(names(matchingCovariatesSubset), function(varName) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">378</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   x &lt;- matchingCovariatesSubset[[varName]]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">379</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   uniqueVals &lt;- unique(x)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">380</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">381</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   if (length(uniqueVals) == 2) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">382</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     # For matching variables like Gender: "Male" / "Female"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">383</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     # For matching variables like Gender but labelled as Male = "3" and Female = "5" (the label has to be 0-1) </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">384</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     if ((is.numeric(x) &amp;&amp; !all(uniqueVals %in% c(0, 1))) || !is.numeric(x)) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">385</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#       binaryMatchingVariables &lt;- c(binaryMatchingVariables, varName)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">386</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">387</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">388</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">389</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   # For ordinal variables like Season: "Spring" / "Summer" / "Fall" / "Winter"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">390</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   if (is.character(x) &amp;&amp; length(uniqueVals) &gt; 2) { x &lt;- factor(x) }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">391</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">392</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   x</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">393</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># })</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">394</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">395</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># # Warning user to manually update inputs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">396</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># if (length(binaryMatchingVariables) &gt; 0) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">397</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   stop(sprintf("Please manually verify and possibly convert to 0-1 numeric scale the following binary matching covariates before further analysis: (%s)", </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">398</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#                 paste(binaryMatchingVariables, collapse = ", ")))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">399</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">400</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">401</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">402</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># ordinalCovariates &lt;- names(matchingCovariatesSubset)[sapply(matchingCovariatesSubset, function(x) is.factor(x) &amp;&amp; nlevels(x) &gt; 2)]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">403</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">404</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">405</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># if(length(ordinalCovariates) &gt; 0){</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">406</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   dummizeCols = ordinalCovariates</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">407</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   dummizeIPD &lt;- dummizeIPD(studyData, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">408</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#                            dummizeCols = dummizeCols)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">409</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">410</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">411</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">412</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">413</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># processedAgD &lt;- processedAgD(aggregateTargetData)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">414</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># centeredIPD &lt;- centerIPD(IPD = dummizeIPD, AgD = processedAgD)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">415</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">416</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># centeredColnames &lt;- grep("_CENTERED", colnames(centeredIPD), value = TRUE) # add suffix for centered variables</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">417</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">418</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">419</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># obtain participation weights when no custom weights (pending in individual testing scripts)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">420</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># ----- Participation Weight Estimation ----- #</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">421</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">422</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># dummizeIPD &lt;- dummizeIPD(studyData, ordinalCovariates)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">423</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># processedAgD &lt;- processedAgD(aggregateTargetData)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">424</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># centerIPD &lt;- centerIPD(IPD = dummizeIPD, AgD = processedAgD)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">425</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">426</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># centeredColnames &lt;- grep("_CENTERED", colnames(centerIPD), value = TRUE) # add suffix for centered variables</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">427</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">428</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeightCalculation</span> <span class="operator">&lt;-</span> <span class="identifier">estimateWeights</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">centeredIPD</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">429</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                      <span class="identifier">centeredColnames</span> <span class="operator">=</span> <span class="identifier">centeredColnames</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">430</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">431</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span><span class="paren">(</span><span class="identifier">participationWeightCalculation</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="string">"weights"</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">432</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">433</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeightSummary</span> <span class="operator">&lt;-</span> <span class="identifier">calculateWeightsLegend</span><span class="paren">(</span><span class="identifier">weightedData</span> <span class="operator">=</span> <span class="identifier">participationWeightCalculation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">434</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">435</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">436</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">437</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">438</td>
                    <td class="coverage">404<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trunc</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">truncWeights</span><span class="paren">(</span><span class="identifier">participationWeights</span>, <span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">439</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trim</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">warning</span><span class="paren">(</span><span class="string">"trim argument provided for participation weights. Note that only truncating participation weights is supported."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">440</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">441</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">442</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># final weights: propensityWeights accounts for the confounding and participationWeights accounts for the EM distribution difference between populations</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">443</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">finalWeights</span> <span class="operator">&lt;-</span>  <span class="identifier">propensityWeights</span> <span class="operator">*</span> <span class="identifier">participationWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">444</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">445</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">final</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">446</td>
                    <td class="coverage">404<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trunc</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">final</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">finalWeights</span> <span class="operator">&lt;-</span> <span class="identifier">truncWeights</span><span class="paren">(</span><span class="identifier">finalWeights</span>, <span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">final</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">447</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trim</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">final</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">warning</span><span class="paren">(</span><span class="string">"trim argument provided for final weights. Note that only truncating final weights is supported."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">448</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">449</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">450</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># ------------------------------------------------------------------------------------------------------------- #</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">451</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">452</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">customPropensity</span><span class="paren">)</span> </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">453</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span><span class="identifier">treatment</span> <span class="operator">%in%</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">msmFormula</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Treatment is not included in MSM!"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">454</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">455</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Fit MSM</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">456</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Variance of coeffs are corrected in this method for coxph() and survreg()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">457</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Variance of coeffs are corrected in summary.transportTADA for glm()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">458</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">459</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Use toAnalyze to keep the original studyData safe and clean</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">460</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">toAnalyze</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">461</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">462</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># The model fitting functions require weights to be part of the data frame</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">463</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">toAnalyze</span><span class="operator">$</span><span class="identifier">finalWeights</span> <span class="operator">&lt;-</span> <span class="identifier">finalWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">464</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">465</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">family</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">466</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">467</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span><span class="identifier">family</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"coxph"</span>, <span class="string">"survreg"</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">468</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Please check the family input and set it as one of the following in character: coxph, survreg."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">469</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">470</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">471</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">family</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">family</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"coxph"</span>, <span class="string">"survreg"</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">472</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">473</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"coxph"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">474</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">coxph</span><span class="paren">(</span><span class="identifier">msmFormula</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">475</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                               <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">toAnalyze</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">476</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                               <span class="identifier">weight</span> <span class="operator">=</span> <span class="identifier">finalWeights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">477</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">478</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"survreg"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">479</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">survreg</span><span class="paren">(</span><span class="identifier">msmFormula</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">480</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                 <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">toAnalyze</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">481</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                 <span class="identifier">weight</span> <span class="operator">=</span> <span class="identifier">finalWeights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">482</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">483</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">method</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">method</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"logistic"</span>, <span class="string">"probit"</span>, <span class="string">"loglog"</span>, <span class="string">"cloglog"</span>, <span class="string">"cauchit"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">484</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="identifier">MASS</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">polr</span><span class="paren">(</span><span class="identifier">msmFormula</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">toAnalyze</span>, <span class="identifier">weight</span> <span class="operator">=</span> <span class="identifier">finalWeights</span>, <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">method</span>, <span class="identifier">Hess</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">485</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">486</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">487</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">488</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glm</span><span class="paren">(</span><span class="identifier">msmFormula</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">489</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">family</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">490</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">toAnalyze</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">491</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">weight</span> <span class="operator">=</span> <span class="identifier">finalWeights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">492</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">493</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">494</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportTADAResult</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">msm</span> <span class="operator">=</span> <span class="identifier">model</span>, <span class="comment"># glm / survreg / coxph / </span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">495</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">propensityScoreModel</span> <span class="operator">=</span> <span class="identifier">propensityScoreModel</span>, <span class="comment"># glm / NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">496</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">497</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">propensityWeights</span> <span class="operator">=</span> <span class="identifier">propensityWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">498</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">participationWeights</span> <span class="operator">=</span> <span class="identifier">participationWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">499</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">500</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">participationWeightCalculation</span> <span class="operator">=</span> <span class="identifier">participationWeightCalculation</span>, <span class="comment"># list, for plot</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">501</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">participationWeightSummary</span> <span class="operator">=</span> <span class="identifier">participationWeightSummary</span>, <span class="comment"># list, for plot</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">502</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">503</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">finalWeights</span> <span class="operator">=</span> <span class="identifier">finalWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">504</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">505</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">customPropensity</span> <span class="operator">=</span> <span class="identifier">customPropensity</span>, <span class="comment"># T/F</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">506</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">customParticipation</span> <span class="operator">=</span> <span class="identifier">customParticipation</span>, <span class="comment">#T/F</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">507</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">508</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">treatment</span> <span class="operator">=</span> <span class="identifier">treatment</span>, <span class="comment"># chr</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">509</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">response</span> <span class="operator">=</span> <span class="identifier">response</span>, <span class="comment"># chr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">510</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">511</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">exOpt</span> <span class="operator">=</span> <span class="identifier">exOpt</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">512</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">513</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">studyData</span> <span class="operator">=</span> <span class="identifier">studyData</span>, <span class="comment"># data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">514</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">aggregateTargetData</span> <span class="operator">=</span> <span class="identifier">aggregateTargetData</span>, <span class="comment"># data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">515</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">processedIPD</span> <span class="operator">=</span> <span class="identifier">centeredIPD</span><span class="paren">[</span>,<span class="identifier">grep</span><span class="paren">(</span><span class="string">"_CENTERED$"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">centeredIPD</span><span class="paren">)</span>, <span class="identifier">invert</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">value</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">516</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">processedAgD</span> <span class="operator">=</span> <span class="identifier">processedAgD</span>, <span class="comment"># data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">517</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">518</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">matchingCovariates</span> <span class="operator">=</span> <span class="identifier">matchingCovariates</span>, <span class="comment"># chr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">519</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">520</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">centeredStudyData</span> <span class="operator">=</span> <span class="identifier">centeredIPD</span> <span class="comment"># data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">521</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">522</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">523</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">524</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"transportTADA"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">525</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">526</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">527</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">528</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">529</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># ------------- The End of the Function ------------- #</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">530</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">531</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">532</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># Helper function that extracts weights from models</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">533</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># *** In TADA ***: this function is only used for the propensity weights (inverse-prob for studyData)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">534</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">obtainPropensityWeights</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">model</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"probability"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">535</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">type</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">type</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"probability"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">536</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">537</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"probability"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">538</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">model</span><span class="operator">$</span><span class="identifier">y</span> <span class="operator">==</span> <span class="literal">T</span> <span class="operator">|</span> <span class="identifier">model</span><span class="operator">$</span><span class="identifier">y</span> <span class="operator">==</span> <span class="number">1</span>, <span class="comment"># here, model$y == 1 equals to A = 1</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">539</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="number">1</span> <span class="operator">/</span> <span class="identifier">model</span><span class="operator">$</span><span class="identifier">fitted.values</span>,<span class="comment"># 1 / Pr(A = 1 | L)^hat</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">540</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="number">1</span> <span class="operator">/</span> <span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="identifier">model</span><span class="operator">$</span><span class="identifier">fitted.values</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># 1 / Pr(A = 0 | L)^hat</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">541</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">542</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">543</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">544</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># Helper function that detects glms</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">545</td>
                    <td class="coverage">51719<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.glm</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">x</span>, <span class="string">"glm"</span><span class="paren">)</span><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">546</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">547</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># ----- Helper Functions for Participation Weights ----- #</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">548</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">549</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># User input AgD preprocessing</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">550</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">processedAgD</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">aggregateTargetData</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">551</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">552</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">rawAgD</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">aggregateTargetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">553</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">554</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># make all column names to be capital letters to avoid different style (Sex/sex to SEX)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">555</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">names</span><span class="paren">(</span><span class="identifier">rawAgD</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">toupper</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">rawAgD</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">556</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">557</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># must have info about total patients N</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">558</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="string">"N"</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">rawAgD</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">559</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Error: Column 'N' for total patient number is missing in the dataset."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">560</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">561</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">562</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># must be without NA</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">563</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">any</span><span class="paren">(</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">rawAgD</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">564</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Error: Ensure the input dataset has no NA before processing."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">565</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">566</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">567</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># define column name patterns[-]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">568</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">legalSuffix</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"MEAN"</span>, <span class="string">"MEDIAN"</span>, <span class="string">"SD"</span>, <span class="string">"COUNT"</span>, <span class="string">"PROP"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">569</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">570</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">candidateAgD</span> <span class="operator">&lt;-</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">rawAgD</span><span class="paren">)</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">571</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">572</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">selectCondition1</span> <span class="operator">&lt;-</span> <span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_"</span>, <span class="identifier">candidateAgD</span>, <span class="identifier">fixed</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="comment"># variables whose name with "_" would be labelled TRUE for selection</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">573</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">selectCondition2</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">candidateAgD</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">candidateAgD</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">574</td>
                    <td class="coverage">8899<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tmpName</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span><span class="paren">(</span><span class="identifier">strsplit</span><span class="paren">(</span><span class="identifier">candidateAgD</span>, <span class="identifier">split</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">575</td>
                    <td class="coverage">8899<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tmpName</span><span class="paren">[</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">tmpName</span><span class="paren">)</span><span class="paren">]</span> <span class="comment"># this deployment is robust to the cases that there are multiple _ in the column name</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">576</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">577</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">selectCondition2</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">selectCondition2</span> <span class="operator">%in%</span> <span class="identifier">legalSuffix</span><span class="paren">)</span> <span class="comment"># the last split section of variables in other_colnames by "_"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">578</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">selectedCandidates</span> <span class="operator">&lt;-</span> <span class="identifier">candidateAgD</span><span class="paren">[</span><span class="identifier">selectCondition1</span> <span class="operator">&amp;</span> <span class="identifier">selectCondition2</span><span class="paren">]</span> <span class="comment"># until this row: get all the column whose column names with "_" and legal suffix: c("MEAN", "MEDIAN", "SD", "COUNT", "PROP")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">579</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">580</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">useAgD</span> <span class="operator">&lt;-</span> <span class="identifier">rawAgD</span><span class="paren">[</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"N"</span>, <span class="identifier">selectedCandidates</span><span class="paren">)</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">]</span> <span class="comment"># selected AgD columns with suffix c("MEAN", "MEDIAN", "SD", "COUNT", "PROP")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">581</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">582</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># warning about ignored columns with illegal naming</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">583</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">candidateAgD</span> <span class="operator">%in%</span> <span class="identifier">selectedCandidates</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">584</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">585</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="string">"Following columns are ignored since it does not follow the naming conventions:"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">586</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">paste</span><span class="paren">(</span><span class="identifier">setdiff</span><span class="paren">(</span><span class="identifier">candidateAgD</span>, <span class="identifier">selectedCandidates</span><span class="paren">)</span>, <span class="identifier">collapse</span> <span class="operator">=</span> <span class="string">","</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">587</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">588</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">589</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">590</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># calculate percentage columns</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">591</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">countCondition</span> <span class="operator">&lt;-</span> <span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_COUNT$"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># columns in useAgD with names ending with "_COUNT"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">592</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">593</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">any</span><span class="paren">(</span><span class="identifier">countCondition</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">594</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">countCondition</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">595</td>
                    <td class="coverage">1618<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">tmpProp</span> <span class="operator">&lt;-</span> <span class="identifier">useAgD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">/</span> <span class="identifier">useAgD</span><span class="operator">$</span><span class="identifier">N</span> <span class="comment"># calculate the proportion with the count and N</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">596</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># in case some count are not specified, but proportion are specified, copy over those proportions</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">597</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># this also means, in case count is specified, proportion is ignored even it is specified</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">598</td>
                    <td class="coverage">1618<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">propName</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span><span class="paren">(</span><span class="string">"_COUNT$"</span>, <span class="string">"_PROP"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">599</td>
                    <td class="coverage">1618<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">propName</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">600</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">tmpProp</span><span class="paren">[</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">tmpProp</span><span class="paren">)</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">useAgD</span><span class="paren">[</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">tmpProp</span><span class="paren">)</span>, <span class="identifier">propName</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">601</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">propName</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">propName</span>, <span class="string">"_redundant"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">602</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">603</td>
                    <td class="coverage">1618<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">useAgD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">tmpProp</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">604</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">605</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span><span class="paren">(</span><span class="string">"_COUNT$"</span>, <span class="string">"_PROP"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">)</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">606</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">607</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">608</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">useAgD</span> <span class="operator">&lt;-</span> <span class="identifier">useAgD</span><span class="paren">[</span>, <span class="operator">!</span><span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_redundant$"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">)</span><span class="paren">]</span> <span class="comment"># until this row: always [replace] the proportion based on the new calculated value and remove the existed PROP data. The finalized AgD dataset just has proportion instead of count</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">609</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">610</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># output</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">611</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">processedAgD</span> <span class="operator">&lt;-</span> <span class="identifier">useAgD</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">612</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">613</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">614</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># User input IPD preprocessing</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">615</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># note: dummizeIPD only takes care of ordinal cases. For binary, users have to apply 0-1 label by themselves to avoid the discussion about reference level</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">616</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">dummizeIPD</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">rawIPD</span>, <span class="identifier">dummizeCols</span>, <span class="identifier">refLevel</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># refLevel: a vector of reference level of EACH ordinal variable in the same order of dummizeCols provided</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">617</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="identifier">seq_along</span><span class="paren">(</span><span class="identifier">dummizeCols</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">618</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">619</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># deal with the ordinal variables needed to be dummized one by one</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">620</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">rawCols</span> <span class="operator">&lt;-</span> <span class="identifier">rawIPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">dummizeCols</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">621</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">rawLevels</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">na.omit</span><span class="paren">(</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">rawCols</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">622</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">623</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># dummizeCols is a vector with reference levels in order </span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">624</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">refLevel</span><span class="paren">)</span> <span class="operator">||</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">refLevel</span><span class="paren">)</span> <span class="operator">&lt;</span> <span class="identifier">i</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># length(refLevel) &lt; i indicates that user doesn't provide the reference level of the i-th ordinal variables </span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">625</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rawCols</span> <span class="operator">&lt;-</span> <span class="identifier">factor</span><span class="paren">(</span><span class="identifier">rawCols</span><span class="paren">)</span> <span class="comment"># without provided reference level, factorize as default reference level</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">626</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">627</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rawCols</span> <span class="operator">&lt;-</span> <span class="identifier">factor</span><span class="paren">(</span><span class="identifier">as.character</span><span class="paren">(</span><span class="identifier">rawCols</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">628</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">levels</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">refLevel</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span>, <span class="identifier">setdiff</span><span class="paren">(</span><span class="identifier">rawLevels</span>, <span class="identifier">refLevel</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">629</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">630</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">631</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">newCols</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">levels</span><span class="paren">(</span><span class="identifier">rawCols</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">j</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">632</td>
                    <td class="coverage">1618<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">rawCols</span> <span class="operator">==</span> <span class="identifier">j</span><span class="paren">)</span> <span class="comment"># give 1 or 0 result based on T or F for each level</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">633</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">634</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">635</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">newCols</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">newCols</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">636</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">names</span><span class="paren">(</span><span class="identifier">newCols</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">toupper</span><span class="paren">(</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">dummizeCols</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span>, <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">rawCols</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># naming as VAR_LEVEL like "SEASON_SPRING" "SEASON_SUMMER"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">637</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">638</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">rawIPD</span> <span class="operator">&lt;-</span> <span class="identifier">cbind</span><span class="paren">(</span><span class="identifier">rawIPD</span>, <span class="identifier">newCols</span><span class="paren">)</span> <span class="comment"># combine the new data into the raw IPD data to keep raw data clean</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">639</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">640</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">rawIPD</span> <span class="operator">&lt;-</span> <span class="identifier">rawIPD</span><span class="paren">[</span>, <span class="operator">!</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">rawIPD</span><span class="paren">)</span> <span class="operator">%in%</span> <span class="identifier">dummizeCols</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">]</span> <span class="comment"># remove the original ordinal variable columns</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">641</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">642</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">643</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">644</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">rawIPD</span> <span class="comment"># note: the dummized outputs are like (0,1) (1,0) and (0,0)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">645</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">646</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">647</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># Centerize the IPD</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">648</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">centerIPD</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">IPD</span> <span class="operator">=</span> <span class="identifier">dummizeIPD</span>, <span class="identifier">AgD</span> <span class="operator">=</span> <span class="identifier">processedAgD</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">649</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">650</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># need to remove the original ordinal variable column(s) as converting all variables from factor to numeric</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">651</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">names</span><span class="paren">(</span><span class="identifier">IPD</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">toupper</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">IPD</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">652</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">centeredIPD</span> <span class="operator">&lt;-</span> <span class="identifier">IPD</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">653</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">654</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">legalSuffix</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"MEAN"</span>, <span class="string">"MEDIAN"</span>, <span class="string">"SD"</span>, <span class="string">"PROP"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">655</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">suffixPat</span> <span class="operator">&lt;-</span> <span class="identifier">paste</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"_"</span>, <span class="identifier">legalSuffix</span>, <span class="string">"$"</span><span class="paren">)</span>, <span class="identifier">collapse</span> <span class="operator">=</span> <span class="string">"|"</span><span class="paren">)</span> <span class="comment"># regex pattern: get the suffix out </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">656</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">657</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">useAgD</span> <span class="operator">&lt;-</span> <span class="identifier">AgD</span><span class="paren">[</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">AgD</span><span class="paren">)</span> <span class="operator">!=</span> <span class="string">"N"</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">]</span> <span class="comment"># no need the N anymore here</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">658</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">659</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># HERE FOR THE continuous variables with _mean and _sd will occur a multiplied results: PERCENTBODYFAT * 2</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">660</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">paramID</span> <span class="operator">&lt;-</span> <span class="identifier">gsub</span><span class="paren">(</span><span class="identifier">suffixPat</span>, <span class="string">""</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># a vector of variable names, select variables acccording to the regex pattern: SEX_MEAN to SEX</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">661</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># paramID &lt;- setdiff(paramID, "N") # here we need to skip "N" since it is not a variable to be discussed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">662</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">663</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">j</span> <span class="keyword">in</span> <span class="identifier">seq_len</span><span class="paren">(</span><span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span> </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">664</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">next</span> <span class="comment"># skip when NA</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">665</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">666</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># if the AgD of reference level is provided, due to the dummizing rule, skip this column for matching</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">667</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span> <span class="identifier">gsub</span><span class="paren">(</span><span class="identifier">suffixPat</span>, <span class="string">""</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">IPD</span><span class="paren">)</span> <span class="paren">)</span><span class="paren">)</span>  <span class="keyword">next</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">668</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">669</td>
                    <td class="coverage">6472<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ipdParam</span> <span class="operator">&lt;-</span> <span class="identifier">paramID</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span>  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">670</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">671</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># factor: as.numeric() 0 1 to 1 2? [first to char then to numeric]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">672</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">673</td>
                    <td class="coverage">6472<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_PROP$"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">674</td>
                    <td class="coverage">4045<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">centeredIPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">ipdParam</span>, <span class="string">"_"</span>, <span class="string">"CENTERED"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span> <span class="identifier">as.character</span><span class="paren">(</span><span class="identifier">IPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">ipdParam</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span> <span class="paren">)</span> <span class="operator">-</span> <span class="identifier">useAgD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">675</td>
                    <td class="coverage">2427<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_MEAN$"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">676</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">centeredIPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">ipdParam</span>, <span class="string">"_"</span>, <span class="string">"CENTERED"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.numeric</span><span class="paren">(</span> <span class="identifier">IPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">ipdParam</span><span class="paren">]</span><span class="paren">]</span> <span class="paren">)</span> <span class="operator">-</span> <span class="identifier">useAgD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">677</td>
                    <td class="coverage">1618<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_MEDIAN$"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">678</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">centeredIPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">ipdParam</span>, <span class="string">"_MEDIAN_"</span>, <span class="string">"CENTERED"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="paren">(</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">IPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">ipdParam</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="identifier">useAgD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">-</span> <span class="number">0.5</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">679</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">grepl</span><span class="paren">(</span><span class="string">"_SD$"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">680</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">centeredIPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">ipdParam</span>, <span class="string">"_SQUARED_"</span>, <span class="string">"CENTERED"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="paren">(</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">IPD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">ipdParam</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">^</span><span class="number">2</span><span class="paren">)</span> <span class="operator">-</span> <span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">^</span><span class="number">2</span> <span class="operator">+</span> <span class="paren">(</span><span class="identifier">useAgD</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">ipdParam</span>, <span class="string">"_MEAN"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">^</span><span class="number">2</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">681</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">682</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">683</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">684</td>
                    <td class="coverage">809<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">centeredIPD</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">685</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">686</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">687</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># achieve general weights estimation (applied in estimateWeights() )</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">688</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">optimiseWeights</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">matrix</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">689</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">par</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="number">0</span>, <span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">matrix</span><span class="paren">)</span><span class="paren">)</span>, <span class="comment"># initial parameters</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">690</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">method</span> <span class="operator">=</span> <span class="string">"BFGS"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">691</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">maxit</span> <span class="operator">=</span> <span class="number">300</span>, <span class="comment"># maximum iteration times</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">692</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">trace</span> <span class="operator">=</span> <span class="number">0</span>, <span class="comment"># trace info outputs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">693</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">694</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span> <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">par</span><span class="paren">)</span> <span class="operator">||</span> <span class="identifier">is.finite</span><span class="paren">(</span><span class="identifier">par</span><span class="paren">)</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">par</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">matrix</span><span class="paren">)</span> <span class="paren">)</span> <span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">695</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Error: par must be a numeric vector with finite values of length equal to the number of columns in 'matrix'."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">696</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">697</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">698</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">optResults</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">optim</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">699</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">par</span> <span class="operator">=</span> <span class="identifier">par</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">700</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fn</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">alpha</span>, <span class="identifier">X</span><span class="paren">)</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">exp</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">%*%</span> <span class="identifier">alpha</span><span class="paren">)</span><span class="paren">)</span>, <span class="comment"># function to be minimized</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">701</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">gr</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">alpha</span>, <span class="identifier">X</span><span class="paren">)</span> <span class="identifier">colSums</span><span class="paren">(</span><span class="identifier">sweep</span><span class="paren">(</span><span class="identifier">X</span>, <span class="number">1</span>, <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">X</span> <span class="operator">%*%</span> <span class="identifier">alpha</span><span class="paren">)</span>, <span class="string">"*"</span><span class="paren">)</span><span class="paren">)</span>, <span class="comment"># gradient</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">702</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">X</span> <span class="operator">=</span> <span class="identifier">matrix</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">703</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">method</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">704</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">control</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">maxit</span> <span class="operator">=</span> <span class="identifier">maxit</span>, <span class="comment"># maximum iteration times</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">705</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">trace</span> <span class="operator">=</span> <span class="identifier">trace</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="comment"># trace info outputs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">706</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">707</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">optResults</span><span class="operator">$</span><span class="identifier">convergence</span> <span class="operator">!=</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># convergence checking</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">708</td>
                    <td class="coverage">264<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"optim() did not converge. "</span>, <span class="identifier">optResults</span><span class="operator">$</span><span class="identifier">message</span>, <span class="string">"\nSee ?optim for more information on convergence code: "</span>, <span class="identifier">optResults</span><span class="operator">$</span><span class="identifier">convergence</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">709</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">710</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">711</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">list</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">712</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">opt</span> <span class="operator">=</span> <span class="identifier">optResults</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">713</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">alpha</span> <span class="operator">=</span> <span class="identifier">optResults</span><span class="operator">$</span><span class="identifier">par</span>, <span class="comment"># optimal parameters</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">714</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt</span> <span class="operator">=</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">matrix</span> <span class="operator">%*%</span> <span class="identifier">optResults</span><span class="operator">$</span><span class="identifier">par</span><span class="paren">)</span> <span class="comment"># weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">715</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">716</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">717</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">718</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># estimate matching weights for population matching</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">719</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">estimateWeights</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">data</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">720</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">centeredColnames</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">721</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">startValue</span> <span class="operator">=</span> <span class="number">0</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">722</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">method</span> <span class="operator">=</span> <span class="string">"BFGS"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">723</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">nBootIteration</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">724</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">setSeedBoot</span> <span class="operator">=</span> <span class="number">20240725</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">725</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">726</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># pre check</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">727</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">checkA</span> <span class="operator">&lt;-</span> <span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">728</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">checkA</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">729</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Error: please ensure the 'data' input is a data.frame during participation weights estimation. hint: estimateWeights()"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">730</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">731</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">732</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">checkB</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">centeredColnames</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">733</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">checkB</span> <span class="operator">&amp;&amp;</span> <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">centeredColnames</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># when user inputs are column index</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">734</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">735</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">checkB1</span> <span class="operator">&lt;-</span> <span class="identifier">any</span><span class="paren">(</span><span class="identifier">centeredColnames</span> <span class="operator">&lt;</span> <span class="number">1</span> <span class="operator">|</span> <span class="identifier">centeredColnames</span> <span class="operator">&gt;</span> <span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">736</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">checkB1</span><span class="paren">)</span> <span class="paren">{</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Error: specified `centeredColnames` are out of bound during participation weights estimation. hint: estimateWeights()"</span><span class="paren">)</span><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">737</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">738</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">739</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">checkB</span> <span class="operator">&amp;&amp;</span> <span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">centeredColnames</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># when user inputs are column names</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">740</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">741</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">checkB2</span> <span class="operator">&lt;-</span> <span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">centeredColnames</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">742</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">checkB2</span><span class="paren">)</span> <span class="paren">{</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Error: one or more specified `centeredColnames` are not found in 'data' input during participation weights estimation. hint: estimateWeights()"</span><span class="paren">)</span><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">743</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">744</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">745</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="paren">{</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Error: 'centeredColnames' should be either a numeric or character vector. during participation weights estimation. hint: estimateWeights()"</span><span class="paren">)</span><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">746</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">747</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># check the format of data itself. Needs to be all numeric for calculation</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">748</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">checkC</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">centeredColnames</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">ii</span><span class="paren">)</span> <span class="paren">{</span> <span class="operator">!</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">ii</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">749</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">any</span><span class="paren">(</span><span class="identifier">checkC</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">750</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">751</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="string">"Error: following columns of 'data' are not numeric for the participation weights calculation:"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">752</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">paste</span><span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">checkC</span><span class="paren">)</span>, <span class="identifier">collapse</span> <span class="operator">=</span> <span class="string">","</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">753</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">754</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">755</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">756</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">757</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># prepare data for optimization</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">758</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">centeredColnames</span><span class="paren">)</span><span class="paren">)</span> </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">759</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">centeredColnames</span> <span class="operator">&lt;-</span> <span class="identifier">seq_len</span><span class="paren">(</span><span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># an integer sequence with length of ncol(data)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">760</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">761</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">EM</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span>, <span class="identifier">centeredColnames</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">]</span> <span class="comment"># effect modifiers</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">762</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">naEM</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">EM</span>, <span class="number">1</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">EM</span><span class="paren">)</span> <span class="identifier">any</span><span class="paren">(</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">EM</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">763</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">nMissing</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">naEM</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">764</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">rowsWithMissing</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">naEM</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">765</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">EM</span> <span class="operator">&lt;-</span> <span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">EM</span><span class="paren">[</span><span class="operator">!</span><span class="identifier">naEM</span>, , <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">766</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">767</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">768</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># estimate weights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">769</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">opt1</span> <span class="operator">&lt;-</span> <span class="identifier">optimiseWeights</span><span class="paren">(</span><span class="identifier">matrix</span> <span class="operator">=</span> <span class="identifier">EM</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">770</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">par</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="identifier">startValue</span>, <span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">EM</span><span class="paren">)</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">771</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">method</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">772</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">773</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">alpha</span> <span class="operator">&lt;-</span> <span class="identifier">opt1</span><span class="operator">$</span><span class="identifier">alpha</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">774</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">wt</span> <span class="operator">&lt;-</span> <span class="identifier">opt1</span><span class="operator">$</span><span class="identifier">wt</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">775</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">wt_rs</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">wt</span> <span class="operator">/</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">*</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">EM</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">776</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">777</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">778</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># bootstrapping</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">779</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># outboot &lt;- if (is.null(nBootIteration)) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">780</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   bootSeed &lt;- NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">781</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   bootStrata &lt;- NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">782</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">783</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># } else {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">784</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Make sure to leave '.Random.seed' as-is on exit</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">785</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># oldSeed &lt;- globalenv()$.Random.seed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">786</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># on.exit(suspendInterrupts(set_random_seed(oldSeed)))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">787</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># set.seed(setSeedBoot)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">788</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">789</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># rowid_in_data &lt;- which(!ind)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">790</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># arms &lt;- factor(data$ARM[rowid_in_data])</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">791</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># boot_statistic &lt;- function(d, w) optimise_weights(d[w, ], </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">792</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#                                                   par = alpha, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">793</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#                                                   method = method, ...)$wt[, 1]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">794</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># boot_out &lt;- boot(EM,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">795</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#                  statistic = boot_statistic,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">796</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#                  R = nBootIteration,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">797</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#                  strata = arms)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">798</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">799</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># boot_array &lt;- array(dim = list(nrow(EM), 2, nBootIteration))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">800</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># dimnames(boot_array) &lt;- list(sampled_patient = NULL, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">801</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#                              c("rowid", "weight"), </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">802</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#                              bootstrap_iteration = NULL)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">803</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># boot_array[, 1, ] &lt;- t(boot.array(boot_out, TRUE))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">804</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># boot_array[, 2, ] &lt;- t(boot_out$t)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">805</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># bootSeed &lt;- boot_out$seed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">806</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># bootStrata &lt;- boot_out$strata</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">807</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># boot_array</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">808</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">809</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">810</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># append weights to data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">811</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">data</span><span class="operator">$</span><span class="identifier">weights</span> <span class="operator">&lt;-</span> <span class="literal">NA</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">812</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">data</span><span class="operator">$</span><span class="identifier">weights</span><span class="paren">[</span><span class="operator">!</span><span class="identifier">naEM</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">wt</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">813</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">814</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">data</span><span class="operator">$</span><span class="identifier">scaledWeights</span> <span class="operator">&lt;-</span> <span class="literal">NA</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">815</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">data</span><span class="operator">$</span><span class="identifier">scaledWeights</span><span class="paren">[</span><span class="operator">!</span><span class="identifier">naEM</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">wt_rs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">816</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">817</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">centeredColnames</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">centeredColnames</span> <span class="operator">&lt;-</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">centeredColnames</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">818</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">819</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Output</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">820</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">outputs</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">821</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">data</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">822</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">centeredColnames</span> <span class="operator">=</span> <span class="identifier">centeredColnames</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">823</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nMissing</span> <span class="operator">=</span> <span class="identifier">nMissing</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">824</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ESS</span> <span class="operator">=</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span><span class="operator">^</span><span class="number">2</span> <span class="operator">/</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">wt</span><span class="operator">^</span><span class="number">2</span><span class="paren">)</span>, <span class="comment"># effective sample size</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">825</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">opt</span> <span class="operator">=</span> <span class="identifier">opt1</span><span class="operator">$</span><span class="identifier">opt</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">826</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># boot = outboot,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">827</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># bootSeed = bootSeed,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">828</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># bootStrata = bootStrata,</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">829</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">rowsWithMissing</span> <span class="operator">=</span> <span class="identifier">rowsWithMissing</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">830</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">831</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">832</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">outputs</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"estimateWeights"</span>, <span class="string">"list"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">833</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">outputs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">834</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">835</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">836</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># legend for participation plot legend</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">837</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">calculateWeightsLegend</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">weightedData</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">838</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">839</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ESS</span> <span class="operator">&lt;-</span> <span class="identifier">weightedData</span><span class="operator">$</span><span class="identifier">ESS</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">840</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">wt</span> <span class="operator">&lt;-</span> <span class="identifier">weightedData</span><span class="operator">$</span><span class="identifier">data</span><span class="operator">$</span><span class="identifier">weights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">841</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">wt_scaled</span> <span class="operator">&lt;-</span> <span class="identifier">weightedData</span><span class="operator">$</span><span class="identifier">data</span><span class="operator">$</span><span class="identifier">scaledWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">842</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">843</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># calculate sample size and exclude NA from wt</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">844</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">nr_na</span> <span class="operator">&lt;-</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">845</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">n</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span> <span class="operator">-</span> <span class="identifier">nr_na</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">846</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">wt</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">na.omit</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">847</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">wt_scaled</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">na.omit</span><span class="paren">(</span><span class="identifier">wt_scaled</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">848</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">849</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># calculate ESS reduction and median weights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">850</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ESS_reduction</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="paren">(</span><span class="identifier">ESS</span> <span class="operator">/</span> <span class="identifier">n</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">*</span> <span class="number">100</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">851</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">wt_median</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">median</span><span class="paren">(</span><span class="identifier">wt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">852</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">wt_scaled_median</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">median</span><span class="paren">(</span><span class="identifier">wt_scaled</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">853</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">854</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">list</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">855</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ESS</span> <span class="operator">=</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">ESS</span>, <span class="number">2</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">856</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ESS_reduction</span> <span class="operator">=</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">ESS_reduction</span>, <span class="number">2</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">857</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt_median</span> <span class="operator">=</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">wt_median</span>, <span class="number">4</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">858</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt_scaled_median</span> <span class="operator">=</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">wt_scaled_median</span>, <span class="number">4</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">859</td>
                    <td class="coverage">808<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nr_na</span> <span class="operator">=</span> <span class="identifier">nr_na</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">860</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">861</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">862</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">863</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># function to calculate weighted SD based on weighted.mean() base function</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">864</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">weighted.sd</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">w</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">sum</span><span class="paren">(</span><span class="identifier">w</span> <span class="operator">*</span> <span class="paren">(</span><span class="identifier">x</span> <span class="operator">-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">weighted.mean</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">w</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">^</span><span class="number">2</span>, <span class="identifier">na.rm</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="operator">/</span> <span class="identifier">sum</span><span class="paren">(</span><span class="identifier">w</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">865</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">866</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Summarize results of a fitted MSM using the TADA approach</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">867</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">868</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">869</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Returns summary object which contains a summary of the fitted MSM, pre- and post-weighting standardized mean differences (SMDs) and pre-post matching table including aggregate level summary of effect modifiers of interest.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">870</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">871</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname summary.transportTADA</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">872</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">873</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param object Result from \code{transportTADA} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">874</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param covariates Vector of strings indicating names of covariates in propensity model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">875</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param effectModifiers Vector of strings indicating names of effect modifiers in participation model. When it is \code{NULL}, the \code{prePostTable} shows all the results</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">876</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">877</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">878</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">879</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The \code{summary.transportTADA} function returns a \code{summary.transportTADA} object containing the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">880</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{propensitySMD}: Table of unweighted and weighted SMDs of covariates between treatment groups. Only propensity weights are used.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">881</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{prePostTable}: Table of unweighted and weighted aggregate level summary as well as pre- and post- difference values of effect modifiers of interest between study data and target data.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">882</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{msmSummary}: Summary object of model object for MSM. The correct variance estimators are set here for \code{glm}, whereas they are set in \code{transportTADA} for \code{survreg} and \code{coxph}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">883</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">884</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">885</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summary.transportTADA</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">object</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">886</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="identifier">covariates</span> <span class="operator">=</span> <span class="literal">NULL</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">887</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="identifier">effectModifiers</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">888</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportTADAResult</span> <span class="operator">&lt;-</span> <span class="identifier">object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">889</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">890</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatment</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">891</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">matchingCovariates</span> <span class="operator">&lt;-</span> <span class="identifier">toupper</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">matchingCovariates</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">892</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">893</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">originalIPD</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">studyData</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">894</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">processedIPD</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">processedIPD</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">895</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">processedAgD</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">processedAgD</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">896</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">finalWeights</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">finalWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">897</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">898</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># customParticipation &lt;- transportTADAResult$customParticipation # custom participation weights indicator: T/F</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">899</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">900</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Calculate SMDs for covariates</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">901</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Extract study data and weights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">902</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">903</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">904</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityScoreModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">905</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityFormula</span> <span class="operator">&lt;-</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">formula</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">906</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">907</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">908</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">909</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">covariates</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">covariates</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">propensityFormula</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">910</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">911</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">912</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">913</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">914</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">studyData</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">915</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">aggregateTargetData</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">aggregateTargetData</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">916</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">917</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">918</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">propensityWeights</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">propensityWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">919</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">920</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatmentIndex</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">treatment</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">921</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">922</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Calculate SMDs for covariates (should optimize)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">923</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">covariates</span> <span class="operator">!=</span> <span class="number">0</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">924</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">prePropensitySMD</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">covariates</span>, <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">covariate</span><span class="paren">)</span> <span class="identifier">as.double</span><span class="paren">(</span><span class="identifier">smd</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">smd</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">covariate</span><span class="paren">)</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">925</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                                   <span class="identifier">g</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">treatmentIndex</span><span class="paren">]</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">estimate</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">926</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">927</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">prePropensityBalance</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">variable</span> <span class="operator">=</span> <span class="identifier">covariates</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">928</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">smd</span> <span class="operator">=</span> <span class="identifier">abs</span><span class="paren">(</span><span class="identifier">prePropensitySMD</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">929</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="string">"Observed"</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">covariates</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">930</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">931</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">postPropensitySMD</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">covariates</span>, <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">covariate</span><span class="paren">)</span> <span class="identifier">as.double</span><span class="paren">(</span><span class="identifier">smd</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">smd</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">covariate</span><span class="paren">)</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">932</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                                    <span class="identifier">g</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">treatmentIndex</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">933</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                                    <span class="identifier">w</span> <span class="operator">=</span> <span class="identifier">propensityWeights</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">estimate</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">934</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">935</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">postPropensityBalance</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">variable</span> <span class="operator">=</span> <span class="identifier">covariates</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">936</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                        <span class="identifier">smd</span> <span class="operator">=</span> <span class="identifier">abs</span><span class="paren">(</span><span class="identifier">postPropensitySMD</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">937</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                        <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="string">"Weighted"</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">covariates</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">938</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">939</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityBalance</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">prePropensityBalance</span>, <span class="identifier">postPropensityBalance</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">940</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="identifier">propensityBalance</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">941</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">942</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># -------- TADA: pre-post weighting result table ----------</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">943</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">944</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># effectModifiers -&gt; matchingCovariates</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">945</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># just use the effectModifiers to control to the certain rows which of user interests (shown as a subset)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">946</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># when effectModifiers is NULL, directly use matchingCovariates as all</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">947</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">948</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">effectModifiers</span> <span class="operator">&lt;-</span> <span class="identifier">matchingCovariates</span> <span class="comment"># all upper cases already</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">949</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">effectModifiers</span> <span class="operator">&lt;-</span> <span class="identifier">toupper</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span> <span class="comment"># all upper cases</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">950</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">951</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># get the prefixes in rownames of processedAgD and processedIPD to match the effect modifiers as user inputs</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">952</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">extractPrefix</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">name</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">strsplit</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"_"</span><span class="paren">)</span>, <span class="identifier">`[`</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">953</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">954</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">processedAgD</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">processedIPD</span><span class="paren">)</span><span class="paren">)</span><span class="paren">{</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">955</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">956</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">prefixesAgD</span> <span class="operator">&lt;-</span> <span class="identifier">extractPrefix</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">processedAgD</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">957</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">prefixesIPD</span> <span class="operator">&lt;-</span> <span class="identifier">extractPrefix</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">processedIPD</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">958</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">commonPrefixes</span> <span class="operator">&lt;-</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">prefixesAgD</span>, <span class="identifier">prefixesIPD</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">959</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">960</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">commonPrefixes</span> <span class="operator">&lt;-</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">commonPrefixes</span>, <span class="identifier">effectModifiers</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">961</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">962</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">prefixesPattern</span> <span class="operator">&lt;-</span> <span class="identifier">paste</span><span class="paren">(</span><span class="identifier">commonPrefixes</span>, <span class="identifier">collapse</span> <span class="operator">=</span> <span class="string">"|"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">963</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">964</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">NAgD</span> <span class="operator">&lt;-</span> <span class="identifier">processedAgD</span><span class="operator">$</span><span class="identifier">N</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">965</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">NIPD</span> <span class="operator">&lt;-</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">processedIPD</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">966</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">967</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">userAgD</span> <span class="operator">&lt;-</span> <span class="identifier">processedAgD</span><span class="paren">[</span>, <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">processedAgD</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">name</span><span class="paren">)</span> <span class="identifier">grepl</span><span class="paren">(</span><span class="identifier">prefixesPattern</span>, <span class="identifier">name</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">968</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">userIPD</span> <span class="operator">&lt;-</span> <span class="identifier">processedIPD</span><span class="paren">[</span>, <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">processedIPD</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">name</span><span class="paren">)</span> <span class="identifier">grepl</span><span class="paren">(</span><span class="identifier">prefixesPattern</span>, <span class="identifier">name</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">969</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">970</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">971</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">972</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">973</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">974</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># ---- pre weighting IPD summary</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">975</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">userIPDModified</span> <span class="operator">&lt;-</span> <span class="identifier">userIPD</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">976</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">userIPDModified</span><span class="paren">[</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">userIPD</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.factor</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">as.character</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">else</span> <span class="identifier">x</span><span class="paren">)</span> <span class="comment"># note: here the factors in userIPD could only be the binary or ordinal variables after dummized, thus are 0-1 scale</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">977</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">userIPDSummaryList</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">978</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">name</span> <span class="keyword">in</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">userIPDModified</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">979</td>
                    <td class="coverage">122<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">userIPDModified</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">name</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="number">0</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">980</td>
                    <td class="coverage">102<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">userIPDSummaryList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"PROP"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="identifier">userIPDModified</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">name</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">981</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">userIPDModified</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">name</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">982</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">userIPDSummaryList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"MEAN"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="identifier">userIPDModified</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">name</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">983</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">userIPDSummaryList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"SD"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">sd</span><span class="paren">(</span><span class="identifier">userIPDModified</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">name</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">984</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">userIPDSummaryList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"MEDIUM"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">median</span><span class="paren">(</span><span class="identifier">userIPDModified</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">name</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">985</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">986</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">987</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">988</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># formatting</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">989</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">userIPDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">userIPDSummaryList</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">990</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedUserIPDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">userIPDSummaryDataframe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">991</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedUserIPDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">transposedUserIPDSummaryDataframe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">992</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedUserIPDSummaryDataframe</span><span class="operator">$</span><span class="identifier">EMs</span> <span class="operator">&lt;-</span> <span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">transposedUserIPDSummaryDataframe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">993</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">transposedUserIPDSummaryDataframe</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">994</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedUserIPDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">transposedUserIPDSummaryDataframe</span><span class="paren">[</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"EMs"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">transposedUserIPDSummaryDataframe</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">transposedUserIPDSummaryDataframe</span><span class="paren">)</span><span class="operator">-</span><span class="number">1</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">995</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">transposedUserIPDSummaryDataframe</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"EMs"</span>, <span class="string">"Results"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">996</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">997</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryIPD</span> <span class="operator">&lt;-</span> <span class="identifier">transposedUserIPDSummaryDataframe</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">998</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">999</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># ---- AgD summary</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1000</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># formatting</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1001</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedUserAgDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">userAgD</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1002</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedUserAgDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">transposedUserAgDSummaryDataframe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1003</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedUserAgDSummaryDataframe</span><span class="operator">$</span><span class="identifier">EMs</span> <span class="operator">&lt;-</span> <span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">transposedUserAgDSummaryDataframe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1004</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">transposedUserAgDSummaryDataframe</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1005</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedUserAgDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">transposedUserAgDSummaryDataframe</span><span class="paren">[</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"EMs"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">transposedUserAgDSummaryDataframe</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">transposedUserAgDSummaryDataframe</span><span class="paren">)</span><span class="operator">-</span><span class="number">1</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1006</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">transposedUserAgDSummaryDataframe</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"EMs"</span>, <span class="string">"Results"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1007</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1008</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryAgD</span> <span class="operator">&lt;-</span> <span class="identifier">transposedUserAgDSummaryDataframe</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1009</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1010</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># ---- post weighting IPD summary</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1011</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">weights</span> <span class="operator">&lt;-</span> <span class="identifier">finalWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1012</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1013</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># calculate weighted median based on Hmisc package</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1014</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># library(Hmisc)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1015</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1016</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">postWeightingIPDSummaryList</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1017</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1018</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">name</span> <span class="keyword">in</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">userIPDModified</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1019</td>
                    <td class="coverage">122<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">originalEMs</span> <span class="operator">&lt;-</span> <span class="identifier">userIPDModified</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">name</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1020</td>
                    <td class="coverage">122<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">originalEMs</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="number">0</span>, <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1021</td>
                    <td class="coverage">102<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">postWeightingIPDSummaryList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"PROP"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">weighted.mean</span><span class="paren">(</span><span class="identifier">originalEMs</span>, <span class="identifier">weights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1022</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">originalEMs</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1023</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">postWeightingIPDSummaryList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"MEAN"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">weighted.mean</span><span class="paren">(</span><span class="identifier">originalEMs</span>, <span class="identifier">weights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1024</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">postWeightingIPDSummaryList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"SD"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">weighted.sd</span><span class="paren">(</span><span class="identifier">originalEMs</span>, <span class="identifier">weights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1025</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">postWeightingIPDSummaryList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">paste</span><span class="paren">(</span><span class="identifier">name</span>, <span class="string">"MEDIUM"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"_"</span><span class="paren">)</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">Hmisc</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">wtd.quantile</span><span class="paren">(</span><span class="identifier">originalEMs</span>, <span class="identifier">weights</span>, <span class="identifier">probs</span> <span class="operator">=</span> <span class="number">0.5</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1026</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1027</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1028</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1029</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># formatting</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1030</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">postWeightingIPDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">postWeightingIPDSummaryList</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1031</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedPostWeightingIPDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">postWeightingIPDSummaryDataframe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1032</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedPostWeightingIPDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">transposedPostWeightingIPDSummaryDataframe</span>, <span class="identifier">stringsAsFactors</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1033</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedPostWeightingIPDSummaryDataframe</span><span class="operator">$</span><span class="identifier">EMs</span> <span class="operator">&lt;-</span> <span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">transposedPostWeightingIPDSummaryDataframe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1034</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">transposedPostWeightingIPDSummaryDataframe</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1035</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">names</span><span class="paren">(</span><span class="identifier">transposedPostWeightingIPDSummaryDataframe</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="string">"Results"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1036</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transposedPostWeightingIPDSummaryDataframe</span> <span class="operator">&lt;-</span> <span class="identifier">transposedPostWeightingIPDSummaryDataframe</span><span class="paren">[</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"EMs"</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">transposedPostWeightingIPDSummaryDataframe</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">transposedPostWeightingIPDSummaryDataframe</span><span class="paren">)</span><span class="operator">-</span><span class="number">1</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1037</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">transposedPostWeightingIPDSummaryDataframe</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"EMs"</span>, <span class="string">"Results"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1038</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1039</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryIPDWeighted</span> <span class="operator">&lt;-</span> <span class="identifier">transposedPostWeightingIPDSummaryDataframe</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1040</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1041</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># merge tables together</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1042</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">merge</span> <span class="operator">&lt;-</span> <span class="identifier">merge</span><span class="paren">(</span><span class="identifier">summaryIPD</span>, <span class="identifier">summaryAgD</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="string">"EMs"</span>, <span class="identifier">all</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1043</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">finalMerge</span> <span class="operator">&lt;-</span> <span class="identifier">merge</span><span class="paren">(</span><span class="identifier">merge</span>, <span class="identifier">summaryIPDWeighted</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="string">"EMs"</span>, <span class="identifier">all</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1044</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">finalMerge</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"EMs"</span>, <span class="string">"IPD (pre-weighting)"</span>, <span class="string">"AgD"</span>, <span class="string">"IPD (post-weighting)"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1045</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1046</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">finalMerge</span><span class="paren">[</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">finalMerge</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">x</span>, <span class="number">3</span><span class="paren">)</span> <span class="keyword">else</span> <span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1047</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">prePostTable</span> <span class="operator">&lt;-</span> <span class="identifier">finalMerge</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1048</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1049</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1050</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">prePostTable</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"Effect Modifiers"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1051</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Study "</span>, <span class="string">"(N = "</span>, <span class="identifier">NIPD</span>, <span class="string">")"</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1052</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Target "</span>, <span class="string">"(N = "</span>, <span class="identifier">NAgD</span>, <span class="string">")"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1053</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="string">"Study (Post-Weighting)"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1054</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1055</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># SMD-like summary data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1056</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">prePostTable</span><span class="operator">$</span><span class="string">"Pre Weighting Difference"</span> <span class="operator">&lt;-</span> <span class="identifier">prePostTable</span><span class="paren">[</span>,<span class="number">3</span><span class="paren">]</span> <span class="operator">-</span> <span class="identifier">prePostTable</span><span class="paren">[</span>,<span class="number">2</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1057</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">prePostTable</span><span class="operator">$</span><span class="string">"Post Weighting Difference"</span> <span class="operator">&lt;-</span> <span class="identifier">prePostTable</span><span class="paren">[</span>,<span class="number">3</span><span class="paren">]</span> <span class="operator">-</span> <span class="identifier">prePostTable</span><span class="operator">$</span><span class="identifier">`Study (Post-Weighting)`</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1058</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1059</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Final Table</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1060</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">prePostTable</span> <span class="operator">&lt;-</span> <span class="identifier">prePostTable</span><span class="paren">[</span>,<span class="identifier">c</span><span class="paren">(</span><span class="string">"Effect Modifiers"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1061</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Study "</span>, <span class="string">"(N = "</span>, <span class="identifier">NIPD</span>, <span class="string">")"</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1062</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Target "</span>, <span class="string">"(N = "</span>, <span class="identifier">NAgD</span>, <span class="string">")"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1063</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="string">"Study (Post-Weighting)"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1064</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="string">"Pre Weighting Difference"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1065</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="string">"Post Weighting Difference"</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1066</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1067</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># --------------------------------------------------------- </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1068</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1069</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># If model is glm, calculate and replace correct SEs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1070</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1071</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">msm</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1072</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1073</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">msmSummary</span> <span class="operator">&lt;-</span> <span class="identifier">suppressWarnings</span><span class="paren">(</span><span class="identifier">summary</span><span class="paren">(</span><span class="identifier">msm</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1074</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1075</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">msmSummary</span>, <span class="string">"summary.glm"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1076</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">cov.scaled</span> <span class="operator">&lt;-</span> <span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1077</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">cov.unscaled</span> <span class="operator">&lt;-</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">cov.scaled</span> <span class="operator">/</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">dispersion</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1078</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">2</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">diag</span><span class="paren">(</span><span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">cov.scaled</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1079</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">3</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">1</span><span class="paren">]</span> <span class="operator">/</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">2</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1080</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">family</span><span class="operator">$</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"gaussian"</span><span class="paren">)</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">4</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">2</span> <span class="operator">*</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">pt</span><span class="paren">(</span><span class="identifier">abs</span><span class="paren">(</span><span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">3</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">df</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span>, <span class="identifier">lower.tail</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">1081</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">4</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">2</span> <span class="operator">*</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">pnorm</span><span class="paren">(</span><span class="identifier">abs</span><span class="paren">(</span><span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">3</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">lower.tail</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1082</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1083</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1084</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Same for polr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1085</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1086</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">msmSummary</span>, <span class="string">"summary.polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">1087</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">2</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">diag</span><span class="paren">(</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">1088</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">3</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">1</span><span class="paren">]</span> <span class="operator">/</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">2</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1089</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1090</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1091</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1092</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1093</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1094</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryTransportTADA</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">propensitySMD</span> <span class="operator">=</span> <span class="identifier">propensityBalance</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1095</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                               </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1096</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                               <span class="identifier">prePostTable</span> <span class="operator">=</span> <span class="identifier">prePostTable</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1097</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                               </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1098</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                               <span class="identifier">msmSummary</span> <span class="operator">=</span> <span class="identifier">msmSummary</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1099</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1100</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">summaryTransportTADA</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"summary.transportTADA"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1101</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1102</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">summaryTransportTADA</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1103</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1104</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1105</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1106</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname summary.transportTADA</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1107</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x \code{summary.transportTADA} object.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1109</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param out Output stream.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1110</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1111</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1112</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1113</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">print.summary.transportTADA</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">out</span> <span class="operator">=</span> <span class="identifier">stdout</span><span class="paren">(</span><span class="paren">)</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1115</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryTransportTADA</span> <span class="operator">&lt;-</span> <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1116</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1117</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"Absolute SMDs of covariates between treatments before and after weighting:"</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1118</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryTransportTADA</span><span class="operator">$</span><span class="identifier">propensitySMD</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1119</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1120</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"Aggregate level data summary of effect modifiers of interests before and after weighting:"</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1121</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryTransportTADA</span><span class="operator">$</span><span class="identifier">prePostTable</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1122</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1123</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"MSM results:"</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1124</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryTransportTADA</span><span class="operator">$</span><span class="identifier">msmSummary</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1125</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1126</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Plot graphs relevant to transportability analysis using TADA</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1128</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1129</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1130</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Plot graphs for assessment of covariate balance and results in a TADA analysis. This function currently supports mirrored histograms, SMD plots and model coefficient plots.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1131</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x Result from \code{transportTADA} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param type One of \code{"propensityHist", "propensitySMD", "participationHist", "msm"}. \code{Hist} produces mirrored histograms of estimated probability of treatment between treatment groups (for \code{propensity}), or of estimated participation weights between study and target data (for \code{participation}). \code{SMD} produces SMD plots of covariates between treatment groups (for \code{propensity}). \code{msm} produces plots showing confidence intervals for the model coefficients, which should have the correct standard errors.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1134</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param bins Number of bins for propensity score/participation weight histograms. This is only used for \code{Hist}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1135</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param maxWeight Maximum participation weight value, i.g., range, that user wants to show in the \code{participationHist}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1136</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param covariates Vector of strings indicating names of covariates in propensity model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1137</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param effectModifiers Vector of strings indicating names of effect modifiers in participation model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1138</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1139</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1140</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return A \code{ggplot} object which contains the desired plot.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1141</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1143</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1144</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom rlang .data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1145</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom stats density</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1146</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">plot.transportTADA</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"propensityHist"</span>, <span class="identifier">bins</span> <span class="operator">=</span> <span class="number">50</span>, <span class="identifier">maxWeight</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">covariates</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">effectModifiers</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1147</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportTADAResult</span> <span class="operator">&lt;-</span> <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1148</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryTransportTADA</span> <span class="operator">&lt;-</span> <span class="identifier">summary</span><span class="paren">(</span><span class="identifier">transportTADAResult</span>, <span class="identifier">covariates</span> <span class="operator">=</span> <span class="identifier">covariates</span>, <span class="identifier">effectModifiers</span> <span class="operator">=</span> <span class="identifier">effectModifiers</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1149</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1150</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1151</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Match argument</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1152</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">type</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">type</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"propensityHist"</span>, <span class="string">"propensitySMD"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1153</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="string">"participationHist"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1154</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="string">"msm"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1155</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1156</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"propensityHist"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1157</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Mirrored histogram of propensity scores</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1158</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">customPropensity</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1159</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">propensityModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1160</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">propensityModel</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1161</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyData</span><span class="operator">$</span><span class="identifier">propensityScore</span> <span class="operator">&lt;-</span> <span class="identifier">propensityModel</span><span class="operator">$</span><span class="identifier">fitted.values</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1162</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentVar</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1163</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentGroups</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">factor</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatmentVar</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1164</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentGroupIdx</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1165</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">treatmentGroups</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1166</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">treatmentGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatmentVar</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="identifier">treatmentGroups</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1167</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1168</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ggplot</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span>, <span class="identifier">mapping</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">.data</span><span class="operator">$</span><span class="identifier">propensityScore</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1169</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">halfmoon</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_mirror_histogram</span><span class="paren">(</span><span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">group</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">treatmentVar</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">treatmentVar</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">bins</span> <span class="operator">=</span> <span class="identifier">bins</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1170</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">stat_density</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span><span class="identifier">treatmentGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span>,<span class="paren">]</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">propensityScore</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="operator">-</span><span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">after_stat</span><span class="paren">(</span><span class="identifier">density</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">alpha</span> <span class="operator">=</span> <span class="number">0</span><span class="paren">)</span> <span class="operator">+</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1171</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">stat_density</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span><span class="identifier">treatmentGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>,<span class="paren">]</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">propensityScore</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">after_stat</span><span class="paren">(</span><span class="identifier">density</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">alpha</span> <span class="operator">=</span> <span class="number">0</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1172</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ylab</span><span class="paren">(</span><span class="string">"Count"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1173</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1174</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1175</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">{</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Custom propensity weights were used. Please plot your previously estimated propensity scores using the halfmoon package, if desired."</span><span class="paren">)</span><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1176</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1177</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1178</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"propensitySMD"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># SMD plot of covariates</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1180</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensitySMD</span> <span class="operator">&lt;-</span> <span class="identifier">summaryTransportTADA</span><span class="operator">$</span><span class="identifier">propensitySMD</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">1181</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensitySMD</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"No covariates to plot, please provide some."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1182</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ggplot</span><span class="paren">(</span><span class="identifier">propensitySMD</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">variable</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">smd</span>, <span class="identifier">group</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">method</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">method</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1183</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_line</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1184</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_point</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1185</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_hline</span><span class="paren">(</span><span class="identifier">yintercept</span> <span class="operator">=</span> <span class="number">0.1</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1186</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">coord_flip</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1187</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">theme_bw</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1188</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">theme</span><span class="paren">(</span><span class="identifier">legend.key</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">element_blank</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1189</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1190</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1191</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"participationHist"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1192</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1193</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">weightedData</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">participationWeightCalculation</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1194</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">weightsStat</span> <span class="operator">&lt;-</span> <span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">participationWeightSummary</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1195</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1196</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">main_title</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"Participation Weights"</span>, <span class="string">"Scaled Participation Weights"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1197</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">bin_col</span> <span class="operator">&lt;-</span> <span class="string">"#2FB9AB"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1198</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">vline_col</span> <span class="operator">&lt;-</span> <span class="string">"red"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1199</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">bins</span> <span class="operator">&lt;-</span> <span class="identifier">bins</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1200</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1201</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt_data0</span> <span class="operator">&lt;-</span> <span class="identifier">weightedData</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"weights"</span>, <span class="string">"scaledWeights"</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1202</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">wt_data0</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">main_title</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1203</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt_data</span> <span class="operator">&lt;-</span> <span class="identifier">utils</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">stack</span><span class="paren">(</span><span class="identifier">wt_data0</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1204</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">wt_data</span><span class="operator">$</span><span class="identifier">median</span> <span class="operator">&lt;-</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">wt_data</span><span class="operator">$</span><span class="identifier">ind</span> <span class="operator">==</span> <span class="identifier">main_title</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1205</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">weightsStat</span><span class="operator">$</span><span class="identifier">wt_median</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1206</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">weightsStat</span><span class="operator">$</span><span class="identifier">wt_scaled_median</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1207</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1208</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1209</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Legend Data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1210</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lab</span> <span class="operator">&lt;-</span> <span class="identifier">with</span><span class="paren">(</span><span class="identifier">weightsStat</span>, <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1211</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">lab</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Median = "</span>, <span class="identifier">wt_median</span><span class="paren">)</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Median = "</span>, <span class="identifier">wt_scaled_median</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1212</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">lab</span> <span class="operator">&lt;-</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">lab</span>, <span class="string">"\nESS = "</span>, <span class="identifier">ESS</span>, <span class="string">"\nReduction% = "</span>, <span class="identifier">ESS_reduction</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">1213</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">nr_na</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="identifier">lab</span> <span class="operator">&lt;-</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">lab</span>, <span class="string">"\n#Missing Weights = "</span>, <span class="identifier">nr_na</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1214</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">lab</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1215</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1216</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">legend_data</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">ind</span> <span class="operator">=</span> <span class="identifier">main_title</span>, <span class="identifier">lab</span> <span class="operator">=</span> <span class="identifier">lab</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1217</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1218</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ggplot</span><span class="paren">(</span><span class="identifier">wt_data</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1219</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_histogram</span><span class="paren">(</span><span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="string">"values"</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">bins</span> <span class="operator">=</span> <span class="identifier">bins</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="identifier">bin_col</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="identifier">bin_col</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1220</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_vline</span><span class="paren">(</span><span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">xintercept</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="string">"median"</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1221</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">color</span> <span class="operator">=</span> <span class="identifier">vline_col</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1222</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">linetype</span> <span class="operator">=</span> <span class="string">"dashed"</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1223</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">theme_bw</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1224</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">facet_wrap</span><span class="paren">(</span><span class="operator">~</span><span class="identifier">ind</span>, <span class="identifier">ncol</span> <span class="operator">=</span> <span class="number">1</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1225</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_text</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">legend_data</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1226</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">label</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="string">"lab"</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">x</span> <span class="operator">=</span> <span class="literal">Inf</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="literal">Inf</span>, <span class="identifier">hjust</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">vjust</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">size</span> <span class="operator">=</span> <span class="number">3</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1227</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">theme</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1228</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">axis.title</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">element_text</span><span class="paren">(</span><span class="identifier">size</span> <span class="operator">=</span> <span class="number">12</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1229</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">axis.text</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">element_text</span><span class="paren">(</span><span class="identifier">size</span> <span class="operator">=</span> <span class="number">12</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1230</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ylab</span><span class="paren">(</span><span class="string">"Frequency"</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1231</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">xlab</span><span class="paren">(</span><span class="string">"Weight"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1232</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1233</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">maxWeight</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span><span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">resultPlot</span> <span class="operator">+</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">xlim</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="number">0</span>, <span class="identifier">maxWeight</span><span class="paren">)</span><span class="paren">)</span><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1234</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1235</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1236</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"msm"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1237</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Coefficient plots</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1238</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">modelsummary</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">modelplot</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1239</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                          <span class="identifier">vcov</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1240</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                          <span class="identifier">coef_omit</span> <span class="operator">=</span> <span class="string">"(Intercept)"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1241</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1242</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1243</td>
                    <td class="coverage">11<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">resultPlot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1244</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1245</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1246</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1247</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1248</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Check validity of TADA result object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1249</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1250</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1251</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A simple helper function that validates whether the components of the given \code{transportTADA} object are of the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1252</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1253</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param transportTADAResult Result object from \code{transportTADA} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1254</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1255</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return A boolean indicating whether all components of \code{transportTADA} object have the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1256</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1257</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1258</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1259</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.transportTADA</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1260</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span>, <span class="string">"glm"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span>, <span class="string">"coxph"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span>, <span class="string">"survreg"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">msm</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1261</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1262</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span>, <span class="string">"glm"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1263</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1264</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">propensityWeights</span>, <span class="string">"numeric"</span><span class="paren">)</span> <span class="operator">&amp;</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1265</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">participationWeights</span>, <span class="string">"numeric"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1266</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1267</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">participationWeightSummary</span>, <span class="string">"list"</span><span class="paren">)</span>  <span class="operator">&amp;</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1268</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">participationWeightCalculation</span>, <span class="string">"list"</span><span class="paren">)</span>  <span class="operator">&amp;</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1269</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1270</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">finalWeights</span>, <span class="string">"numeric"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1271</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1272</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">customPropensity</span>, <span class="string">"logical"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1273</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">customParticipation</span>, <span class="string">"logical"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1274</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1275</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">treatment</span>, <span class="string">"character"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">treatment</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1276</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">response</span>, <span class="string">"character"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">response</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1277</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1278</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">studyData</span>, <span class="string">"data.frame"</span><span class="paren">)</span>  <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1279</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">aggregateTargetData</span>, <span class="string">"data.frame"</span><span class="paren">)</span>  <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1280</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">processedIPD</span>, <span class="string">"data.frame"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">processedIPD</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1281</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">processedAgD</span>, <span class="string">"data.frame"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">processedAgD</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1282</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1283</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">matchingCovariates</span>, <span class="string">"character"</span><span class="paren">)</span>  <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1284</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1285</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">centeredStudyData</span>, <span class="string">"data.frame"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportTADAResult</span><span class="operator">$</span><span class="identifier">centeredStudyData</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1286</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">1287</td>
                    <td class="coverage">9<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">         <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportTADAResult</span>, <span class="string">"transportTADA"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">1288</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/transportIP.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Transportability analysis using IOPW</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Estimates the coefficients of a marginal structural model (MSM) using IP weighting in a generalizability or transportability analysis. In particular, the estimators should be unbiased for the coefficients in the superpopulation or the target population, respectively. Currently, this function only supports the case when there are exactly two treatment levels.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param msmFormula A formula for the MSM to be fitted, which usually includes the outcome, the treatment and any effect modifiers.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param propensityScoreModel Either a formula or a \code{glm} object representing the model for treatment assignment given covariates.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param participationModel Either a formula or a \code{glm} object representing the model for study participation given effect modifiers. If a formula and the "data" argument is a list, then add participation as the left-hand side of the formula.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param propensityWeights Vector of custom weights balancing covariates between treatments. Providing them will override the formula or model provided by \code{propensityScoreModel}. This vector should have as any entries as the sample size of the study data.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param participationWeights Vector of custom weights balancing effect modifiers between study and target populations. Providing them will override the formula or model provided by \code{participationModel}. This vector should have as any entries as the sample size of the study data.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param treatment String indicating name of treatment variable. If \code{NULL}, it will be auto-detected from \code{propensityScoreModel} if provided; otherwise it will remain \code{NULL}. Note that when using custom weights, \code{treatment} should be provided so that \code{summary.transportIP} and \code{plot.transportIP} works.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param participation String indicating name of participation variable. If \code{NULL}, it will be auto-detected from \code{participationModel} if provided; otherwise it will remain \code{NULL}. Note that when using custom weights, \code{participation} should be provided so that \code{summary.transportIP} and \code{plot.transportIP} works.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param response String indicating name of response variable. If \code{NULL}, it will be auto-detected form \code{msmFormula}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param family Either a \code{family} function as used for \code{glm}, or one of \code{c("polr", "coxph", "survreg")}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param method Link function used for \code{polr}, one of \code{c("logistic", "probit", "loglog", "cloglog", "cauchit")}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param exOpt A list with components \code{propensity}, \code{participation} and \code{final}. Each component specifies whether weights should be trimmed or truncated. Use the functions \code{trim} and \code{trunc} to specify trimming/truncation. Note that only truncation is supported for final weights.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param data Either a single data frame containing merged study and target datasets, or a list containing the study dataset and the target dataset. Note that if participationModel is a glm object, the datasets would have been merged, so provide the merged dataset containing response, treatment, covariates controlled for in the original study, study participation and effect modifiers if this is the case. Make sure to code treatment and participation as 0-1 or TRUE-FALSE, with 1 and TRUE representing treatment group and study data, respectively.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param transport A boolean indicating whether a generalizability analysis (false) or a transportability analysis (true) is done.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param bootstrapNum Number of bootstrap datasets to simulate to obtain robust variance estimate.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @details</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The function fits models of treatment assignment and study participation in order to calculate the weights used to fit the MSM. For each of these models, if a formula is provided, logistic regression is used by default. If a \code{glm} object is provided, the function extracts the necessary weights from the object. The function does not support other weighting methods, so if they are required, provide custom weights.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The MSM-fitting functions do not provide correct standard errors as-is. Bootstrap is used to calculate robust bootstrap variance estimators of the parameter estimators. The function replaces the variance component in \code{summary.glm}, \code{coxph} and \code{survreg} with the robust variance estimators directly. This does not seem to behave well with \code{predict.glm} yet, but prediction is not of primary interest in a generalizability or transportability analysis.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{transportIP} object containing the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{msm}: Raw model fit object for MSM of class \code{glm}, \code{survreg} and \code{coxph}, with the correct variance estimators appropriately replaced. If of class \code{glm}, it will have an extra \code{var} component containing the correct variance estimates.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{propensityScoreModel}: Model of treatment assignment, \code{NULL} if not provided and custom propensity weights are used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{participationModel}: Model of study participation, \code{NULL} if not provided and custom propensity weights are used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{propensityWeights}: Propensity weights used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{participationWeights}: Participation weights used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{finalWeights}: Weights used to fit MSM</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{customPropensity}: Boolean indicating whether custom propensity weights are used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{customParticipation}: Boolean indicating whether custom participation weights are used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{treatment}: String indicating variable name of treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{participation}: String indicating variable name of participation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{response}: String indicating variable name of response</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{data}: Data provided in \code{data} argument. Either a list containing study data and target data or a data frame containing both.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{exOpt}: Provided \code{exOpt} argument.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @md</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transportIP</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">msmFormula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">propensityScoreModel</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">participationModel</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">propensityWeights</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">participationWeights</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">treatment</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">participation</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">response</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">gaussian</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"logistic"</span>, <span class="string">"probit"</span>, <span class="string">"loglog"</span>, <span class="string">"cloglog"</span>, <span class="string">"cauchit"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">exOpt</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">propensity</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">participation</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">final</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">data</span>, <span class="identifier">transport</span> <span class="operator">=</span> <span class="literal">T</span>, <span class="identifier">bootstrapNum</span> <span class="operator">=</span> <span class="number">500</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">60</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportIPResult</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPFit</span><span class="paren">(</span><span class="identifier">msmFormula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">propensityScoreModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">62</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">participationModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">63</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">propensityWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">64</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">participationWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">65</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">66</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">participation</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">67</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">response</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">68</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">family</span>, <span class="identifier">method</span>, <span class="identifier">exOpt</span> <span class="operator">=</span> <span class="identifier">exOpt</span>, <span class="identifier">data</span>, <span class="identifier">transport</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Correct variance estimates by performing bootstrap, resampling study and target data separately</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">72</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">customPropensity</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">customParticipation</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Extract treatment study data, control study data and target data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">74</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityScoreModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">75</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">76</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trim</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">propensity</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span><span class="paren">[</span>,<span class="operator">-</span><span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">77</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">treatmentLevels</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">as.factor</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">78</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">treatmentGroupData</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">79</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">80</td>
                    <td class="coverage">50<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentGroupData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span><span class="paren">[</span><span class="identifier">as.character</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">level</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">82</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nLevels</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">treatmentGroupData</span>, <span class="identifier">nrow</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">83</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">names</span><span class="paren">(</span><span class="identifier">nLevels</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">84</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">85</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">86</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">0</span> <span class="operator">|</span> <span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">F</span>, , <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">87</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trim</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span><span class="paren">[</span>,<span class="operator">-</span><span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">88</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">response</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">targetData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">89</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nTarget</span> <span class="operator">&lt;-</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">90</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">91</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">bootstrapEstimates</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">sapply</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">bootstrapNum</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">93</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">treatmentGroupBoot</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">94</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">95</td>
                    <td class="coverage">25000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="identifier">nSample</span> <span class="operator">&lt;-</span> <span class="identifier">nLevels</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">96</td>
                    <td class="coverage">25000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentGroupData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">sample.int</span><span class="paren">(</span><span class="identifier">nSample</span>, <span class="identifier">replace</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">98</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">99</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">exists</span><span class="paren">(</span><span class="string">"studyBoot"</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">studyBoot</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">100</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="keyword">else</span> <span class="identifier">studyBoot</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">studyBoot</span>, <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">101</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">102</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">103</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">targetBoot</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span><span class="paren">[</span><span class="identifier">sample.int</span><span class="paren">(</span><span class="identifier">n</span> <span class="operator">=</span> <span class="identifier">nTarget</span>, <span class="identifier">replace</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">104</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">105</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">studyBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">106</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">targetBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">107</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">108</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">extraVar</span> <span class="keyword">in</span> <span class="identifier">union</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyBoot</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">targetBoot</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">109</td>
                    <td class="coverage">81500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span><span class="identifier">extraVar</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">targetBoot</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">targetBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">extraVar</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="literal">NA</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">110</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span><span class="identifier">extraVar</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyBoot</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">studyBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">extraVar</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="literal">NA</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">111</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">112</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">113</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">allBoot</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">studyBoot</span>, <span class="identifier">targetBoot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">115</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">propensityScoreBoot</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">update</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">116</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                            <span class="identifier">formula</span>. <span class="operator">=</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">formula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">117</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                            <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyBoot</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">118</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                            <span class="identifier">weights</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">119</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">120</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">participationBoot</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">update</span><span class="paren">(</span><span class="identifier">participationModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">121</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                          <span class="identifier">formula</span>. <span class="operator">=</span> <span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">formula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">122</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                          <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">allBoot</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">123</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                          <span class="identifier">weights</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">124</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">125</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">resultBoot</span> <span class="operator">&lt;-</span> <span class="identifier">suppressWarnings</span><span class="paren">(</span><span class="identifier">transportIPFit</span><span class="paren">(</span><span class="identifier">msmFormula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">126</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                        <span class="identifier">propensityScoreBoot</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">127</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                        <span class="identifier">participationBoot</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">128</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                        <span class="identifier">propensityWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">129</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                        <span class="identifier">participationWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">130</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                        <span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">131</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                        <span class="identifier">participation</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">132</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                        <span class="identifier">response</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">133</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                        <span class="identifier">family</span>, <span class="identifier">method</span>, <span class="identifier">exOpt</span> <span class="operator">=</span> <span class="identifier">exOpt</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">studyBoot</span>, <span class="identifier">targetBoot</span><span class="paren">)</span>, <span class="identifier">transport</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">134</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">135</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">136</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="comment"># Add on intercept estimates from polr case. This is okay because concatenating with a NULL does nothing</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">137</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="keyword">return</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="identifier">resultBoot</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">coefficients</span>, <span class="identifier">resultBoot</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">zeta</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">138</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="paren">}</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">139</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">140</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">bootstrapEstimates</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="identifier">bootstrapEstimates</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">bootstrapEstimates</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">141</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Still okay outside of polr cases because concatenating with a NULL does nothing.</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">143</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">varMatrix</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">var</span><span class="paren">(</span><span class="identifier">bootstrapEstimates</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">144</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">varMatrix</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">varMatrix</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">rownames</span><span class="paren">(</span><span class="identifier">varMatrix</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">zeta</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">145</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">bootstrapEstimates</span> <span class="operator">&lt;-</span> <span class="identifier">bootstrapEstimates</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">146</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span> <span class="operator">&lt;-</span> <span class="identifier">varMatrix</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">147</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">148</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Custom weights are being used. Variance estimates may be biased."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">149</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">150</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">151</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">bootstrapNum</span> <span class="operator">=</span> <span class="identifier">bootstrapNum</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">152</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">153</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">154</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">155</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">156</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">157</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transportIPFit</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">msmFormula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">158</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">propensityScoreModel</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">159</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">participationModel</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">160</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">propensityWeights</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">161</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">participationWeights</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">162</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">treatment</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">163</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">participation</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">164</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">response</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">165</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">gaussian</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">166</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"logistic"</span>, <span class="string">"probit"</span>, <span class="string">"loglog"</span>, <span class="string">"cloglog"</span>, <span class="string">"cauchit"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">167</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">exOpt</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">propensity</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">168</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">participation</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">169</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">final</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">170</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">data</span>, <span class="identifier">transport</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">171</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">172</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Auto-detect response, treatment and participation if provided</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">173</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">response</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">response</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">msmFormula</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">174</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">175</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">treatment</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">176</td>
                    <td class="coverage">12502<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.glm</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">treatment</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">formula</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">177</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="identifier">treatment</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">178</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">180</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participation</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">181</td>
                    <td class="coverage">12501<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.glm</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">formula</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">182</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">183</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">184</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">185</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Extract study and target data if provided separately using the fact that only study data would have responses</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">186</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">187</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">188</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatmentIndex</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">189</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">participationIndex</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">190</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">191</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">192</td>
                    <td class="coverage">12524<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">response</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">193</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">194</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">195</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">196</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">197</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">198</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">199</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">200</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">201</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Merge data here</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">202</td>
                    <td class="coverage">12500<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">participationModel</span>, <span class="string">"glm"</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">effectModifiers</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">formula</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">203</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="identifier">effectModifiers</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">204</td>
                    <td class="coverage">12524<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span> <span class="operator">!=</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">205</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">studyParticipationData</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">effectModifiers</span>, <span class="string">"participation"</span><span class="paren">)</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">206</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetParticipationData</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span><span class="paren">[</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">effectModifiers</span>, <span class="string">"participation"</span><span class="paren">)</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">207</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span><span class="identifier">participation</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyParticipationData</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">208</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyParticipationData</span><span class="operator">$</span><span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">209</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="string">"participation"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">210</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">211</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span><span class="identifier">participation</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">targetParticipationData</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">212</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">targetParticipationData</span><span class="operator">$</span><span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">213</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="string">"participation"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">214</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">215</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">allData</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">studyParticipationData</span>, <span class="identifier">targetParticipationData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">216</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationIndex</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">allData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">participation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">217</td>
                    <td class="coverage">12523<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">allData</span><span class="operator">$</span><span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="identifier">as.factor</span><span class="paren">(</span><span class="identifier">allData</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">218</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">219</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">220</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">treatment</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">treatmentIndex</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">treatment</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">221</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participation</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">participationIndex</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">participation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">222</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">223</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Extract it regardless for better behavior</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">224</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="identifier">data</span><span class="paren">[</span>,<span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span> <span class="identifier">data</span><span class="paren">[</span>,<span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span>,<span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">225</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="identifier">data</span><span class="paren">[</span>,<span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">0</span> <span class="operator">|</span> <span class="identifier">data</span><span class="paren">[</span>,<span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">F</span>,<span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">226</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">allData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">227</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">228</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">229</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">230</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># If formula is provided for treatment and participation models, fit models ourselves</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">231</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="string">"formula"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">232</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Fit model ourselves then reassign it to propensityScoreModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">233</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityScoreModel</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glm</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span>, <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">binomial</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">234</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">235</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">236</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">participationModel</span>, <span class="string">"formula"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">237</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Fit model ourselves then reassign it to participationModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">238</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationModel</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glm</span><span class="paren">(</span><span class="identifier">participationModel</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">allData</span>, <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">binomial</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">239</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">240</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">241</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># If not using custom weights, both propensity and participation models need to be ready at this point</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">242</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">is.glm</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span>, <span class="identifier">is.glm</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">243</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">244</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Track custom weights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">245</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">246</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">customPropensity</span> <span class="operator">&lt;-</span> <span class="literal">F</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">247</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">248</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Custom propensity weights are being used. Please ensure that these weights are meaningful."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">249</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">customPropensity</span> <span class="operator">&lt;-</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">250</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">251</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">252</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">customParticipation</span> <span class="operator">&lt;-</span> <span class="literal">F</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">253</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationWeights</span><span class="paren">)</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">254</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Custom participation weights are being used. Please ensure that these weights are meaningful."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">255</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">customParticipation</span> <span class="operator">&lt;-</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">256</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">257</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">258</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Both propensity model and custom weights are provided, using custom weights."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">259</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">260</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Both participation model and custom weights are provided, using custom weights."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">261</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">262</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Calculate actual weights to be used; first two exOpt arguments are addressed here</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">263</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">264</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensityWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">265</td>
                    <td class="coverage">12525<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityWeights</span> <span class="operator">&lt;-</span> <span class="identifier">obtainWeights</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"probability"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">266</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">267</td>
                    <td class="coverage">12525<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">propensity</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">268</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">propensityOpt</span> <span class="operator">&lt;-</span> <span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">propensity</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">269</td>
                    <td class="coverage">4008<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trunc</span><span class="paren">(</span><span class="identifier">propensityOpt</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">propensityWeights</span> <span class="operator">&lt;-</span> <span class="identifier">truncWeights</span><span class="paren">(</span><span class="identifier">propensityWeights</span>, <span class="identifier">propensityOpt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">270</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trim</span><span class="paren">(</span><span class="identifier">propensityOpt</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">271</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">retainedObsIndPropensity</span> <span class="operator">&lt;-</span> <span class="identifier">trimInd</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="identifier">propensityOpt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">272</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">propensityScoreModel</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">update</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">273</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">formula</span>. <span class="operator">=</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">formula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">274</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">cbind</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">data</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">275</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                    <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">retainedObsIndPropensity</span> <span class="operator">=</span> <span class="identifier">retainedObsIndPropensity</span><span class="paren">)</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">276</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                       <span class="identifier">weights</span> <span class="operator">=</span> <span class="identifier">retainedObsIndPropensity</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">277</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">propensityWeights</span> <span class="operator">&lt;-</span> <span class="identifier">obtainWeights</span><span class="paren">(</span><span class="identifier">propensityScoreModel</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"probability"</span><span class="paren">)</span> <span class="operator">*</span> <span class="identifier">retainedObsIndPropensity</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">278</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">279</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">280</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">281</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">282</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationWeights</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">283</td>
                    <td class="coverage">12525<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">obtainWeights</span><span class="paren">(</span><span class="identifier">participationModel</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">transport</span>, <span class="string">"odds"</span>, <span class="string">"probability"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">284</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Makeshift solution to account for generalizability analysis</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">285</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">286</td>
                    <td class="coverage">12525<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">transport</span> <span class="operator">&amp;</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">participationWeights</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">propensityWeights</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">287</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">participationWeights</span><span class="paren">[</span><span class="identifier">allData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">288</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                     <span class="identifier">allData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">289</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">290</td>
                    <td class="coverage">12525<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">291</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participationOpt</span> <span class="operator">&lt;-</span> <span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">participation</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">292</td>
                    <td class="coverage">4008<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trunc</span><span class="paren">(</span><span class="identifier">participationOpt</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">truncWeights</span><span class="paren">(</span><span class="identifier">participationWeights</span>, <span class="identifier">participationOpt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">293</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trim</span><span class="paren">(</span><span class="identifier">participationOpt</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">294</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">retainedObsIndParticipation</span> <span class="operator">&lt;-</span> <span class="identifier">trimInd</span><span class="paren">(</span><span class="identifier">participationModel</span>, <span class="identifier">participationOpt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">295</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">participationModel</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">update</span><span class="paren">(</span><span class="identifier">participationModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">296</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">formula</span>. <span class="operator">=</span> <span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">formula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">297</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">cbind</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">data</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">298</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                  <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">retainedObsIndParticipation</span> <span class="operator">=</span> <span class="identifier">retainedObsIndParticipation</span><span class="paren">)</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">299</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">x</span> <span class="operator">=</span> <span class="literal">TRUE</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">300</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     <span class="identifier">weights</span> <span class="operator">=</span> <span class="identifier">retainedObsIndParticipation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">301</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">obtainWeights</span><span class="paren">(</span><span class="identifier">participationModel</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">transport</span>, <span class="string">"odds"</span>, <span class="string">"probability"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">302</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">303</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">transport</span> <span class="operator">&amp;</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">participationWeights</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">propensityWeights</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">304</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">participationWeights</span><span class="paren">[</span><span class="identifier">allData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">305</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                         <span class="identifier">allData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">306</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">307</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">participationWeights</span> <span class="operator">*</span> <span class="identifier">retainedObsIndParticipation</span><span class="paren">[</span><span class="identifier">allData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">308</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                                     <span class="identifier">allData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">309</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">310</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">311</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">312</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">313</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">finalWeights</span> <span class="operator">&lt;-</span>  <span class="identifier">propensityWeights</span> <span class="operator">*</span> <span class="identifier">participationWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">314</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">315</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">final</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">316</td>
                    <td class="coverage">4008<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trunc</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">final</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">finalWeights</span> <span class="operator">&lt;-</span> <span class="identifier">truncWeights</span><span class="paren">(</span><span class="identifier">finalWeights</span>, <span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">final</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">317</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.trim</span><span class="paren">(</span><span class="identifier">exOpt</span><span class="operator">$</span><span class="identifier">final</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">warning</span><span class="paren">(</span><span class="string">"trim argument provided for final weights. Note that only truncating final weights is supported."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">318</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">319</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">              </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">320</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">customPropensity</span><span class="paren">)</span> <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="paren">(</span><span class="identifier">treatment</span> <span class="operator">%in%</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">msmFormula</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Treatment is not included in MSM."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">321</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">322</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Fit MSM</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">323</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">324</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Extract study data because data frames don't behave well with ifelse</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">325</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">toAnalyze</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">326</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">327</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># The model fitting functions require weights to be part of the data frame</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">328</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">toAnalyze</span><span class="operator">$</span><span class="identifier">finalWeights</span> <span class="operator">&lt;-</span> <span class="identifier">finalWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">329</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">330</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">family</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">331</td>
                    <td class="coverage">1503<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"coxph"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">332</td>
                    <td class="coverage">501<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">coxph</span><span class="paren">(</span><span class="identifier">msmFormula</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">toAnalyze</span>, <span class="identifier">weight</span> <span class="operator">=</span> <span class="identifier">finalWeights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">333</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"survreg"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">334</td>
                    <td class="coverage">501<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">survreg</span><span class="paren">(</span><span class="identifier">msmFormula</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">toAnalyze</span>, <span class="identifier">weight</span> <span class="operator">=</span> <span class="identifier">finalWeights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">335</td>
                    <td class="coverage">501<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"polr"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">336</td>
                    <td class="coverage">501<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">method</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">method</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"logistic"</span>, <span class="string">"probit"</span>, <span class="string">"loglog"</span>, <span class="string">"cloglog"</span>, <span class="string">"cauchit"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">337</td>
                    <td class="coverage">501<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="identifier">MASS</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">polr</span><span class="paren">(</span><span class="identifier">msmFormula</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">toAnalyze</span>, <span class="identifier">weights</span> <span class="operator">=</span> <span class="identifier">finalWeights</span>, <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">method</span>, <span class="identifier">Hess</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">338</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">339</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">340</td>
                    <td class="coverage">11023<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glm</span><span class="paren">(</span><span class="identifier">msmFormula</span>, <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">family</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">toAnalyze</span>, <span class="identifier">weight</span> <span class="operator">=</span> <span class="identifier">finalWeights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">341</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">342</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">343</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># NOTE: this model object by itself has wrong SEs. The right ones are calculated by sandwich::vcovBS. Should we handle this here or in summary.transportIP?</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">344</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Answer: for glm objects, it should be handled in summary.transportIP. For survreg and coxph, it should be handled in this function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">345</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Addendum: sandwich::vcovBS doesn't seem to be giving correct variance estimates. Bootstrap is implemented in the wrapper function.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">346</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">347</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportIPResult</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">msm</span> <span class="operator">=</span> <span class="identifier">model</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">348</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">propensityScoreModel</span> <span class="operator">=</span> <span class="identifier">propensityScoreModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">349</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">participationModel</span> <span class="operator">=</span> <span class="identifier">participationModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">350</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">propensityWeights</span> <span class="operator">=</span> <span class="identifier">propensityWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">351</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">participationWeights</span> <span class="operator">=</span> <span class="identifier">participationWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">352</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">finalWeights</span> <span class="operator">=</span> <span class="identifier">finalWeights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">353</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">customPropensity</span> <span class="operator">=</span> <span class="identifier">customPropensity</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">354</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">customParticipation</span> <span class="operator">=</span> <span class="identifier">customParticipation</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">355</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">treatment</span> <span class="operator">=</span> <span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">356</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">participation</span> <span class="operator">=</span> <span class="identifier">participation</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">357</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">response</span> <span class="operator">=</span> <span class="identifier">response</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">358</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">exOpt</span> <span class="operator">=</span> <span class="identifier">exOpt</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">359</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">data</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">360</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">transport</span> <span class="operator">=</span> <span class="identifier">transport</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">361</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">362</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"transportIP"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">363</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">364</td>
                    <td class="coverage">12526<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">365</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">366</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">367</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># Helper function that extracts weights from models</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">368</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">obtainWeights</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">model</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"probability"</span>, <span class="string">"odds"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">369</td>
                    <td class="coverage">30068<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">type</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">type</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"probability"</span>, <span class="string">"odds"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">370</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">371</td>
                    <td class="coverage">30068<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"probability"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">372</td>
                    <td class="coverage">15539<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">model</span><span class="operator">$</span><span class="identifier">y</span> <span class="operator">==</span> <span class="literal">T</span> <span class="operator">|</span> <span class="identifier">model</span><span class="operator">$</span><span class="identifier">y</span> <span class="operator">==</span> <span class="number">1</span>, <span class="number">1</span> <span class="operator">/</span> <span class="identifier">model</span><span class="operator">$</span><span class="identifier">fitted.values</span>, <span class="number">1</span> <span class="operator">/</span> <span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="identifier">model</span><span class="operator">$</span><span class="identifier">fitted.values</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">373</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">374</td>
                    <td class="coverage">14529<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">responseName</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">model</span><span class="operator">$</span><span class="identifier">formula</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">375</td>
                    <td class="coverage">14529<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationProb</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">predict</span><span class="paren">(</span><span class="identifier">model</span>, <span class="identifier">newdata</span> <span class="operator">=</span> <span class="identifier">model</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="identifier">model</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">responseName</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span> <span class="identifier">model</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">responseName</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span>,<span class="paren">]</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"response"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">376</td>
                    <td class="coverage">14529<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="paren">(</span><span class="number">1</span><span class="operator">-</span><span class="identifier">participationProb</span><span class="paren">)</span> <span class="operator">/</span> <span class="identifier">participationProb</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">377</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">378</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">379</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">380</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># Helper function that detects glms</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">381</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.glm</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">x</span>, <span class="string">"glm"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">382</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">383</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Summarize results of a fitted MSM using the IOPW approach</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">384</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">385</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">386</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Returns summary object which contains a summary of the fitted MSM as well as pre- and post-weighting standardized mean differences (SMDs).</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">387</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">388</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname summary.transportIP</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">389</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">390</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param object Result from \code{transportIP} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">391</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param covariates Vector of strings indicating names of covariates in propensity model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">392</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param effectModifiers Vector of strings indicating names of effect modifiers in participation model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">393</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">394</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">395</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">396</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The \code{summary.transportIP} function returns a \code{summary.transportIP} object containing the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">397</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{propensitySMD}: Table of unweighted and weighted SMDs of covariates between treatment groups. Only propensity weights are used.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">398</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{participationSMD}: Table of unweighted and weighted SMDs of effect modifiers between study data and target data. Only participation weights are used.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">399</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{msmSummary}: Summary object of model object for MSM. The correct variance estimators are set here for \code{glm}, whereas they are set in \code{transportIP} for \code{survreg} and \code{coxph}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">400</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">401</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">402</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summary.transportIP</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">object</span>, <span class="identifier">covariates</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">effectModifiers</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">403</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportIPResult</span> <span class="operator">&lt;-</span> <span class="identifier">object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">404</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">405</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatment</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">406</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">407</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">408</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Calculate SMDs for covariates</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">409</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">410</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Extract study data and weights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">411</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">412</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityScoreModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">413</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">propensityFormula</span> <span class="operator">&lt;-</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">formula</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">414</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">propensityScoreModel</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">415</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">covariates</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">covariates</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">propensityFormula</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">416</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">417</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">data</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">418</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">419</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participationIndex</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">participation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">420</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="identifier">data</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">421</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">data</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">422</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">423</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">response</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">424</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">425</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">426</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">427</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">else</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">428</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">429</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">430</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">431</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">432</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">433</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">propensityWeights</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">propensityWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">434</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatmentIndex</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">treatment</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">435</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">436</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Calculate SMDs for covariates (should optimize)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">437</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">covariates</span> <span class="operator">!=</span> <span class="number">0</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">438</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">prePropensitySMD</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">covariates</span>, <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">covariate</span><span class="paren">)</span> <span class="identifier">as.double</span><span class="paren">(</span><span class="identifier">smd</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">smd</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">covariate</span><span class="paren">)</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">439</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                       <span class="identifier">g</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">treatmentIndex</span><span class="paren">]</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">estimate</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">440</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">prePropensityBalance</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">variable</span> <span class="operator">=</span> <span class="identifier">covariates</span>, <span class="identifier">smd</span> <span class="operator">=</span> <span class="identifier">abs</span><span class="paren">(</span><span class="identifier">prePropensitySMD</span><span class="paren">)</span>, <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="string">"Observed"</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">covariates</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">441</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">postPropensitySMD</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">covariates</span>, <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">covariate</span><span class="paren">)</span> <span class="identifier">as.double</span><span class="paren">(</span><span class="identifier">smd</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">smd</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">covariate</span><span class="paren">)</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">442</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">g</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">treatmentIndex</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">443</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                    <span class="identifier">w</span> <span class="operator">=</span> <span class="identifier">propensityWeights</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">estimate</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">444</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">postPropensityBalance</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">variable</span> <span class="operator">=</span> <span class="identifier">covariates</span>, <span class="identifier">smd</span> <span class="operator">=</span> <span class="identifier">abs</span><span class="paren">(</span><span class="identifier">postPropensitySMD</span><span class="paren">)</span>, <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="string">"Weighted"</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">covariates</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">445</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">446</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">propensityBalance</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">prePropensityBalance</span>, <span class="identifier">postPropensityBalance</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">447</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="identifier">propensityBalance</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">448</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">449</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Calculate SMDs for effect modifiers</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">450</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">451</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationModel</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">452</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">453</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationFormula</span> <span class="operator">&lt;-</span> <span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">formula</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">454</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationData</span> <span class="operator">&lt;-</span> <span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">455</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationIndex</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">participationData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">participation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">456</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">effectModifiers</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">participationFormula</span><span class="paren">)</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">457</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">458</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">data</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">459</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participationData</span> <span class="operator">&lt;-</span> <span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">460</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">461</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># This only happens when user provides custom participation weights and separate study and target data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">462</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyDataEM</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span><span class="paren">[</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span> <span class="operator">%in%</span> <span class="identifier">effectModifiers</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">463</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyDataEM</span><span class="operator">$</span><span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">464</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">targetDataEM</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span><span class="paren">[</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span> <span class="operator">%in%</span> <span class="identifier">effectModifiers</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">465</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">targetDataEM</span><span class="operator">$</span><span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">466</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participationData</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">studyDataEM</span>, <span class="identifier">targetDataEM</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">467</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="string">"participation"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">468</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participationIndex</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">participationData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">participation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">469</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participationData</span><span class="operator">$</span><span class="identifier">participation</span> <span class="operator">&lt;-</span> <span class="identifier">as.factor</span><span class="paren">(</span><span class="identifier">participationData</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">470</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">471</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">472</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Only addresses transportability - need to implement generalizability later</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">473</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">transport</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">474</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">rep</span><span class="paren">(</span><span class="number">1</span>, <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">participationData</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">475</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeights</span><span class="paren">[</span><span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span> <span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">476</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationModel</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">477</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationProb</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">predict</span><span class="paren">(</span><span class="identifier">participationModel</span>, <span class="identifier">newdata</span> <span class="operator">=</span> <span class="identifier">participationData</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"response"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">478</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span> <span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span>, <span class="number">1</span> <span class="operator">/</span> <span class="identifier">participationProb</span>, <span class="number">1</span> <span class="operator">/</span> <span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="identifier">participationProb</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">479</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">480</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Custom participation weights used for generalizability analysis. Defaulting to transportability analysis because I don't know what weights you use for target data."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">481</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeights</span> <span class="operator">&lt;-</span> <span class="identifier">rep</span><span class="paren">(</span><span class="number">1</span>, <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">participationData</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">482</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">participationWeights</span><span class="paren">[</span><span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">|</span> <span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span> <span class="operator">==</span> <span class="literal">T</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationWeights</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">483</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">484</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">485</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Should also optimize</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">486</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span> <span class="operator">!=</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">487</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">preParticipationSMD</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">effectModifiers</span>, <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">effectModifier</span><span class="paren">)</span> <span class="identifier">as.double</span><span class="paren">(</span><span class="identifier">smd</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">smd</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">participationData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">effectModifier</span><span class="paren">)</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">488</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                                 <span class="identifier">g</span> <span class="operator">=</span> <span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">estimate</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">489</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">preParticipationBalance</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">variable</span> <span class="operator">=</span> <span class="identifier">effectModifiers</span>, <span class="identifier">smd</span> <span class="operator">=</span> <span class="identifier">abs</span><span class="paren">(</span><span class="identifier">preParticipationSMD</span><span class="paren">)</span>, <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="string">"Observed"</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">490</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">postParticipationSMD</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">effectModifiers</span>, <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">effectModifier</span><span class="paren">)</span> <span class="identifier">as.double</span><span class="paren">(</span><span class="identifier">smd</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">smd</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">which</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">participationData</span><span class="paren">)</span> <span class="operator">==</span> <span class="identifier">effectModifier</span><span class="paren">)</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">491</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                                              <span class="identifier">g</span> <span class="operator">=</span> <span class="identifier">participationData</span><span class="paren">[</span>, <span class="identifier">participationIndex</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">492</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                                              <span class="identifier">w</span> <span class="operator">=</span> <span class="identifier">participationWeights</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">estimate</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">493</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">postParticipationBalance</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">variable</span> <span class="operator">=</span> <span class="identifier">effectModifiers</span>, <span class="identifier">smd</span> <span class="operator">=</span> <span class="identifier">abs</span><span class="paren">(</span><span class="identifier">postParticipationSMD</span><span class="paren">)</span>, <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="string">"Weighted"</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">494</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">participationBalance</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">preParticipationBalance</span>, <span class="identifier">postParticipationBalance</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">495</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="identifier">participationBalance</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">496</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">497</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># If model is glm, calculate and replace correct SEs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">498</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">499</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">msm</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">500</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">501</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">msmSummary</span> <span class="operator">&lt;-</span> <span class="identifier">suppressWarnings</span><span class="paren">(</span><span class="identifier">summary</span><span class="paren">(</span><span class="identifier">msm</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">502</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">503</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">msmSummary</span>, <span class="string">"summary.glm"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">504</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">cov.scaled</span> <span class="operator">&lt;-</span> <span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">505</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">cov.unscaled</span> <span class="operator">&lt;-</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">cov.scaled</span> <span class="operator">/</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">dispersion</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">506</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">2</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">diag</span><span class="paren">(</span><span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">cov.scaled</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">507</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">3</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">1</span><span class="paren">]</span> <span class="operator">/</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">2</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">508</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">family</span><span class="operator">$</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"gaussian"</span><span class="paren">)</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">4</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">2</span> <span class="operator">*</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">pt</span><span class="paren">(</span><span class="identifier">abs</span><span class="paren">(</span><span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">3</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">df</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span>, <span class="identifier">lower.tail</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">509</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">4</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">2</span> <span class="operator">*</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">pnorm</span><span class="paren">(</span><span class="identifier">abs</span><span class="paren">(</span><span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">3</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">lower.tail</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">510</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">511</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">512</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Same for polr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">513</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">514</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">msmSummary</span>, <span class="string">"summary.polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">515</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">2</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">diag</span><span class="paren">(</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">516</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">3</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">1</span><span class="paren">]</span> <span class="operator">/</span> <span class="identifier">msmSummary</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span>, <span class="number">2</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">517</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">518</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">519</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryTransportIP</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">propensitySMD</span> <span class="operator">=</span> <span class="identifier">propensityBalance</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">520</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">participationSMD</span> <span class="operator">=</span> <span class="identifier">participationBalance</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">521</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">msmSummary</span> <span class="operator">=</span> <span class="identifier">msmSummary</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">522</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">523</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">summaryTransportIP</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"summary.transportIP"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">524</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">525</td>
                    <td class="coverage">43<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">summaryTransportIP</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">526</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">527</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">528</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname summary.transportIP</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">529</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">530</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x \code{summary.transportIP} object.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">531</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param out Output stream.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">532</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">533</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">534</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">535</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">536</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">537</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">print.summary.transportIP</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">out</span> <span class="operator">=</span> <span class="identifier">stdout</span><span class="paren">(</span><span class="paren">)</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">538</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryTransportIP</span> <span class="operator">&lt;-</span> <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">539</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">540</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"Absolute SMDs of covariates between treatments before and after weighting:"</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">541</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryTransportIP</span><span class="operator">$</span><span class="identifier">propensitySMD</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">542</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">543</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"Absolute SMDs of effect modifiers between study and target populations before and after weighting:"</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">544</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryTransportIP</span><span class="operator">$</span><span class="identifier">participationSMD</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">545</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">546</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"MSM results:"</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">547</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryTransportIP</span><span class="operator">$</span><span class="identifier">msmSummary</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">548</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">549</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">550</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Plot graphs relevant to transportability analysis using IOPW</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">551</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">552</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">553</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Plot graphs for assessment of covariate balance and results in a IOPW analysis. This function currently supports mirrored histograms, SMD plots and model coefficient plots.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">554</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">555</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x Result from \code{transportIP} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">556</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param type One of \code{"propensityHist", "propensitySMD", "participationHist", "participationSMD", "msm"}. \code{Hist} produces mirrored histograms of estimated probability of treatment between treatment groups (for \code{propensity}), or of estimated probability of participation between study and target data (for \code{participation}). \code{SMD} produces SMD plots of covariates between treatment groups (for \code{propensity}) or effect modifiers between study and target data (for \code{participation}). \code{msm} produces plots showing confidence intervals for the model coefficients, which should have the correct standard errors.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">557</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param bins Number of bins for propensity score/participation probability histograms. This is only used for \code{Hist}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">558</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param covariates Vector of strings indicating names of covariates in propensity model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">559</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param effectModifiers Vector of strings indicating names of effect modifiers in participation model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">560</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">561</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">562</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">563</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{ggplot} object which contains the desired plot.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">564</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">565</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">566</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">567</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom rlang .data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">568</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom stats density</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">569</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">plot.transportIP</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"propensityHist"</span>, <span class="identifier">bins</span> <span class="operator">=</span> <span class="number">50</span>, <span class="identifier">covariates</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">effectModifiers</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">570</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportIPResult</span> <span class="operator">&lt;-</span> <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">571</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryTransportIP</span> <span class="operator">&lt;-</span> <span class="identifier">summary</span><span class="paren">(</span><span class="identifier">transportIPResult</span>, <span class="identifier">covariates</span> <span class="operator">=</span> <span class="identifier">covariates</span>, <span class="identifier">effectModifiers</span> <span class="operator">=</span> <span class="identifier">effectModifiers</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">572</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">573</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">574</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Match argument</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">575</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">type</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">type</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"propensityHist"</span>, <span class="string">"propensitySMD"</span>, <span class="string">"participationHist"</span>, <span class="string">"participationSMD"</span>, <span class="string">"msm"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">576</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">577</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"propensityHist"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">578</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Mirrored histogram of propensity scores</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">579</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">customPropensity</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">580</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">propensityModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">581</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">propensityModel</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">582</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">studyData</span><span class="operator">$</span><span class="identifier">propensityScore</span> <span class="operator">&lt;-</span> <span class="identifier">propensityModel</span><span class="operator">$</span><span class="identifier">fitted.values</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">583</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentVar</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">584</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentGroups</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">factor</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatmentVar</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">585</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentGroupIdx</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">586</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">treatmentGroups</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">587</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">treatmentGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatmentVar</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="identifier">treatmentGroups</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">588</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">589</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ggplot</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span>, <span class="identifier">mapping</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">.data</span><span class="operator">$</span><span class="identifier">propensityScore</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">590</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">halfmoon</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_mirror_histogram</span><span class="paren">(</span><span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">group</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">treatmentVar</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">treatmentVar</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">bins</span> <span class="operator">=</span> <span class="identifier">bins</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">591</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">stat_density</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span><span class="identifier">treatmentGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span>,<span class="paren">]</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">propensityScore</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="operator">-</span><span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">after_stat</span><span class="paren">(</span><span class="identifier">density</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">alpha</span> <span class="operator">=</span> <span class="number">0</span><span class="paren">)</span> <span class="operator">+</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">592</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">stat_density</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span><span class="paren">[</span><span class="identifier">treatmentGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>,<span class="paren">]</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">propensityScore</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">after_stat</span><span class="paren">(</span><span class="identifier">density</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">alpha</span> <span class="operator">=</span> <span class="number">0</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">593</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ylab</span><span class="paren">(</span><span class="string">"Count"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">594</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">595</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Custom propensity weights were used. Please plot your previously estimated propensity scores using the halfmoon package, if desired."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">596</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">597</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"propensitySMD"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">598</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># SMD plot of covariates</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">599</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">propensitySMD</span> <span class="operator">&lt;-</span> <span class="identifier">summaryTransportIP</span><span class="operator">$</span><span class="identifier">propensitySMD</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">600</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">propensitySMD</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"No covariates to plot, please provide some."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">601</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ggplot</span><span class="paren">(</span><span class="identifier">propensitySMD</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">variable</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">smd</span>, <span class="identifier">group</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">method</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">method</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">602</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_line</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">603</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_point</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">604</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_hline</span><span class="paren">(</span><span class="identifier">yintercept</span> <span class="operator">=</span> <span class="number">0.1</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">605</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">coord_flip</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">606</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">theme_bw</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">607</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">theme</span><span class="paren">(</span><span class="identifier">legend.key</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">element_blank</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">608</td>
                    <td class="coverage">15<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"participationHist"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">609</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Mirrored histogram of probability of participation</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">610</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">customParticipation</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">611</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">participationModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">612</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">allData</span> <span class="operator">&lt;-</span> <span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">613</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">allData</span><span class="operator">$</span><span class="identifier">participationScore</span> <span class="operator">&lt;-</span> <span class="identifier">participationModel</span><span class="operator">$</span><span class="identifier">fitted.values</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">614</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">participationVar</span> <span class="operator">&lt;-</span> <span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participation</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">615</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">participationGroups</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">factor</span><span class="paren">(</span><span class="identifier">allData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">participationVar</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">616</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">participationGroupIdx</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">617</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">participationGroups</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">618</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">participationGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">allData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">participationVar</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="identifier">participationGroups</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">619</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">620</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ggplot</span><span class="paren">(</span><span class="identifier">allData</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">.data</span><span class="operator">$</span><span class="identifier">participationScore</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">621</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">halfmoon</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_mirror_histogram</span><span class="paren">(</span><span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">group</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">participationVar</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="paren">[</span><span class="paren">[</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">participationVar</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">bins</span> <span class="operator">=</span> <span class="identifier">bins</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">622</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">stat_density</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">allData</span><span class="paren">[</span><span class="identifier">participationGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span>,<span class="paren">]</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">participationScore</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="operator">-</span><span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">after_stat</span><span class="paren">(</span><span class="identifier">density</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">alpha</span> <span class="operator">=</span> <span class="number">0</span><span class="paren">)</span> <span class="operator">+</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">623</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">stat_density</span><span class="paren">(</span><span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">allData</span><span class="paren">[</span><span class="identifier">participationGroupIdx</span><span class="paren">[</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span>,<span class="paren">]</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">participationScore</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">after_stat</span><span class="paren">(</span><span class="identifier">density</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="string">"black"</span>, <span class="identifier">alpha</span> <span class="operator">=</span> <span class="number">0</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">624</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ylab</span><span class="paren">(</span><span class="string">"Count"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">625</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">626</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Custom participation weights were used. Please plot your previously estimated participation scores using the halfmoon package, if desired."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">627</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">628</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"participationSMD"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">629</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># SMD plots of effect modifiers</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">630</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">participationSMD</span> <span class="operator">&lt;-</span> <span class="identifier">summaryTransportIP</span><span class="operator">$</span><span class="identifier">participationSMD</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">631</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">participationSMD</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"No effect modifiers to plot, please provide some."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">632</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ggplot</span><span class="paren">(</span><span class="identifier">participationSMD</span>, <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">aes</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">variable</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">smd</span>, <span class="identifier">group</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">method</span>, <span class="identifier">color</span> <span class="operator">=</span> <span class="identifier">.data</span><span class="operator">$</span><span class="identifier">method</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">+</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">633</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_line</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">634</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_point</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">635</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">geom_hline</span><span class="paren">(</span><span class="identifier">yintercept</span> <span class="operator">=</span> <span class="number">0.1</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">636</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">coord_flip</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">637</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">theme_bw</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">+</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">638</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">theme</span><span class="paren">(</span><span class="identifier">legend.key</span> <span class="operator">=</span> <span class="identifier">ggplot2</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">element_blank</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">639</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"msm"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">640</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># Coefficient plots</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">641</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">modelsummary</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">modelplot</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">642</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                            <span class="identifier">vcov</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">643</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                            <span class="identifier">coef_omit</span> <span class="operator">=</span> <span class="string">"(Intercept)"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">644</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">645</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">646</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">resultPlot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">647</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">648</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">649</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Check validity of IOPW result object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">650</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">651</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">652</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A simple helper function that validates whether the components of the given \code{transportIP} object are of the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">653</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">654</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param transportIPResult Result object from \code{transportIP} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">655</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">656</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return A boolean indicating whether all components of \code{transportIP} object have the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">657</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">658</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">659</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">660</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.transportIP</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">transportIPResult</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">661</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span>, <span class="string">"glm"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span>, <span class="string">"coxph"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span>, <span class="string">"survreg"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">msm</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">662</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span>, <span class="string">"glm"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">propensityScoreModel</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">663</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationModel</span>, <span class="string">"glm"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationModel</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">664</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">propensityWeights</span>, <span class="string">"numeric"</span><span class="paren">)</span> <span class="operator">&amp;</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">665</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participationWeights</span>, <span class="string">"numeric"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">666</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">finalWeights</span>, <span class="string">"numeric"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">667</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">customPropensity</span>, <span class="string">"logical"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">668</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">customParticipation</span>, <span class="string">"logical"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">669</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">treatment</span>, <span class="string">"character"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">treatment</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">670</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participation</span>, <span class="string">"character"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">participation</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">671</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">data</span>, <span class="string">"data.frame"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">transportIPResult</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">2</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">672</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">transportIPResult</span>, <span class="string">"transportIP"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">673</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/transportGCPreparedModel.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Prepare an outcome model object for \code{transportGC}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' An outcome model needs to be fitted using the study data to perform transportability analysis using g-computation. However, \code{glm} and functions in \code{survival} typically contain the data used to fit the model in their respective result objects. This function provides the option to remove most components containing the data from these result objects to comply with data sharing regulations. The party with sole access to the study data may use only this function and provide the results object (possibly in a .rds file) to others who request it.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Note that for time-to-event outcomes, \code{survreg} should used for the outcome model over \code{coxph} because the latter is not meant to produce predicted survival times. The \code{coxph} option is provided, but we warn that the computation time might be prohibitive.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outcomeModel Either a formula or a \code{glm}, \code{survreg}, \code{coxph}, or \code{polr} object representing the outcome model. Please set \code{model = T} if providing a fitted model object.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param response String indicating name of response variable. If \code{NULL}, it will be auto-detected from \code{outcomeModel}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param responseLevels For ordinal responses, vector of strings indicating levels of response variable in the study data. If \code{NULL} and \code{polr} is used, it will be auto-detected using \code{response} and \code{studyData}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param treatment String indicating name of treatment variable. This argument is required.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param treatmentLevels Vector of strings indicating levels of treatment variable in the study data. If \code{NULL}, it will be auto-detected using \code{treatment} and \code{studyData}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param family Either a family function as used for \code{glm}, or one of \code{c("coxph", "survreg")}. Only required if \code{outcomeModel} is a formula.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param method Link function used for \code{polr}, one of \code{c("logistic", "probit", "loglog", "cloglog", "cauchit")}. Only required if \code{outcomeModel} is a formula and \code{polr} is used.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param studyData Data frame of the study data.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param wipe Logical indicating whether original study data should be wiped from outcome model-fitting object.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param formula The formula used to fit outcomeModel, if outcomeModel is provided as a fitted model object. This is necessary to provide only when using \code{coxph}, \code{survreg} and \code{polr} because these objects do not have the formula components.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{transportGCPreparedModel} object containing the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{outcomeModel}: The fitted outcome model with all components containing the data used to fit the model removed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{response}: String indicating name of response variable</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{treatment}: String indicating name of treatment variable</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{treatmentLevels}: Vector of strings indicating levels of treatment variable</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{family}: The \code{family} argument provided</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{wipe}: The \code{wipe} argument provided</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{formula}: The formula used to fit the outcome model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @md</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transportGCPreparedModel</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">outcomeModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">response</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">responseLevels</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">treatmentLevels</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">gaussian</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"logistic"</span>, <span class="string">"probit"</span>, <span class="string">"loglog"</span>, <span class="string">"cloglog"</span>, <span class="string">"cauchit"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">studyData</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">wipe</span> <span class="operator">=</span> <span class="literal">T</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                             <span class="identifier">formula</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Extract response variable</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"formula"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">3008<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">formula</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"glm"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"polr"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"survreg"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">51</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">formula</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">formula</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">formula</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">model</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">55</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">response</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">56</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"formula"</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">response</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">outcomeModel</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">57</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="identifier">response</span> <span class="operator">&lt;-</span> <span class="identifier">all.vars</span><span class="paren">(</span><span class="identifier">formula</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Extract treatment variable information. There is no way of detecting treatment from the outcome model formula because it often has covariates in it as well.</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">61</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">treatment</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Treatment variable name is not specified."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">63</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">treatmentLevels</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">64</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="identifier">treatmentLevels</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># If not already a model object, fit the outcome model ourselves. Recall that only the party that has access to the study data should run this function and provide its output to the other party.</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">67</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"formula"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">68</td>
                    <td class="coverage">3008<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">family</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">69</td>
                    <td class="coverage">1004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"coxph"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">70</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outcomeModel</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">coxph</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span>, <span class="identifier">model</span> <span class="operator">=</span> <span class="operator">!</span><span class="identifier">wipe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">71</td>
                    <td class="coverage">1004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"survreg"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">72</td>
                    <td class="coverage">502<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outcomeModel</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">survreg</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span>, <span class="identifier">model</span> <span class="operator">=</span> <span class="operator">!</span><span class="identifier">wipe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">73</td>
                    <td class="coverage">502<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">family</span> <span class="operator">==</span> <span class="string">"polr"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">74</td>
                    <td class="coverage">502<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outcomeModel</span> <span class="operator">&lt;-</span> <span class="identifier">MASS</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">polr</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span>, <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">method</span>, <span class="identifier">model</span> <span class="operator">=</span> <span class="operator">!</span><span class="identifier">wipe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">77</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outcomeModel</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glm</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">family</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">studyData</span>, <span class="identifier">model</span> <span class="operator">=</span> <span class="operator">!</span><span class="identifier">wipe</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">78</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">80</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Extract response variable information when polr is used</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">82</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">83</td>
                    <td class="coverage">502<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">responseLevels</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">84</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="identifier">responseLevels</span> <span class="operator">&lt;-</span> <span class="identifier">levels</span><span class="paren">(</span><span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">86</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">87</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Erase study data from outcome model object</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">88</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">wipe</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">89</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"glm"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">90</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">residuals</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">fitted.values</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">linear.predictors</span> <span class="operator">&lt;-</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">91</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">weights</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">y</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">x</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">model</span> <span class="operator">&lt;-</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">data</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">offset</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">xlevels</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">93</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"survreg"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">94</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">linear.predictors</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">means</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">y</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">x</span> <span class="operator">&lt;-</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">95</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">96</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># } else if (inherits(outcomeModel, "coxph")) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   outcomeModel$linear.predictors &lt;- outcomeModel$residuals &lt;- outcomeModel$n &lt;- outcomeModel$nevent &lt;-</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     outcomeModel$concordance &lt;- outcomeModel$means &lt;-</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">99</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     outcomeModel$model &lt;- NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">100</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">101</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">fitted.values</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">n</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">nobs</span> <span class="operator">&lt;-</span> <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">lp</span> <span class="operator">&lt;-</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">102</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">model</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">103</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">104</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">105</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">106</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">preparedModel</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">outcomeModel</span> <span class="operator">=</span> <span class="identifier">outcomeModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">107</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">response</span> <span class="operator">=</span> <span class="identifier">response</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">108</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">responseLevels</span> <span class="operator">=</span> <span class="identifier">responseLevels</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">109</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">treatment</span> <span class="operator">=</span> <span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">110</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">treatmentLevels</span> <span class="operator">=</span> <span class="identifier">treatmentLevels</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">111</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">family</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">112</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">wipe</span> <span class="operator">=</span> <span class="identifier">wipe</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">113</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">formula</span> <span class="operator">=</span> <span class="identifier">formula</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">115</td>
                    <td class="coverage">3005<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">wipe</span><span class="paren">)</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">116</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">117</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"transportGCPreparedModel"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">118</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">119</td>
                    <td class="coverage">3010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">120</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">122</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Check validity of prepared model object for g-computation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">123</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">124</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">125</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A simple helper function that validates whether the components of the given \code{transportGCPreparedModel} object are of the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">126</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param preparedModel Output object from \code{transportGCPreparedModel} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">128</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">129</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">130</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A boolean indicating whether all components of \code{transportGCPreparedModel} object have the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">131</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.transportGCPreparedModel</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">preparedModel</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">134</td>
                    <td class="coverage">6024<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span>, <span class="string">"glm"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span>, <span class="string">"survreg"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span>, <span class="string">"coxph"</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">135</td>
                    <td class="coverage">6024<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">response</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatment</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">is.logical</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">wipe</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">136</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/transportInterpolated.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Transportability analysis using interpolated g-computation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Estimates the average treatment effect (ATE) using interpolated g-computation in a generalizability or transportability analysis. In particular, the estimators should be unbiased for the ATE in the superpopulation or the target population, respectively.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param link Defaults to \code{"identity"}, which corresponds to absolute treatment effects for continuous responses. The \code{"log"} option accommodates relative treatment effects such as relative risk, odds ratio and hazard ratio.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param effectModifiers Vector of strings indicating effect modifiers to adjust for</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param mainTreatmentEffect Estimate of ATE in original study</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param mainSE Estimate of standard error of estimator of ATE in original study</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param subgroupTreatmentEffects Estimates of subgroup ATEs in original study. Please provide subgroup ATEs in the order of effect modifiers listed in \code{effectModifiers}, and provide the ATE of the subgroup whose proportion is provided in \code{summaryAggregateData} first in each pair</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param subgroupSEs Estimates of standard errors of subgroup ATEs in original study. Please provide SEs in the order of effect modifiers listed in \code{effectModifiers}, and provide the SE of the subgroup whose proportion is provided in \code{summaryAggregateData} first in each pair</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param corrStructure Correlation structure of dichotomized effect modifiers. If target IPD is provided, this will be estimated from the target data, if user input is omitted. If target aggregate data is provided, this will be specified by the user and default to an independent correlation structure if left unspecified.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param studySampleSize Sample size of original study</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param aggregateStudyData Vector of proportions of dichotomized effect modifiers in study data. Please provide proportions of only one category for each effect modifier. This category should correspond to the the first ATE and SE provided for each effect modifier.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param targetData May be IPD or aggregate. If aggregate, provide proportions of only one category of dichotomized effect modifiers in a named vector (not a data frame)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom Rdpack reprompt</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @details</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' This function transports the ATE estimate from the original study data to the target data by utilizing subgroup effect estimates in the same way as network meta-interpolation (Harari et al., 2023). As standard errors are transported manually, no bootstrapping is done, unlike other methods supported by \code{TransportHealthR}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{transportInterpolated} object with the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{effect}: Transported ATE estimate</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{link}: Denotes the link function used. Absolute treatment effects (i.e. for continuous outcomes) correspond to \code{"identity"}, while relative treatment effects correspond to \code{"log"}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{var}: Transported variance estimate of effect estimate</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{effectModifiers}: Vector of strings indicating effect modifiers adjusted for</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{mainTreatmentEffect}: Estimate of ATE in original study</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{mainSE}: Standard error of estimator of ATE in original study</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{subgroupTreatmentEffects}: Estimates of subgroup ATEs in original study, as provided</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{subgroupSEs}: Estimates of standard errors of subgroup ATEs in original study, as provided</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{corrStructure}: Correlation structure of effect modifiers used in analysis</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{studySampleSize}: Sample size of original study</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{aggregateStudyData}: Aggregate-level study data, as provided</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{targetData}: Target data, as provided</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @references</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Harari O, Soltanifar M, Cappelleri JC, et al. Network meta-interpolation: Effect modification adjustment in network meta-analysis using subgroup analyses. Res Syn Meth. 2023; 14(2): 211-233. doi:10.1002/jrsm.1608</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @md</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transportInterpolated</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">link</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"identity"</span>, <span class="string">"log"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">effectModifiers</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">mainTreatmentEffect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">mainSE</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">subgroupTreatmentEffects</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">subgroupSEs</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">corrStructure</span> <span class="operator">=</span> <span class="literal">NULL</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">studySampleSize</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">aggregateStudyData</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                           <span class="identifier">targetData</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># TODO: bugfix for 1 EM</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">56</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">subgroupTreatmentEffects</span><span class="paren">)</span> <span class="operator">!=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span> <span class="operator">*</span> <span class="number">2</span> <span class="operator">|</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">57</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">length</span><span class="paren">(</span><span class="identifier">subgroupSEs</span><span class="paren">)</span> <span class="operator">!=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span> <span class="operator">*</span> <span class="number">2</span> <span class="operator">|</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">58</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span> <span class="operator">!=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">aggregateStudyData</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">59</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Incongruent lengths of list of effect modifiers and list of subgroup effects/SEs. Make sure that all effect modifiers are dichotomized. Provide treatment effects for each marginal subgroup."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">link</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">link</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"identity"</span>, <span class="string">"log"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Obtain treatment effects and SEs on the linear predictor scale</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">64</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">link</span> <span class="operator">==</span> <span class="string">"log"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">65</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lpMainTreatmentEffect</span>  <span class="operator">&lt;-</span> <span class="identifier">log</span><span class="paren">(</span><span class="identifier">mainTreatmentEffect</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">66</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lpMainSE</span> <span class="operator">&lt;-</span> <span class="identifier">mainSE</span> <span class="operator">/</span> <span class="identifier">lpMainTreatmentEffect</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">67</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lpSubgroupTreatmentEffects</span> <span class="operator">&lt;-</span> <span class="identifier">log</span><span class="paren">(</span><span class="identifier">subgroupTreatmentEffects</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">68</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lpSubgroupSEs</span> <span class="operator">&lt;-</span> <span class="identifier">subgroupSEs</span> <span class="operator">/</span> <span class="identifier">lpSubgroupTreatmentEffects</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">70</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lpMainTreatmentEffect</span> <span class="operator">&lt;-</span> <span class="identifier">mainTreatmentEffect</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">71</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lpMainSE</span> <span class="operator">&lt;-</span> <span class="identifier">mainSE</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">72</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lpSubgroupTreatmentEffects</span> <span class="operator">&lt;-</span> <span class="identifier">subgroupTreatmentEffects</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">73</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lpSubgroupSEs</span> <span class="operator">&lt;-</span> <span class="identifier">subgroupSEs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">76</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">m</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">78</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Calculate aggregate statistics of target data if IPD</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">80</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">effectModifiers</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">81</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Please provide effect modifier names as in target data."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">82</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">numericTargetData</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">as.matrix</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">[</span>, <span class="identifier">effectModifiers</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span><span class="paren">)</span>, <span class="number">2</span>, <span class="identifier">as.numeric</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">83</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">emTargetProps</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">[</span>, <span class="identifier">effectModifiers</span>, <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span>, <span class="number">2</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">mean</span><span class="paren">(</span><span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">84</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">corrStructure</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">corrStructure</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">cor</span><span class="paren">(</span><span class="identifier">numericTargetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">86</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Extract aggregate statistics of target data if already aggregate</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">87</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">effectModifiers</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">88</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Please provide effect modifier names as in target data."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">89</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">emTargetProps</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span><span class="paren">[</span><span class="identifier">effectModifiers</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">90</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">corrStructure</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">91</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="string">"Correlation structure not provided while aggregate target data is provided. Defaulting to independent correlation structure."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">corrStructure</span> <span class="operator">&lt;-</span> <span class="identifier">diag</span><span class="paren">(</span><span class="identifier">m</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">93</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">94</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">95</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">96</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">emStudyVars</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">aggregateStudyData</span> <span class="operator">*</span> <span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="identifier">aggregateStudyData</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">/</span> <span class="identifier">studySampleSize</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Construct enriched data matrix for treatment effect</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">99</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">enrichedTEMatrix</span> <span class="operator">&lt;-</span> <span class="identifier">matrix</span><span class="paren">(</span><span class="identifier">double</span><span class="paren">(</span><span class="paren">(</span><span class="number">2</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span> <span class="operator">*</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">ncol</span> <span class="operator">=</span> <span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">100</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">enrichedTEMatrix</span><span class="paren">[</span>, <span class="number">1</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">1</span> <span class="comment"># Intercept column</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">101</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">enrichedTEMatrix</span><span class="paren">[</span><span class="number">1</span>, <span class="paren">(</span><span class="number">2</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">m</span><span class="operator">+</span><span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">aggregateStudyData</span> <span class="comment"># Overall TE row</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">102</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">j</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">m</span><span class="paren">)</span> <span class="identifier">enrichedTEMatrix</span><span class="paren">[</span><span class="number">2</span> <span class="operator">*</span> <span class="identifier">j</span>, <span class="number">1</span> <span class="operator">+</span> <span class="identifier">j</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">1</span> <span class="comment"># Filling in 1s at corresponding rows of subgroup treatment effect</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">103</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">m</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># BLUP</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">104</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">idx</span> <span class="operator">&lt;-</span> <span class="identifier">setdiff</span><span class="paren">(</span><span class="number">2</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">m</span><span class="operator">+</span><span class="number">1</span><span class="paren">)</span>, <span class="identifier">i</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">105</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">enrichedTEMatrix</span><span class="paren">[</span><span class="number">2</span><span class="operator">*</span><span class="identifier">i</span>, <span class="identifier">idx</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">corrStructure</span><span class="paren">[</span><span class="identifier">i</span>, <span class="operator">-</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">*</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">emStudyVars</span><span class="paren">[</span><span class="operator">-</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">/</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">emStudyVars</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">*</span> <span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="identifier">aggregateStudyData</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">aggregateStudyData</span><span class="paren">[</span><span class="operator">-</span><span class="identifier">i</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">106</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">enrichedTEMatrix</span><span class="paren">[</span><span class="number">2</span><span class="operator">*</span><span class="identifier">i</span> <span class="operator">+</span> <span class="number">1</span>, <span class="identifier">idx</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">corrStructure</span><span class="paren">[</span><span class="identifier">i</span>, <span class="operator">-</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">*</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">emStudyVars</span><span class="paren">[</span><span class="operator">-</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">/</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">emStudyVars</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">*</span> <span class="paren">(</span><span class="number">0</span> <span class="operator">-</span> <span class="identifier">aggregateStudyData</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">aggregateStudyData</span><span class="paren">[</span><span class="operator">-</span><span class="identifier">i</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">107</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">109</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Construct enriched data matrix for SE</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">110</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">enrichedSEMatrix</span> <span class="operator">&lt;-</span> <span class="identifier">matrix</span><span class="paren">(</span><span class="identifier">double</span><span class="paren">(</span><span class="paren">(</span><span class="number">2</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span> <span class="operator">*</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">m</span><span class="operator">^</span><span class="number">2</span> <span class="operator">+</span> <span class="number">3</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">2</span><span class="paren">)</span> <span class="operator">/</span> <span class="number">2</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">nrow</span> <span class="operator">=</span> <span class="number">2</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">111</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">enrichedSEMatrix</span><span class="paren">[</span>, <span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">enrichedTEMatrix</span><span class="operator">^</span><span class="number">2</span> <span class="comment"># Square columns</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">112</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">enrichedSEMatrix</span><span class="paren">[</span>, <span class="paren">(</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">2</span><span class="paren">)</span><span class="operator">:</span><span class="paren">(</span><span class="number">2</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">2</span> <span class="operator">*</span> <span class="identifier">enrichedTEMatrix</span><span class="paren">[</span>, <span class="operator">-</span><span class="number">1</span><span class="paren">]</span> <span class="comment"># Double columns</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">113</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">&gt;</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">114</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">j</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">m</span><span class="operator">-</span><span class="number">1</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">115</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">j</span><span class="operator">+</span><span class="number">1</span><span class="paren">)</span><span class="operator">:</span><span class="identifier">m</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># Entrywise products of columns</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">116</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">enrichedSEMatrix</span><span class="paren">[</span>, <span class="number">2</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span> <span class="operator">+</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">*</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">-</span> <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="operator">/</span><span class="number">2</span> <span class="operator">-</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">m</span> <span class="operator">-</span> <span class="identifier">j</span><span class="paren">)</span> <span class="operator">*</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">-</span> <span class="identifier">j</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="operator">/</span><span class="number">2</span> <span class="operator">+</span> <span class="paren">(</span><span class="identifier">i</span> <span class="operator">-</span> <span class="identifier">j</span><span class="paren">)</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">2</span> <span class="operator">*</span> <span class="identifier">enrichedTEMatrix</span><span class="paren">[</span>, <span class="number">1</span> <span class="operator">+</span> <span class="identifier">j</span><span class="paren">]</span> <span class="operator">*</span> <span class="identifier">enrichedTEMatrix</span><span class="paren">[</span>, <span class="number">1</span> <span class="operator">+</span> <span class="identifier">i</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">117</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">118</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">119</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">120</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Construct corresponding EM configuration for target data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">122</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">emTargetVarsAllTerms</span> <span class="operator">&lt;-</span> <span class="identifier">double</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">m</span><span class="operator">^</span><span class="number">2</span> <span class="operator">+</span> <span class="number">3</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">2</span><span class="paren">)</span> <span class="operator">/</span> <span class="number">2</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">123</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">emTargetVarsAllTerms</span><span class="paren">[</span><span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="number">1</span>, <span class="identifier">emTargetProps</span><span class="paren">)</span><span class="operator">^</span><span class="number">2</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">124</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">emTargetVarsAllTerms</span><span class="paren">[</span><span class="paren">(</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">2</span><span class="paren">)</span><span class="operator">:</span><span class="paren">(</span><span class="number">2</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">2</span> <span class="operator">*</span> <span class="identifier">emTargetProps</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">125</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">&gt;</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">126</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">j</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">m</span><span class="operator">-</span><span class="number">1</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">127</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">j</span><span class="operator">+</span><span class="number">1</span><span class="paren">)</span><span class="operator">:</span><span class="identifier">m</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">128</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">emTargetVarsAllTerms</span><span class="paren">[</span><span class="number">2</span><span class="operator">*</span><span class="identifier">m</span> <span class="operator">+</span> <span class="number">1</span> <span class="operator">+</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">*</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">-</span> <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="operator">/</span><span class="number">2</span> <span class="operator">-</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">m</span> <span class="operator">-</span> <span class="identifier">j</span><span class="paren">)</span> <span class="operator">*</span> <span class="paren">(</span><span class="identifier">m</span> <span class="operator">-</span> <span class="identifier">j</span> <span class="operator">+</span> <span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="operator">/</span><span class="number">2</span> <span class="operator">+</span> <span class="paren">(</span><span class="identifier">i</span> <span class="operator">-</span> <span class="identifier">j</span><span class="paren">)</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="number">2</span> <span class="operator">*</span> <span class="identifier">emTargetProps</span><span class="paren">[</span><span class="identifier">j</span><span class="paren">]</span> <span class="operator">*</span> <span class="identifier">emTargetProps</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">129</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">130</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">131</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Obtain coefficient estimates for treatment effect</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">134</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">betaHat</span> <span class="operator">&lt;-</span> <span class="identifier">solve</span><span class="paren">(</span><span class="identifier">t</span><span class="paren">(</span><span class="identifier">enrichedTEMatrix</span><span class="paren">)</span> <span class="operator">%*%</span> <span class="identifier">enrichedTEMatrix</span><span class="paren">)</span> <span class="operator">%*%</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">enrichedTEMatrix</span><span class="paren">)</span> <span class="operator">%*%</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">lpMainTreatmentEffect</span>, <span class="identifier">lpSubgroupTreatmentEffects</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">135</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">136</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Obtain coefficient estimates for SE</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">137</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">sigmaHat</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">enrichedSEMatrix</span><span class="paren">)</span> <span class="operator">%*%</span> <span class="identifier">MASS</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ginv</span><span class="paren">(</span><span class="identifier">enrichedSEMatrix</span> <span class="operator">%*%</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">enrichedSEMatrix</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">%*%</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">lpMainSE</span><span class="operator">^</span><span class="number">2</span>, <span class="identifier">lpSubgroupSEs</span><span class="operator">^</span><span class="number">2</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">138</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">139</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Transported effects on linear predictor scale</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">140</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">lpEffect</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">betaHat</span><span class="paren">)</span> <span class="operator">%*%</span> <span class="identifier">c</span><span class="paren">(</span><span class="number">1</span>, <span class="identifier">emTargetProps</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">141</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">lpVar</span> <span class="operator">&lt;-</span> <span class="identifier">t</span><span class="paren">(</span><span class="identifier">sigmaHat</span><span class="paren">)</span> <span class="operator">%*%</span> <span class="identifier">emTargetVarsAllTerms</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">143</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Obtain effects on original scale</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">144</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">link</span> <span class="operator">==</span> <span class="string">"log"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">145</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">lpEffect</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">146</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">var</span> <span class="operator">&lt;-</span> <span class="identifier">lpVar</span> <span class="operator">*</span> <span class="identifier">effect</span> <span class="comment">#bug</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">147</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">148</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="identifier">lpEffect</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">149</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">var</span> <span class="operator">&lt;-</span> <span class="identifier">lpVar</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">150</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">151</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">152</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">result</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">effect</span> <span class="operator">=</span> <span class="identifier">effect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">153</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">link</span> <span class="operator">=</span> <span class="identifier">link</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">154</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">var</span> <span class="operator">=</span> <span class="identifier">var</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">155</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">effectModifiers</span> <span class="operator">=</span> <span class="identifier">effectModifiers</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">156</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">mainTreatmentEffect</span> <span class="operator">=</span> <span class="identifier">mainTreatmentEffect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">157</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">mainSE</span> <span class="operator">=</span> <span class="identifier">mainSE</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">158</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">subgroupTreatmentEffects</span> <span class="operator">=</span> <span class="identifier">subgroupTreatmentEffects</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">159</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">subgroupSEs</span> <span class="operator">=</span> <span class="identifier">subgroupSEs</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">160</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">corrStructure</span> <span class="operator">=</span> <span class="identifier">corrStructure</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">161</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">studySampleSize</span> <span class="operator">=</span> <span class="identifier">studySampleSize</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">162</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">aggregateStudyData</span> <span class="operator">=</span> <span class="identifier">aggregateStudyData</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">163</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                 <span class="identifier">targetData</span> <span class="operator">=</span> <span class="identifier">targetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">164</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">165</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">result</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"transportInterpolated"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">166</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">167</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">result</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">168</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">169</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">170</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Summarize results of transportability analysis using interpolated g-computation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">171</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">172</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">173</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Returns summary object which contains the transported effect estimate, organizes subgroup effect estimates into a data frame and produces summary statistics of effect modifiers in the target data, if not already provided.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">174</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">175</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname summary.transportInterpolated</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">176</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">177</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param object Result from \code{transportInterpolated} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">178</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">180</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">181</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Returns a \code{summary.transportInterpolated} object containing the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">182</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{effect}, \code{link}, \code{mainTreatmentEffect} and \code{mainSE} as in the \code{transportInterpolated} object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">183</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{se}: Estimated standard error of the effect estimate</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">184</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{subgroupEffects}: Subgroup effect estimates and their estimated standard errors in the original study, organized into a data frame with specific effect modifier and subgroup information</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">185</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{aggregateStudyData}: Summary statistics of effect modifiers in study data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">186</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{aggregateTargetData}: Summary statistics of effect modifiers in target data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">187</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">188</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">189</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">190</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @md</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">191</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summary.transportInterpolated</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">object</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">192</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportInterpolatedResult</span> <span class="operator">&lt;-</span> <span class="identifier">object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">193</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">194</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">effect</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">195</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">effectModifiers</span> <span class="operator">&lt;-</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">effectModifiers</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">196</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Organize subgroup analyses into table</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">197</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">subgroupStudyTable</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">effectModifier</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="identifier">effectModifiers</span>, <span class="identifier">each</span> <span class="operator">=</span> <span class="number">2</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">198</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="identifier">subgroup</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="number">1</span>,<span class="number">0</span><span class="paren">)</span>, <span class="identifier">times</span> <span class="operator">=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">199</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="identifier">effect</span> <span class="operator">=</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">subgroupTreatmentEffects</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">200</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                  <span class="identifier">se</span> <span class="operator">=</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">subgroupSEs</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">201</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">202</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">aggregateStudyData</span> <span class="operator">&lt;-</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">aggregateStudyData</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">203</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">names</span><span class="paren">(</span><span class="identifier">aggregateStudyData</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">effectModifiers</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">204</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">205</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">m</span> <span class="operator">&lt;-</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">effectModifiers</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">206</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">targetData</span> <span class="operator">&lt;-</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">targetData</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">207</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">208</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">209</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Calculate aggregate statistics of target data if IPD</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">210</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">emTargetProps</span> <span class="operator">&lt;-</span> <span class="identifier">apply</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">[</span>, <span class="identifier">effectModifiers</span><span class="paren">]</span>, <span class="number">2</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="identifier">mean</span><span class="paren">(</span><span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">211</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">212</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Extract aggregate statistics of target data if already aggregate</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">213</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">emTargetProps</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span><span class="paren">[</span><span class="identifier">effectModifiers</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">214</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">215</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">216</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">names</span><span class="paren">(</span><span class="identifier">emTargetProps</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">effectModifiers</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">217</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">218</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryResult</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">effect</span> <span class="operator">=</span> <span class="identifier">effect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">219</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">link</span> <span class="operator">=</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">link</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">220</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">se</span> <span class="operator">=</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">221</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">mainTreatmentEffect</span> <span class="operator">=</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">mainTreatmentEffect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">222</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">mainSE</span> <span class="operator">=</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">mainSE</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">223</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">subgroupEffects</span> <span class="operator">=</span> <span class="identifier">subgroupStudyTable</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">224</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">aggregateStudyData</span> <span class="operator">=</span> <span class="identifier">aggregateStudyData</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">225</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                        <span class="identifier">aggregateTargetData</span> <span class="operator">=</span> <span class="identifier">emTargetProps</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">226</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">227</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">summaryResult</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"summary.transportInterpolated"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">228</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">229</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">summaryResult</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">230</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">231</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">232</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname summary.transportInterpolated</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">233</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">234</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x \code{summary.transportInterpolated} object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">235</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param out Output stream</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">236</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">237</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">238</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">239</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">print.summary.transportInterpolated</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">out</span> <span class="operator">=</span> <span class="identifier">stdout</span><span class="paren">(</span><span class="paren">)</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">240</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryResult</span> <span class="operator">&lt;-</span> <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">241</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">242</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Transported ATE: "</span>, <span class="identifier">summaryResult</span><span class="operator">$</span><span class="identifier">effect</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">243</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Standard error: "</span>, <span class="identifier">summaryResult</span><span class="operator">$</span><span class="identifier">se</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">244</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Link function: "</span>, <span class="identifier">summaryResult</span><span class="operator">$</span><span class="identifier">link</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">245</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Source study treatment effect: "</span>, <span class="identifier">summaryResult</span><span class="operator">$</span><span class="identifier">mainTreatmentEffect</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">246</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Source study standard error: "</span>, <span class="identifier">summaryResult</span><span class="operator">$</span><span class="identifier">mainSE</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">247</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"Subgroup source treatment effects: "</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">248</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryResult</span><span class="operator">$</span><span class="identifier">subgroupEffects</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">249</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"Source data summary: "</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">250</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryResult</span><span class="operator">$</span><span class="identifier">aggregateStudyData</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">251</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"Target data summary: "</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">252</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryResult</span><span class="operator">$</span><span class="identifier">aggregateTargetData</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">253</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">254</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">255</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Visually represent results of transportability analysis using interpolated g-computation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">256</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">257</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">258</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' This function is a wrapper for \code{modelsummary::modelplot} to plot effect estimates in a transportability analysis using interpolated g-computation. Note that the transported variance estimate is used in this function.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">259</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">260</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x Result from \code{transportInterpolated} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">261</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">262</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">263</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">264</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{ggplot} object showing the estimates and confidence intervals of the transported effect estimate.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">265</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">266</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">267</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">268</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">plot.transportInterpolated</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">269</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportInterpolatedResult</span> <span class="operator">&lt;-</span> <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">270</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ti</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">term</span> <span class="operator">=</span> <span class="string">"treatment"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">271</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">estimate</span> <span class="operator">=</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">effect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">272</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">conf.low</span> <span class="operator">=</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">effect</span> <span class="operator">-</span> <span class="number">1.96</span> <span class="operator">*</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">273</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">conf.high</span> <span class="operator">=</span> <span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">effect</span> <span class="operator">+</span> <span class="number">1.96</span> <span class="operator">*</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">274</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">275</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">gl</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">n</span> <span class="operator">=</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">transportInterpolatedResult</span><span class="operator">$</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">276</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">277</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ms</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">tidy</span> <span class="operator">=</span> <span class="identifier">ti</span>, <span class="identifier">glance</span> <span class="operator">=</span> <span class="identifier">gl</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">278</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">ms</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"modelsummary_list"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">279</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">280</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">modelsummary</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">modelplot</span><span class="paren">(</span><span class="identifier">ms</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">281</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">282</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">resultPlot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">283</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">284</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">285</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Check validity of interpolated g-computation result object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">286</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">287</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">288</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A simple helper function that validates whether the components of the given \code{transportInterpolated} object are of the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">289</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">290</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x Result object from \code{transportInterpolated} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">291</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">292</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return A boolean indicating whether all components of \code{transportInterpolated} object have the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">293</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">294</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">295</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.transportInterpolated</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">296</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">effect</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">297</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">298</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">x</span><span class="operator">$</span><span class="identifier">link</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"identity"</span>, <span class="string">"log"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">299</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.character</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">effectModifiers</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">300</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">mainTreatmentEffect</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">301</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">mainSE</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">302</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">subgroupTreatmentEffects</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">303</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">subgroupSEs</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">304</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.matrix</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">corrStructure</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">305</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">studySampleSize</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">306</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">aggregateStudyData</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">307</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">targetData</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">$</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">308</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/transportGC.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Transportability analysis using g-computation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Estimates the average treatment effect (ATE) using g-computation in a generalizability or transportability analysis. In particular, the estimators should be unbiased for the ATE in the superpopulation or the target population, respectively.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param effectType Type of effect desired for the ATE: \code{"meanDiff"} for mean difference, \code{"rr"} for relative risk, \code{"or"} for odds ratio, and \code{"hr"} for hazard ratio.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param preparedModel A \code{transportGCPreparedModel} object. This is obtained by using the \code{transportGCPreparedModel} function to fit an outcome model using the study data.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param targetData A target dataset.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param bootstrapNum Number of bootstrap datasets to simulate to obtain robust variance estimators</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @details</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The expected workflow is as follows:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' \enumerate{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'  \item{A researcher who wants to perform a generalizability/transportability analysis collects data from the target population.}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'  \item{They then request the owner of the study data from which they wish to generalize/transport to provide an outcome model fitted using the study data.}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'  \item{The owner of the study data runs the \code{transportGCPreparedModel} function on the study data to obtain a \code{transportGCPreparedModel} object which contains the fitted outcome model.}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'  \item{The owner of the study data provides the \code{transportGCPreparedModel} object to the researcher, perhaps in a \code{.rds} file.}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'  \item{The researcher uses this function and the provided \code{transportGCPreparedModel} object to perform the analysis using g-computation.}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Since model-fitting objects in \code{R} often contain the data used to fit the model, the \code{transportGCPreparedModel} function wipes this data, if requested, in the model-fitting object and keeps additional information about the name of the response variable, the name of the treatment variable and the levels of treatment. This is in awareness with government regulations regarding access and integration of data sources from different countries.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Bootstrap is used to calculate robust variance estimates of the ATE estimator. Note that these standard errors are only valid conditional on the observed study data when \code{wipe = T} because it is not possible to resample the study data when access to it is restricted.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{transportGC} object with the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{effect}: Calculated ATE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{effectType}: Type of effect calculated</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{var}: Estimated variance of ATE estimator, calculated using bootstrap</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{preparedModel}: The \code{transportGCPreparedModel} object used to estimate the ATE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{bootstrapNum}: Integer indicating number of bootstrap datasets simulated to calculate robust variance estimators.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @md</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transportGC</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">effectType</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"meanDiff"</span>, <span class="string">"rr"</span>, <span class="string">"or"</span>, <span class="string">"hr"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">preparedModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">targetData</span>, <span class="identifier">bootstrapNum</span> <span class="operator">=</span> <span class="number">500</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportGCResult</span> <span class="operator">&lt;-</span> <span class="identifier">transportGCFit</span><span class="paren">(</span><span class="identifier">effectType</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">preparedModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">targetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">44</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">wipe</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">45</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">studyData</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">studyData</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">treatmentLevels</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatmentLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">treatmentGroupData</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">treatmentVector</span> <span class="operator">&lt;-</span> <span class="identifier">as.character</span><span class="paren">(</span><span class="identifier">studyData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">treatmentGroupData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">studyData</span><span class="paren">[</span><span class="identifier">treatmentVector</span> <span class="operator">==</span> <span class="identifier">level</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nLevels</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">treatmentGroupData</span>, <span class="identifier">nrow</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">53</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">names</span><span class="paren">(</span><span class="identifier">nLevels</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">56</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">nTarget</span> <span class="operator">&lt;-</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">targetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">58</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">bootstrapEstimates</span> <span class="operator">&lt;-</span> <span class="identifier">sapply</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">bootstrapNum</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">59</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                 <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">60</td>
                    <td class="coverage">6000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                   <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">wipe</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                    <span class="identifier">targetBoot</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span><span class="paren">[</span><span class="identifier">sample.int</span><span class="paren">(</span><span class="identifier">n</span> <span class="operator">=</span> <span class="identifier">nTarget</span>, <span class="identifier">replace</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                   </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">63</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                    <span class="identifier">resultBoot</span> <span class="operator">&lt;-</span> <span class="identifier">transportGCFit</span><span class="paren">(</span><span class="identifier">effectType</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">64</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                <span class="identifier">preparedModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">65</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                <span class="identifier">targetData</span> <span class="operator">=</span> <span class="identifier">targetBoot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                   <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">67</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">treatmentGroupBoot</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">68</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">69</td>
                    <td class="coverage">6000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                        <span class="identifier">nSample</span> <span class="operator">&lt;-</span> <span class="identifier">nLevels</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">70</td>
                    <td class="coverage">6000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                        <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentGroupData</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">sample.int</span><span class="paren">(</span><span class="identifier">nSample</span>, <span class="identifier">replace</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">72</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">73</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                        <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">exists</span><span class="paren">(</span><span class="string">"studyBoot"</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">studyBoot</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">74</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                        <span class="keyword">else</span> <span class="identifier">studyBoot</span> <span class="operator">&lt;-</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">studyBoot</span>, <span class="identifier">treatmentGroupBoot</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">77</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">targetBoot</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span><span class="paren">[</span><span class="identifier">sample.int</span><span class="paren">(</span><span class="identifier">n</span> <span class="operator">=</span> <span class="identifier">nTarget</span>, <span class="identifier">replace</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span>, <span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">78</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                     </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">79</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">preparedBoot</span> <span class="operator">&lt;-</span> <span class="identifier">suppressWarnings</span><span class="paren">(</span><span class="identifier">transportGCPreparedModel</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">formula</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">80</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                               <span class="identifier">response</span> <span class="operator">=</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">response</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">81</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                               <span class="identifier">treatment</span> <span class="operator">=</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">82</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                               <span class="identifier">treatmentLevels</span> <span class="operator">=</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatmentLevels</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">83</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                               <span class="identifier">family</span> <span class="operator">=</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">family</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">84</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                               <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">method</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">85</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                               <span class="identifier">studyData</span> <span class="operator">=</span> <span class="identifier">studyBoot</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">86</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                               <span class="identifier">wipe</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">87</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                      <span class="identifier">resultBoot</span> <span class="operator">&lt;-</span> <span class="identifier">transportGCFit</span><span class="paren">(</span><span class="identifier">effectType</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">88</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                  <span class="identifier">preparedBoot</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">89</td>
                    <td class="coverage">3000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                  <span class="identifier">targetData</span> <span class="operator">=</span> <span class="identifier">targetBoot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">90</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                   <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                   </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">6000<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                   <span class="keyword">return</span><span class="paren">(</span><span class="identifier">resultBoot</span><span class="operator">$</span><span class="identifier">effect</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">93</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                 <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">94</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">95</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># varMatrix &lt;- stats::var(bootstrapEstimates)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">96</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># colnames(varMatrix) &lt;- rownames(varMatrix) &lt;- c(names(transportGCResult$msm$coefficients), names(transportGCResult$msm$zeta))</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">97</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">varMatrix</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">var</span><span class="paren">(</span><span class="identifier">bootstrapEstimates</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># if (inherits(preparedModel$outcomeModel, "polr")) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">99</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   names(transportGCResult$effect) &lt;- colnames(varMatrix) &lt;- rownames(varMatrix) &lt;- preparedModel$responseLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">100</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># }</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">101</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">var</span> <span class="operator">&lt;-</span> <span class="identifier">varMatrix</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">102</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">bootstrapEstimates</span> <span class="operator">&lt;-</span> <span class="identifier">bootstrapEstimates</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">103</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">bootstrapNum</span> <span class="operator">&lt;-</span> <span class="identifier">bootstrapNum</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">104</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">105</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">106</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">107</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transportGCFit</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">effectType</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"meanDiff"</span>, <span class="string">"rr"</span>, <span class="string">"or"</span>, <span class="string">"hr"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">109</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">preparedModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">110</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">targetData</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">111</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Error checking of consistency from preparedModel object</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">112</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.transportGCPreparedModel</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Please provide a transportGCPreparedModel object."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">113</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Extract names of response and treatment variables as well as outcome model object</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">115</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">response</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">response</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">116</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatment</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">117</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">outcomeModel</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">118</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatmentLevels</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatmentLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">119</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">responseLevels</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">responseLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">120</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Create data frames which are the target dataset, but with the treatment column all equal to 0 or 1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">122</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">targetDataReferenceList</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">123</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">level</span> <span class="keyword">in</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">124</td>
                    <td class="coverage">12024<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetDataReferenceList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">targetData</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">125</td>
                    <td class="coverage">12024<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetDataReferenceList</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">level</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">level</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">126</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">128</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Combine the above data frames together. Counterfactuals are predicted with this data frame</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">129</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">targetDataCounterfactualFrame</span> <span class="operator">&lt;-</span> <span class="identifier">Reduce</span><span class="paren">(</span><span class="keyword">function</span><span class="paren">(</span><span class="identifier">d1</span>, <span class="identifier">d2</span><span class="paren">)</span> <span class="identifier">rbind</span><span class="paren">(</span><span class="identifier">d1</span>, <span class="identifier">d2</span><span class="paren">)</span>, <span class="identifier">targetDataReferenceList</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">130</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">as.factor</span><span class="paren">(</span><span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">131</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Predict counterfactual outcomes</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># TODO: adapt to coxph since it doesn't give survival time predictions - see Lee (2024) (transporting survival of hiv...) and Chen &amp; Tsiatis (2001)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">134</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"coxph"</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">135</td>
                    <td class="coverage">5010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">predict</span><span class="paren">(</span><span class="identifier">outcomeModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">136</td>
                    <td class="coverage">5010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                       <span class="identifier">newdata</span> <span class="operator">=</span> <span class="identifier">targetDataCounterfactualFrame</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">137</td>
                    <td class="coverage">5010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                       <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"response"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">138</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">139</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># predict.polr with type = "probs" returns a matrix. It's done separately to avoid dealing with column names. We're assuming the user has already set the order of levels of the response to what they want.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">140</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># predictorOnlyFormula &lt;- paste0("~ ", as.character(preparedModel$formula) |&gt;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">141</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#                                  strsplit(split = "~") |&gt;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#                                  unlist() |&gt;</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">143</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#                                  utils::tail(n = 1)) |&gt; stats::as.formula()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">144</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">145</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># counterfactualModelFrame &lt;- stats::model.matrix(predictorOnlyFormula, targetDataCounterfactualFrame)[,-1]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">146</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">147</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># counterfactualModelFrame &lt;- counterfactualModelFrame[, names(outcomeModel$coefficients)]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">148</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">149</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">predict</span><span class="paren">(</span><span class="identifier">outcomeModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">150</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                <span class="identifier">newdata</span> <span class="operator">=</span> <span class="identifier">targetDataCounterfactualFrame</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">151</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                                                <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"class"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">152</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"coxph"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">153</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nCounterfactual</span> <span class="operator">&lt;-</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">targetDataCounterfactualFrame</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">154</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">double</span><span class="paren">(</span><span class="identifier">nCounterfactual</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">155</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">156</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># Get max survival time for survmean</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">157</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">maxTime</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">survmean</span><span class="paren">(</span><span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">survfit</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span>, <span class="identifier">newdata</span> <span class="operator">=</span> <span class="identifier">targetDataCounterfactualFrame</span><span class="paren">)</span>, <span class="identifier">rmean</span> <span class="operator">=</span> <span class="string">"common"</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">end.time</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">158</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">159</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># For each observation in counterfactual frame, calculate the fitted survival curve</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">160</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">nCounterfactual</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">161</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">counterfactualSurvCurve</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">survfit</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span>, <span class="identifier">newdata</span> <span class="operator">=</span> <span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="identifier">i</span>, , <span class="identifier">drop</span> <span class="operator">=</span> <span class="literal">F</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">162</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">survmean</span><span class="paren">(</span><span class="identifier">counterfactualSurvCurve</span>, <span class="identifier">rmean</span> <span class="operator">=</span> <span class="identifier">maxTime</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">matrix</span><span class="paren">[</span><span class="string">"rmean"</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">163</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">164</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">165</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">166</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">effectType</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">effectType</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"meanDiff"</span>, <span class="string">"rr"</span>, <span class="string">"or"</span>, <span class="string">"hr"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">167</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">168</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># Calculate ATE based on desired effect type; except for polr, in which distributional causal effects are calculated</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">169</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">outcomeModel</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">170</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">targetModel</span> <span class="operator">&lt;-</span> <span class="identifier">MASS</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">polr</span><span class="paren">(</span><span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">as.formula</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">response</span>, <span class="string">" ~ "</span>, <span class="identifier">treatment</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">targetDataCounterfactualFrame</span>, <span class="identifier">method</span> <span class="operator">=</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span><span class="operator">$</span><span class="identifier">method</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">171</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">effectType</span> <span class="operator">==</span> <span class="string">"meanDiff"</span><span class="paren">)</span> <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="identifier">targetModel</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">172</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">effectType</span> <span class="operator">==</span> <span class="string">"or"</span><span class="paren">)</span> <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">targetModel</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">173</td>
                    <td class="coverage">5010<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">effectType</span> <span class="operator">!=</span> <span class="string">"hr"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">174</td>
                    <td class="coverage">4008<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">treatmentMean</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="identifier">treatmentLevels</span><span class="paren">[</span><span class="number">2</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">175</td>
                    <td class="coverage">4008<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">controlMean</span> <span class="operator">&lt;-</span> <span class="identifier">mean</span><span class="paren">(</span><span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">response</span><span class="paren">]</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">targetDataCounterfactualFrame</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">treatment</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="identifier">treatmentLevels</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">176</td>
                    <td class="coverage">2004<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">effectType</span> <span class="operator">==</span> <span class="string">"meanDiff"</span><span class="paren">)</span> <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentMean</span> <span class="operator">-</span> <span class="identifier">controlMean</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">177</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">effectType</span> <span class="operator">==</span> <span class="string">"rr"</span><span class="paren">)</span> <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="identifier">treatmentMean</span> <span class="operator">/</span> <span class="identifier">controlMean</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">178</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">effectType</span> <span class="operator">==</span> <span class="string">"or"</span><span class="paren">)</span> <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="paren">(</span><span class="identifier">treatmentMean</span> <span class="operator">/</span> <span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="identifier">treatmentMean</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">/</span> <span class="paren">(</span><span class="identifier">controlMean</span> <span class="operator">/</span> <span class="paren">(</span><span class="number">1</span> <span class="operator">-</span> <span class="identifier">controlMean</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">180</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">effectFormula</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">as.formula</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"survival::Surv("</span>, <span class="identifier">response</span>, <span class="string">", rep(1, nrow(targetDataCounterfactualFrame))) ~ "</span>, <span class="identifier">treatment</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">181</td>
                    <td class="coverage">1002<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">effect</span> <span class="operator">&lt;-</span> <span class="identifier">exp</span><span class="paren">(</span><span class="identifier">survival</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">coxph</span><span class="paren">(</span><span class="identifier">effectFormula</span>, <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">targetDataCounterfactualFrame</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">coefficients</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">182</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">183</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">184</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportGCResult</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">effect</span> <span class="operator">=</span> <span class="identifier">effect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">185</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">effectType</span> <span class="operator">=</span> <span class="identifier">effectType</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">186</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">preparedModel</span> <span class="operator">=</span> <span class="identifier">preparedModel</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">187</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="identifier">data</span> <span class="operator">=</span> <span class="identifier">targetData</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">188</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">189</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"transportGC"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">190</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">191</td>
                    <td class="coverage">6012<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">192</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">193</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">194</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">195</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Summarize results of transportability analysis using g-computation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">196</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">197</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">198</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Returns summary object which contains the transported effect estimate and the outcome model summary object, as well as information about response and treatment variables. In the MSM summary object, the correct variance estimators are calculated.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">199</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">200</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname summary.transportGC</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">201</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">202</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param object Result from \code{transportGC} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">203</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">204</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">205</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">206</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The \code{summary.transportGC} function returns a \code{summary.transportGC} object containing the following components:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">207</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{msmSummary}: Summary object of MSM with correct variance estimates. </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">208</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{preparedModelSummary}: Summary object of outcome model, provided only for information. No conclusions should be drawn from the outcome model.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">209</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{response}: String indicating response variable name.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">210</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{treatment}: String indicating treatment variable name.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">211</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' * \code{treatmentLevels}: Vector of strings indicating levels of treatment variable</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">212</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">213</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">214</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summary.transportGC</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">object</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">215</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportGCResult</span> <span class="operator">&lt;-</span> <span class="identifier">object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">216</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">217</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">preparedModel</span> <span class="operator">&lt;-</span> <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">preparedModel</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">218</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">219</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">preparedModelSummary</span> <span class="operator">&lt;-</span> <span class="identifier">summary</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">220</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">response</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">response</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">221</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">preparedModel</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">responseLevels</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">responseLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">222</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatment</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatment</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">223</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">treatmentLevels</span> <span class="operator">&lt;-</span> <span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatmentLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">224</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">225</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># If model is glm, calculate and replace correct SEs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">226</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">227</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># msm &lt;- transportGCResult$msm</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">228</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">229</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># msmSummary &lt;- summary(msm)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">230</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">231</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># if (inherits(msmSummary, "summary.glm")) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">232</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   if (!is.null(msm$var)) msmSummary$cov.scaled &lt;- msm$var</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">233</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   msmSummary$cov.unscaled &lt;- msmSummary$cov.scaled / msmSummary$dispersion</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">234</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   msmSummary$coefficients[, 2] &lt;- sqrt(diag(msmSummary$cov.scaled))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">235</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   msmSummary$coefficients[, 3] &lt;- msmSummary$coefficients[, 1] / msmSummary$coefficients[, 2]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">236</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   if (msmSummary$family$family == "gaussian") msmSummary$coefficients[, 4] &lt;- 2 * stats::pt(abs(msmSummary$coefficients[, 3]), msmSummary$df[2], lower.tail = F)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">237</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   else msmSummary$coefficients[, 4] &lt;- 2 * stats::pnorm(abs(msmSummary$coefficients[, 3]), lower.tail = F)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">238</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">239</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">240</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># # Same for polr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">241</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">242</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># if (inherits(msmSummary, "summary.polr")) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">243</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   if (!is.null(msm$var)) msmSummary$coefficients[, 2] &lt;- sqrt(diag(msm$var))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">244</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#   msmSummary$coefficients[, 3] &lt;- msmSummary$coefficients[, 1] / msmSummary$coefficients[, 2]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">245</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">246</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">247</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryTransportGC</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">effect</span> <span class="operator">=</span> <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">effect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">248</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                    <span class="identifier">effectType</span> <span class="operator">=</span> <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">effectType</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">249</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                    <span class="identifier">var</span> <span class="operator">=</span> <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">var</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">250</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                    <span class="identifier">preparedModelSummary</span> <span class="operator">=</span> <span class="identifier">preparedModelSummary</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">251</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                    <span class="identifier">response</span> <span class="operator">=</span> <span class="identifier">response</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">252</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                    <span class="identifier">treatment</span> <span class="operator">=</span> <span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">253</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                    <span class="identifier">treatmentLevels</span> <span class="operator">=</span> <span class="identifier">treatmentLevels</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">254</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">255</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">outcomeModel</span>, <span class="string">"polr"</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">summaryTransportGC</span><span class="operator">$</span><span class="identifier">responseLevels</span> <span class="operator">&lt;-</span> <span class="identifier">responseLevels</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">256</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">257</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">summaryTransportGC</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"summary.transportGC"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">258</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">259</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">summaryTransportGC</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">260</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">261</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">262</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname summary.transportGC</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">263</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">264</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x \code{summary.transportGC} object.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">265</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param out Output stream.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">266</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">267</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">268</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">269</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">270</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">271</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">print.summary.transportGC</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">out</span> <span class="operator">=</span> <span class="identifier">stdout</span><span class="paren">(</span><span class="paren">)</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">272</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">summaryTransportGC</span> <span class="operator">&lt;-</span> <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">273</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">274</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Response: "</span>, <span class="identifier">summaryTransportGC</span><span class="operator">$</span><span class="identifier">response</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">275</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Treatment: "</span>, <span class="identifier">summaryTransportGC</span><span class="operator">$</span><span class="identifier">treatment</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">276</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Effect type: "</span>, <span class="identifier">summaryTransportGC</span><span class="operator">$</span><span class="identifier">effectType</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">277</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"ATE estimate: "</span>, <span class="identifier">summaryTransportGC</span><span class="operator">$</span><span class="identifier">effect</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">278</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"Standard error: "</span>, <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">summaryTransportGC</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">279</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">280</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write</span><span class="paren">(</span><span class="string">"Fitted outcome model:"</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">281</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">summaryTransportGC</span><span class="operator">$</span><span class="identifier">preparedModelSummary</span>, <span class="identifier">out</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">282</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">283</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">284</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Visually represent results of transportability analysis using g-computation</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">285</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">286</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">287</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' This function is a wrapper for \code{modelsummary::modelplot} to plot effect estimates in a transportability analysis using g-computation. Note that the correct variance estimates are used in this function.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">288</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">289</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x Result from \code{transportGC} function.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">290</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Further arguments from previous function or to pass to next function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">291</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">292</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">293</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{ggplot} object showing the estimates and confidence intervals of the transported effect estimate.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">294</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">295</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">296</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">plot.transportGC</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">297</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">transportGCResult</span> <span class="operator">&lt;-</span> <span class="identifier">x</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">298</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ti</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">term</span> <span class="operator">=</span> <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">preparedModel</span><span class="operator">$</span><span class="identifier">treatment</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">299</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">estimate</span> <span class="operator">=</span> <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">effect</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">300</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">conf.low</span> <span class="operator">=</span> <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">effect</span> <span class="operator">-</span> <span class="number">1.96</span> <span class="operator">*</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">301</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">conf.high</span> <span class="operator">=</span> <span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">effect</span> <span class="operator">+</span> <span class="number">1.96</span> <span class="operator">*</span> <span class="identifier">sqrt</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">302</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">303</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">gl</span> <span class="operator">&lt;-</span> <span class="identifier">data.frame</span><span class="paren">(</span><span class="identifier">n</span> <span class="operator">=</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">targetData</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">304</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">305</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ms</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">tidy</span> <span class="operator">=</span> <span class="identifier">ti</span>, <span class="identifier">glance</span> <span class="operator">=</span> <span class="identifier">gl</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">306</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">ms</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"modelsummary_list"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">307</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">308</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">resultPlot</span> <span class="operator">&lt;-</span> <span class="identifier">modelsummary</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">modelplot</span><span class="paren">(</span><span class="identifier">ms</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">309</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">310</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">resultPlot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">311</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">312</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">313</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Check validity of g-computation result object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">314</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">315</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">316</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A simple helper function that validates whether the components of the given \code{transportGC} object are of the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">317</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">318</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param transportGCResult Result object from \code{transportGC} function</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">319</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">320</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return A boolean indicating whether all components of \code{transportGC} object have the correct types.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">321</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">322</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">323</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">324</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.transportGC</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="identifier">transportGCResult</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">325</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">effect</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">var</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">326</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">is.transportGCPreparedModel</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">preparedModel</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">327</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">is.data.frame</span><span class="paren">(</span><span class="identifier">transportGCResult</span><span class="operator">$</span><span class="identifier">data</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">328</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/trim.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Trimming specification object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Specify trimming parameters for \code{transportIP} and \code{transportTADA}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param value Threshold for trimming, which should be between 0 and 0.5.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @details</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Here, trimming refers to excluding observations with extreme weights from the analysis. This package only supports Crump trimming (cite), which trims based on propensity scores rather than weights. Thus, trimming is not supported for weighting components that do not have a well-defined propensity score (\code{final} in \code{transportIP}; \code{participation} and \code{final} in \code{transportTADA}).</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{trim} object that can be processed by \code{transportIP} and \code{transportTADA} for weight trimming.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">trim</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">value</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">17</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">trimObj</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">value</span> <span class="operator">=</span> <span class="identifier">value</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">18</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">trimObj</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"trim"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">trimObj</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">trimInd</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">weightGLM</span>, <span class="identifier">trim</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">4210<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">score</span> <span class="operator">&lt;-</span> <span class="identifier">weightGLM</span><span class="operator">$</span><span class="identifier">fitted.values</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">4210<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">score</span> <span class="operator">&gt;=</span> <span class="identifier">trim</span><span class="operator">$</span><span class="identifier">value</span> <span class="operator">&amp;</span> <span class="identifier">score</span> <span class="operator">&lt;=</span> <span class="number">1</span> <span class="operator">-</span> <span class="identifier">trim</span><span class="operator">$</span><span class="identifier">value</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.trim</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">trim</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"value"</span><span class="paren">)</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">trim</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">return</span><span class="paren">(</span><span class="literal">F</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">4234<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">trim</span>, <span class="string">"trim"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">4234<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">trim</span><span class="operator">$</span><span class="identifier">value</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/trunc.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @title Truncation specification object</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Specify truncation parameters for \code{transportIP} and \code{transportTADA}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param type One of \code{"quantile"} or \code{"raw"}. If \code{"quantile"}, the truncation threshold is the quantile of the weights specified by \code{value}. If \code{"raw"}, the truncation threshold is \code{value}.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param value Value of threshold as described above. When \code{type = "quantile"}, this argument should be between 0 and 1.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @details</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Here, truncation refers to the procedure of setting weights above a threshold equal to the threshold. Thus, observations with extreme weights are included in the analysis, albeit with reduced weights.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A \code{trunc} object that can be processed by \code{transportIP} and \code{transportTADA} for weight truncation.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">trunc</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">type</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"quantile"</span>, <span class="string">"raw"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="identifier">value</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">18</td>
                    <td class="coverage">36<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">type</span> <span class="operator">&lt;-</span> <span class="identifier">match.arg</span><span class="paren">(</span><span class="identifier">type</span>, <span class="identifier">c</span><span class="paren">(</span><span class="string">"quantile"</span>, <span class="string">"raw"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">36<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">truncObj</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">type</span> <span class="operator">=</span> <span class="identifier">type</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">36<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">value</span> <span class="operator">=</span> <span class="identifier">value</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">36<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">truncObj</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"trunc"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">36<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">truncObj</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">truncWeights</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">weights</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                         <span class="identifier">trunc</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">27</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">trunc</span>, <span class="string">"trunc"</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Please provide trunc object."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">6618<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">trunc</span><span class="operator">$</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"raw"</span><span class="paren">)</span> <span class="identifier">limit</span> <span class="operator">&lt;-</span> <span class="identifier">trunc</span><span class="operator">$</span><span class="identifier">value</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">6618<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">trunc</span><span class="operator">$</span><span class="identifier">type</span> <span class="operator">==</span> <span class="string">"quantile"</span><span class="paren">)</span> <span class="identifier">limit</span> <span class="operator">&lt;-</span> <span class="identifier">stats</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">quantile</span><span class="paren">(</span><span class="identifier">weights</span>, <span class="identifier">probs</span> <span class="operator">=</span> <span class="identifier">trunc</span><span class="operator">$</span><span class="identifier">value</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">13236<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">truncatedWeights</span> <span class="operator">&lt;-</span> <span class="identifier">pmin</span><span class="paren">(</span><span class="identifier">weights</span>, <span class="identifier">limit</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">13236<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">truncatedWeights</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.trunc</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">trunc</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">4210<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"type"</span>, <span class="string">"value"</span><span class="paren">)</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">trunc</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="keyword">return</span><span class="paren">(</span><span class="literal">F</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">13236<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="identifier">inherits</span><span class="paren">(</span><span class="identifier">trunc</span>, <span class="string">"trunc"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">13236<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">trunc</span><span class="operator">$</span><span class="identifier">type</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"quantile"</span>, <span class="string">"raw"</span><span class="paren">)</span> <span class="operator">&amp;</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">13236<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">trunc</span><span class="operator">$</span><span class="identifier">value</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <script>$('div#files pre').each(function(i, block) {
    hljs.highlightBlock(block);
});</script>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


</body></html>