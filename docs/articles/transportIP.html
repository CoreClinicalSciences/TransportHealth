<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="TransportHealthR">
<title>Inverse probability or odds weighting-based transportability analysis • TransportHealthR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Inverse probability or odds weighting-based transportability analysis">
<meta property="og:description" content="TransportHealthR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">TransportHealthR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Introduction</h6>
    <a class="dropdown-item" href="../articles/overview.html">Overview of transportability and generalizability analyses and TransportHealth</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Inverse Probability Methods</h6>
    <a class="dropdown-item" href="../articles/transportIP.html">Inverse probability or odds weighting-based transportability analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CoreClinicalSciences/TransportHealthR">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Inverse probability or odds weighting-based transportability analysis</h1>
                        <h4 data-toc-skip class="author">Core Clinical
Sciences</h4>
            
      
      
      <div class="d-none name"><code>transportIP.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette, we demonstrate how to use
<code>TransportHealth</code> for weighting-based transportability
analysis for instances where mergeable individual participant-level data
(IPD) is available in both the original study and target sample.</p>
<div class="section level3">
<h3 id="brief-introduction-to-iopw-and-ippw">Brief Introduction to IOPW and IPPW<a class="anchor" aria-label="anchor" href="#brief-introduction-to-iopw-and-ippw"></a>
</h3>
<p>For transportability scenarios, where the original study population
is a separate population to the target population of interest, we can
use
<code>inverse odds of participation weighting (IOPW)</code>approach.</p>
<p>When the original study population is a subset of the target
population of interest, we refer to this as generalizability scenarios;
here, we can use
<code>inverse probability of participation weighting (IPPW)</code>
approach.</p>
<p>Both the IOPW and IPPW approaches are analogous to the propensity
score weighting approach, such as
<code>inverse probability of treatment weighting (IPTW)</code> that aims
to adjust for confounding typically in a non-randomized study. They are
analogous in the sense we can use a model such as logistic regression to
estimate the probability of interest (i.e, study participation or
propensity to being treated). Under the transportability analysis
framework, the results from the original study are weighted based on the
inverse odds or probability that is calculated based on different
distribution of effect modifiers between the original study and target
sample data. The weights refer to the conditional probability of
participation in the target study.</p>
</div>
<div class="section level3">
<h3 id="mathematical-formulation">Mathematical formulation<a class="anchor" aria-label="anchor" href="#mathematical-formulation"></a>
</h3>
<p>Let <span class="math inline">\(Y\)</span> be the outcome of
interest, <span class="math inline">\(A\)</span> be the (binary, coded
as 0 for control and 1 for treatment) treatment, <span class="math inline">\(S\)</span> be the indicator for study
participation (so that <span class="math inline">\(S=1\)</span> means
that the subject is in the population of the original study, while <span class="math inline">\(S = 0\)</span> means that the subject is in the
target population), <span class="math inline">\(X\)</span> be covariates
to control for confounding in the original study and <span class="math inline">\(E\)</span> be effect modifiers. Let <span class="math inline">\(Y^0\)</span> and <span class="math inline">\(Y^1\)</span> be counterfactual outcomes associated
with control and treatment, respectively. The primary objective of
transportability analysis is to estimate the ATE in the target
population: <span class="math display">\[ATE = \mathrm{E}[Y^1 - Y^0
\,|\,S = 0].\]</span></p>
<p>Simply taking the difference in sample means using the original study
data will only unbiasedly estimate the quantity <span class="math display">\[\mathrm{E}[Y \,|\,A = 1, S = 1] - \mathrm{E}[Y
\,|\,A = 0, S = 1],\]</span> which is different from the target ATE due
to confounding and the different distributions of effect modifiers.</p>
<p>Let <span class="math display">\[w_1 = \begin{cases}\frac{1}{P(A = 1
\,|\,X, S = 1)} &amp; \textrm{if } A = 1 \\ \frac{1}{P(A = 0 \,|\,X, S =
1)} &amp; \textrm{if } A = 0\end{cases}\]</span> and <span class="math display">\[w_2 = \frac{P(S = 0 \,|\,E)}{P(S = 1
\,|\,E)}.\]</span> To control for confounding, the estimator <span class="math display">\[\frac{1}{\sum_{i=1}^n w_{1,i}I(A_i =
a)}\sum_{i=1}^n w_{1,i}YI(A_i = a)\]</span> will unbiasedly estimate the
quantity <span class="math display">\[\mathrm{E}[Y^a \,|\,S =
1],\]</span> which uses the first set of weights <span class="math inline">\(w_1\)</span> and is the IP weighting approach in
causal inference. However, to estimate the target ATE, the estimator
<span class="math display">\[\frac{1}{\sum_{i=1}^n w_{1,i}w_{2,i}I(A_i =
a)}\sum_{i=1}^n w_{1,i}w_{2,i}YI(A_i = a)\]</span> should be used
instead, which incorporates the second set of weights <span class="math inline">\(w_2\)</span> to unbiasedly estimate the target
ATE. This is extended to estimate the coefficients of any marginal
structural model in the target population in the same manner as IP
weighting: more specifically, the marginal structural model coefficients
are estimated by fitting regression models on the original study data
with the weights <span class="math inline">\(w_1w_2\)</span>.</p>
<p>For more information, check out Hern{'}an and Robins’ book on causal
inference <span class="citation">(Hernán and Robins 2024)</span> and
Ling, et al.’s application of IOPW to transportability analysis <span class="citation">(Ling et al. 2022)</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>Suppose we are interested in estimating the causal effect of a
medication on systolic blood pressure in a target population, but we
were only able to conduct an observational study using samples from the
study population. To obtain unbiased causal effect estimates using the
study sample, we account for the following covariates: sex, body fat
percentage, and stress level.</p>
<p>We wish to know know that the effectiveness of the medication depends
on two effect modifiers of stress levels and whether patients are taking
another medication.</p>
<p><em>Note that the covariates adjusted for in the study data can also
be effect modifiers.</em></p>
<div class="section level3">
<h3 id="coded-variables">Coded variables:<a class="anchor" aria-label="anchor" href="#coded-variables"></a>
</h3>
<ul>
<li>
<p>Medication - <code>med1</code></p>
<ul>
<li>
<code>1</code> for treated</li>
<li>
<code>0</code> for non-treated</li>
</ul>
</li>
<li><p>Systolic blood pressure (SBP) - <code>sysBloodPressure</code>
(continuous)</p></li>
<li>
<p>Sex - <code>sex</code></p>
<ul>
<li>
<code>1</code> for male</li>
<li>
<code>0</code> for female</li>
</ul>
</li>
<li><p>Body fat percentage - <code>percentBodyFat</code>
(continuous)</p></li>
<li>
<p>Stress level - <code>stress</code></p>
<ul>
<li>
<code>1</code> for stressed</li>
<li>
<code>0</code> for normal</li>
</ul>
</li>
<li>
<p>Medication 2 - <code>med2</code></p>
<ul>
<li>
<code>1</code> for treated</li>
<li>
<code>0</code> for non-treated</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="analyses">Analyses<a class="anchor" aria-label="anchor" href="#analyses"></a>
</h3>
<p>We can perform this analysis as follows.</p>
<p>First, the data from the study and target population may be separate
data frames or a merged data frame in the <code>R</code>
environment.</p>
<ul>
<li><p>If they are separate, put them together in a <code>list</code>
object; there is no need to name the components, as the package will
identify the study data as the dataset with response and treatment
information. Because of this, make sure that the study data has the
response and treatment columns, while the target data do not (which is
the case 99% of the time). If they are merged, make sure that</p></li>
<li><p>The response and treatment columns for the target data are
<code>NA</code>, and;</p></li>
<li><p>There is a binary variable indicating which observations are in
the study data and the target data, with participation being coded as
<code>1</code> or <code>TRUE</code>.</p></li>
</ul>
<p>Suppose that we have the study and target data separately as
follows.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">testData</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "studyData"  "targetData"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Study data:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Study data:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">testData</span><span class="op">$</span><span class="va">studyData</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sysBloodPressure med1 sex stress med2 percentBodyFat</span></span>
<span><span class="co">#&gt; 1         109.4347    1   1      0    0       16.84868</span></span>
<span><span class="co">#&gt; 2         115.9803    0   1      1    0       14.48698</span></span>
<span><span class="co">#&gt; 3         112.7886    0   1      0    0       15.53636</span></span>
<span><span class="co">#&gt; 4         107.6026    1   1      0    0       13.76442</span></span>
<span><span class="co">#&gt; 5         120.6845    0   0      1    0       30.08657</span></span>
<span><span class="co">#&gt; 6         113.4424    0   1      0    0       16.23256</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Target data:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Target data:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">testData</span><span class="op">$</span><span class="va">targetData</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sex stress med2 percentBodyFat</span></span>
<span><span class="co">#&gt; 1   0      1    0       26.12896</span></span>
<span><span class="co">#&gt; 2   1      1    0       12.04972</span></span>
<span><span class="co">#&gt; 3   1      1    0       12.55972</span></span>
<span><span class="co">#&gt; 4   0      0    1       27.07130</span></span>
<span><span class="co">#&gt; 5   1      1    0       11.85846</span></span>
<span><span class="co">#&gt; 6   0      1    0       27.64520</span></span></code></pre></div>
<p>After merging the data, we can now perform transportability analysis
based on the IOPW approach using the <code>transportIP</code>
function.</p>
<!-- Quang, insert blank function here -->
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transportIP.html">transportIP</a></span><span class="op">(</span><span class="va">msmFormula</span>,</span>
<span>            <span class="va">propensityScoreModel</span>,</span>
<span>            <span class="va">participationModel</span>,</span>
<span>            <span class="va">propensityWeights</span>,</span>
<span>            <span class="va">participationWeights</span>,</span>
<span>            <span class="va">treatment</span>,</span>
<span>            <span class="va">participation</span>,</span>
<span>            <span class="va">response</span>,</span>
<span>            <span class="va">family</span>,</span>
<span>            <span class="va">method</span>,</span>
<span>            <span class="va">data</span>,</span>
<span>            <span class="va">transport</span>,</span>
<span>            <span class="va">bootstrapNum</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="arguments-for-the-transportip-function">Arguments for the <code>transportIP</code> function<a class="anchor" aria-label="anchor" href="#arguments-for-the-transportip-function"></a>
</h4>
<p>This function requires specification of the following arguments:</p>
<ul>
<li><p><code>msmFormula</code>: A formula expressing the marginal
structural model (MSM) to be fit.</p></li>
<li><p><code>propensityScoreModel</code>: A formula or a
<code>glm</code> object expressing the propensity model, i.e. a model of
treatment assignment in terms of covariates.</p></li>
</ul>
<p>If a formula is provided, logistic regression is used by default.
Custom propensity weights from other weighting methods can also be
provided to the <code>customPropensity</code> argument instead; in this
case, do not set <code>propensityScoreModel</code> because it is
<code>NULL</code> by default and will be overridden.</p>
<ul>
<li>
<code>participationModel</code>: A formula or a <code>glm</code>
object expressing the participation model, i.e. a model of study
participation in terms of effect modifiers.</li>
</ul>
<p>If a formula is provided, logistic regression is used by default.
Custom participation weights from other weighting methods can also be
provided to the <code>customParticipation</code> argument instead; in
this case, do not set <code>participationModel</code> because it is
<code>NULL</code> by default and will be overridden.</p>
<ul>
<li>
<code>family</code>: The type of MSM to be fit.</li>
</ul>
<p>This can be any of the families that are used in <code>glm</code> or
one of <code>"coxph"</code> or <code>"survreg"</code>. The latter
options are for survival analysis and will use default options of these
methods from the <code>survival</code> package.</p>
<ul>
<li><p><code>data</code>: The study and target data, separate or
merged</p></li>
<li><p><code>transport</code>: This argument can be used to specify
whether a transportability or generalizability analysis will be
performed.</p></li>
</ul>
<p>By default (<code>transport = true</code>), transportability based on
IOPW is used.</p>
<p>Generalizability analysis weighs by IPPW instead of than IOPW.</p>
</div>
<div class="section level4">
<h4 id="specification-of-transportability-analysis">Specification of transportability analysis<a class="anchor" aria-label="anchor" href="#specification-of-transportability-analysis"></a>
</h4>
<p>These components are put together as follows.</p>
<p>Recall that: - <code>sysBloodPressure</code> is the response</p>
<ul>
<li><p><code>med1</code> is the treatment</p></li>
<li><p><code>sex</code>, <code>percentBodyFat</code>, and
<code>stress</code> are covariates to be controlled in the original
study</p></li>
<li><p><code>med2</code> (other medication) and <code>stress</code> are
effect modifiers of interest.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">TransportHealthR</span><span class="fu">::</span><span class="fu"><a href="../reference/transportIP.html">transportIP</a></span><span class="op">(</span></span>
<span>  <span class="co"># MSM formula</span></span>
<span>  msmFormula <span class="op">=</span> <span class="va">sysBloodPressure</span> <span class="op">~</span> <span class="va">med1</span>, </span>
<span>  </span>
<span>  <span class="co"># Propensity model</span></span>
<span>  propensityScoreModel <span class="op">=</span> <span class="va">med1</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">percentBodyFat</span> <span class="op">+</span> <span class="va">stress</span>, </span>
<span>  </span>
<span>  <span class="co"># Participation model</span></span>
<span>  participationModel <span class="op">=</span> <span class="va">participation</span> <span class="op">~</span> <span class="va">stress</span> <span class="op">+</span> <span class="va">med2</span>, </span>
<span>  </span>
<span>  <span class="co"># Type of MSM</span></span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span>, </span>
<span>  </span>
<span>  <span class="co"># Data frame</span></span>
<span>  data <span class="op">=</span> <span class="va">testData</span>, </span>
<span>  </span>
<span>  <span class="co"># Transportability or generalizability specification argument</span></span>
<span>  transport <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="producing-statistical-results">Producing statistical results<a class="anchor" aria-label="anchor" href="#producing-statistical-results"></a>
</h4>
<p>To show the results of the analysis, we can use the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">base::summary</a></code> function, similarly as one would use the
<code>lm</code> function for fitting a linear model.</p>
<p>This prints out covariate balance tables pre- and post-weighting for
covariates between treatment groups (using propensity weights only) and
effect modifiers (using participation weights only) between original
study and target data, as well as a summary output of the MSM model fit
with the correct standard errors calculated using bootstrap.</p>
<p>For the effect modifiers balance table, the weights used are inverse
odds for study data and 1 for target data in a transportability
analysis, and inverse probability for all observations in a
generalizability analysis.</p>
<p>Note that if custom participation weights are provided, the balance
tables default to transportability analysis since only the weights for
observations in the study data are provided.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt; Absolute SMDs of covariates between treatments before and after weighting:</span></span>
<span><span class="co">#&gt;                       variable          smd   method</span></span>
<span><span class="co">#&gt; sex                        sex 1.686088e-01 Observed</span></span>
<span><span class="co">#&gt; percentBodyFat  percentBodyFat 1.723317e-01 Observed</span></span>
<span><span class="co">#&gt; stress                  stress 6.216350e-02 Observed</span></span>
<span><span class="co">#&gt; sex1                       sex 3.720148e-05 Weighted</span></span>
<span><span class="co">#&gt; percentBodyFat1 percentBodyFat 1.157406e-03 Weighted</span></span>
<span><span class="co">#&gt; stress1                 stress 3.204378e-03 Weighted</span></span>
<span><span class="co">#&gt; Absolute SMDs of effect modifiers between study and target populations before and after weighting:</span></span>
<span><span class="co">#&gt;         variable          smd   method</span></span>
<span><span class="co">#&gt; stress    stress 0.6813098772 Observed</span></span>
<span><span class="co">#&gt; med2        med2 0.4965440683 Observed</span></span>
<span><span class="co">#&gt; stress1   stress 0.0001397205 Weighted</span></span>
<span><span class="co">#&gt; med21       med2 0.0002326560 Weighted</span></span>
<span><span class="co">#&gt; MSM results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::glm(formula = msmFormula, family = family, data = toAnalyze, </span></span>
<span><span class="co">#&gt;     weights = finalWeights)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  116.715      0.169  690.31  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; med11         -1.771      0.497   -3.56  0.00039 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for gaussian family taken to be 69.24548)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 71451  on 999  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance: 69107  on 998  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 6333</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 2</span></span></code></pre></div>
<p>The <code>transportIP</code> object produced by the
<code>transportIP</code> function contains the model fitting objects for
the propensity model, the participation model and the MSM. You can use
methods like <code>coef</code> and <code>residuals</code> on these
objects themselves. This is not implemented by the package because they
are not as useful as implementing <code>summary</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">msmResiduals</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">msm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">msmCoefficients</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">msm</span><span class="op">)</span></span></code></pre></div>
<p><strong>Positivity</strong> and <strong>conditional
exchangeability</strong> are two keyassumptions that can affect the
validity of transportability analysis.</p>
<p><code>Positivity</code> is the assumption that at all observed levels
of covariates and effect modifiers, the probabilities of being in the
treatment group and being the study are neither 0 nor 1,
respectively.</p>
<ul>
<li>To evaluate this assumption for the treatment assignment and study
participation, use the <code>plot</code> function with
<code>type = "propensityHist"</code> or
<code>type = "participationHist"</code>, respectively. This outputs
mirrored histograms of probabilities of being in the treatment group for
different treatment groups or of participating in the study for the
study and target data, respectively. Non-overlap of the ranges of the
histograms suggest violations of the positivity assumption <span class="citation">(Wizard, n.d.b)</span>.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">:::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"propensityHist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="transportIP_files/figure-html/IPWeighting-hist-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">base</span><span class="fu">:::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"participationHist"</span><span class="op">)</span></span></code></pre></div>
<p><img src="transportIP_files/figure-html/IPWeighting-hist-2.png" width="700"></p>
<p><code>Conditional exchangeability</code> is roughly the assumption
that the only possible confounding is due to the controlled covariates
and effect modifiers. Under this assumption, IOPW estimates will be
reliable if the weighted distributions of covariates and effect
modifiers are similar between treatment groups and the study and target
data, respectively. This can be (partially) evaluated using standardized
mean differences (SMDs), which are shown in table form by the
<code>summary</code> function. The <code>plot</code> function with
<code>type = "propensitySMD"</code> or
<code>type = "participationSMD"</code> provides graphical versions of
these tables. A general guideline is that an SMD of below 0.1 indicates
balance, but this threshold is arbitrary and left to the choice of the
analyst <span class="citation">(Wizard, n.d.a)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"propensitySMD"</span><span class="op">)</span></span></code></pre></div>
<p><img src="transportIP_files/figure-html/IPWeighting-smd-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"participationSMD"</span><span class="op">)</span></span></code></pre></div>
<p><img src="transportIP_files/figure-html/IPWeighting-smd-2.png" width="700"></p>
<p>Model coefficient plots showing confidence intervals of the effect
estimates are provided by <code>plot</code> function with
<code>type = "msm"</code>. The standard errors are the correct ones
calculated by bootstrap.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">base</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, type <span class="op">=</span> <span class="st">"msm"</span><span class="op">)</span></span></code></pre></div>
<p><img src="transportIP_files/figure-html/IPWeighting-msm-1.png" width="700"></p>
<p>Note that all plot outputs are designed to be generated with
<code>ggplot2</code>. They can be customized further.</p>
</div>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-what-if" class="csl-entry">
Hernán, MA, and JM Robins. 2024. <em>Causal Inference: What If?</em>
Boca Raton: Chapman &amp; Hall/CRC.
</div>
<div id="ref-ling" class="csl-entry">
Ling, AY, R Jreich, ME Montez-Rath, Z Meng, K Kappahn, KJ Chandross, and
M Desai. 2022. <span>“Transporting Observational Sutdy Results to a
Target Population of Interest Using Inverse Odds of Particpation
Weighting.”</span> <em>PLoS ONE</em> 17: e0278842. https://doi.org/<a href="https://doi.org/10.1371/journal.pone.0278842" class="external-link">https://doi.org/10.1371/journal.pone.0278842</a>.
</div>
<div id="ref-balance" class="csl-entry">
Wizard, Causal. n.d.a. <span>“Covariate Balance.”</span> <a href="https://causalwizard.app/inference/article/covariate-balance" class="external-link">https://causalwizard.app/inference/article/covariate-balance</a>.
</div>
<div id="ref-positivity" class="csl-entry">
———. n.d.b. <span>“The Positivity Assumption.”</span> <a href="https://causalwizard.app/inference/article/positivity" class="external-link">https://causalwizard.app/inference/article/positivity</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Quang Vuong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
