<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Transportability analysis using IOPW — transportIP • TransportHealth</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Transportability analysis using IOPW — transportIP"><meta name="description" content="Estimates the coefficients of a marginal structural model (MSM) using IP weighting in a generalizability or transportability analysis. In particular, the estimators should be unbiased for the coefficients in the superpopulation or the target population, respectively. Currently, this function only supports the case when there are exactly two treatment levels."><meta property="og:description" content="Estimates the coefficients of a marginal structural model (MSM) using IP weighting in a generalizability or transportability analysis. In particular, the estimators should be unbiased for the coefficients in the superpopulation or the target population, respectively. Currently, this function only supports the case when there are exactly two treatment levels."><meta property="og:image" content="https://coreclinicalsciences.github.io/TransportHealth/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TransportHealth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/overview.html">Overview of transportability and generalizability analyses and TransportHealth</a></li>
    <li><a class="dropdown-item" href="../articles/assumptions.html">Assumptions of transportability and generalizability analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Inverse probability methods</h6></li>
    <li><a class="dropdown-item" href="../articles/transportIP.html">Inverse probability or odds weighting-based transportability analysis</a></li>
    <li><a class="dropdown-item" href="../articles/transportIPMath.html">Theory of inverse probability or odds weighting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>G-computation methods</h6></li>
    <li><a class="dropdown-item" href="../articles/transportGC.html">G-computation-based transportability analysis</a></li>
    <li><a class="dropdown-item" href="../articles/transportGCMath.html">Theory of g-computation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Target aggregate data adjustment (TADA) methods</h6></li>
    <li><a class="dropdown-item" href="../articles/transportTADA.html">Target aggregate data adjustment transportability analysis</a></li>
    <li><a class="dropdown-item" href="../articles/transportTADAMath.html">Theory of target aggregate data adjustment transportability analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Interpolated g-computation methods</h6></li>
    <li><a class="dropdown-item" href="../articles/transportInterpolated.html">Transportability analysis with interpolated g-computation</a></li>
    <li><a class="dropdown-item" href="../articles/transportInterpolatedMath.html">Theory of interpolated g-computation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CoreClinicalSciences/TransportHealth"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Transportability analysis using IOPW</h1>

      <div class="d-none name"><code>transportIP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the coefficients of a marginal structural model (MSM) using IP weighting in a generalizability or transportability analysis. In particular, the estimators should be unbiased for the coefficients in the superpopulation or the target population, respectively. Currently, this function only supports the case when there are exactly two treatment levels.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">transportIP</span><span class="op">(</span></span>
<span>  <span class="va">msmFormula</span>,</span>
<span>  propensityScoreModel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  participationModel <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  propensityWeights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  participationWeights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  treatment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  participation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"logistic"</span>, <span class="st">"probit"</span>, <span class="st">"loglog"</span>, <span class="st">"cloglog"</span>, <span class="st">"cauchit"</span><span class="op">)</span>,</span>
<span>  exOpt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>propensity <span class="op">=</span> <span class="cn">NULL</span>, participation <span class="op">=</span> <span class="cn">NULL</span>, final <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  transport <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  bootstrapNum <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-msmformula">msmFormula<a class="anchor" aria-label="anchor" href="#arg-msmformula"></a></dt>
<dd><p>A formula for the MSM to be fitted, which usually includes the outcome, the treatment and any effect modifiers.</p></dd>


<dt id="arg-propensityscoremodel">propensityScoreModel<a class="anchor" aria-label="anchor" href="#arg-propensityscoremodel"></a></dt>
<dd><p>Either a formula or a <code>glm</code> object representing the model for treatment assignment given covariates.</p></dd>


<dt id="arg-participationmodel">participationModel<a class="anchor" aria-label="anchor" href="#arg-participationmodel"></a></dt>
<dd><p>Either a formula or a <code>glm</code> object representing the model for study participation given effect modifiers. If a formula and the "data" argument is a list, then add participation as the left-hand side of the formula.</p></dd>


<dt id="arg-propensityweights">propensityWeights<a class="anchor" aria-label="anchor" href="#arg-propensityweights"></a></dt>
<dd><p>Vector of custom weights balancing covariates between treatments. Providing them will override the formula or model provided by <code>propensityScoreModel</code>. This vector should have as any entries as the sample size of the study data.</p></dd>


<dt id="arg-participationweights">participationWeights<a class="anchor" aria-label="anchor" href="#arg-participationweights"></a></dt>
<dd><p>Vector of custom weights balancing effect modifiers between study and target populations. Providing them will override the formula or model provided by <code>participationModel</code>. This vector should have as any entries as the sample size of the study data.</p></dd>


<dt id="arg-treatment">treatment<a class="anchor" aria-label="anchor" href="#arg-treatment"></a></dt>
<dd><p>String indicating name of treatment variable. If <code>NULL</code>, it will be auto-detected from <code>propensityScoreModel</code> if provided; otherwise it will remain <code>NULL</code>. Note that when using custom weights, <code>treatment</code> should be provided so that <code>summary.transportIP</code> and <code>plot.transportIP</code> works.</p></dd>


<dt id="arg-participation">participation<a class="anchor" aria-label="anchor" href="#arg-participation"></a></dt>
<dd><p>String indicating name of participation variable. If <code>NULL</code>, it will be auto-detected from <code>participationModel</code> if provided; otherwise it will remain <code>NULL</code>. Note that when using custom weights, <code>participation</code> should be provided so that <code>summary.transportIP</code> and <code>plot.transportIP</code> works.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>String indicating name of response variable. If <code>NULL</code>, it will be auto-detected form <code>msmFormula</code>.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Either a <code>family</code> function as used for <code>glm</code>, or one of <code>c("polr", "coxph", "survreg")</code>.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Link function used for <code>polr</code>, one of <code>c("logistic", "probit", "loglog", "cloglog", "cauchit")</code>.</p></dd>


<dt id="arg-exopt">exOpt<a class="anchor" aria-label="anchor" href="#arg-exopt"></a></dt>
<dd><p>A list with components <code>propensity</code>, <code>participation</code> and <code>final</code>. Each component specifies whether weights should be trimmed or truncated. Use the functions <code>trim</code> and <code>trunc</code> to specify trimming/truncation. Note that only truncation is supported for final weights.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Either a single data frame containing merged study and target datasets, or a list containing the study dataset and the target dataset. Note that if participationModel is a glm object, the datasets would have been merged, so provide the merged dataset containing response, treatment, covariates controlled for in the original study, study participation and effect modifiers if this is the case. Make sure to code treatment and participation as 0-1 or TRUE-FALSE, with 1 and TRUE representing treatment group and study data, respectively.</p></dd>


<dt id="arg-transport">transport<a class="anchor" aria-label="anchor" href="#arg-transport"></a></dt>
<dd><p>A boolean indicating whether a generalizability analysis (false) or a transportability analysis (true) is done.</p></dd>


<dt id="arg-bootstrapnum">bootstrapNum<a class="anchor" aria-label="anchor" href="#arg-bootstrapnum"></a></dt>
<dd><p>Number of bootstrap datasets to simulate to obtain robust variance estimate.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>transportIP</code> object containing the following components:</p><ul><li><p><code>msm</code>: Raw model fit object for MSM of class <code>glm</code>, <code>survreg</code> and <code>coxph</code>, with the correct variance estimators appropriately replaced. If of class <code>glm</code>, it will have an extra <code>var</code> component containing the correct variance estimates.</p></li>
<li><p><code>propensityScoreModel</code>: Model of treatment assignment, <code>NULL</code> if not provided and custom propensity weights are used</p></li>
<li><p><code>participationModel</code>: Model of study participation, <code>NULL</code> if not provided and custom propensity weights are used</p></li>
<li><p><code>propensityWeights</code>: Propensity weights used</p></li>
<li><p><code>participationWeights</code>: Participation weights used</p></li>
<li><p><code>finalWeights</code>: Weights used to fit MSM</p></li>
<li><p><code>customPropensity</code>: Boolean indicating whether custom propensity weights are used</p></li>
<li><p><code>customParticipation</code>: Boolean indicating whether custom participation weights are used</p></li>
<li><p><code>treatment</code>: String indicating variable name of treatment</p></li>
<li><p><code>participation</code>: String indicating variable name of participation</p></li>
<li><p><code>response</code>: String indicating variable name of response</p></li>
<li><p><code>data</code>: Data provided in <code>data</code> argument. Either a list containing study data and target data or a data frame containing both.</p></li>
<li><p><code>exOpt</code>: Provided <code>exOpt</code> argument.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function fits models of treatment assignment and study participation in order to calculate the weights used to fit the MSM. For each of these models, if a formula is provided, logistic regression is used by default. If a <code>glm</code> object is provided, the function extracts the necessary weights from the object. The function does not support other weighting methods, so if they are required, provide custom weights.</p>
<p>The MSM-fitting functions do not provide correct standard errors as-is. Bootstrap is used to calculate robust bootstrap variance estimators of the parameter estimators. The function replaces the variance component in <code>summary.glm</code>, <code>coxph</code> and <code>survreg</code> with the robust variance estimators directly. This does not seem to behave well with <code>predict.glm</code> yet, but prediction is not of primary interest in a generalizability or transportability analysis.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Core Clinical Sciences, Quang Vuong.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

